<?php
/*
|--------------------------------------------------------------------------
| ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡πÑ‡∏ü‡∏•‡πå (Thai Doc Block)
|--------------------------------------------------------------------------
| ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö: ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞ Incident Response Plan
| Flow: ‡∏£‡∏±‡∏ö input ‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ, ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á, ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•, ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
| Input: responses ‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°
| Output: UI, export PDF/CSV/JSON
| Error: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö null, handle export error, validate input
| ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö: ‡∏ü‡∏≠‡∏£‡πå‡∏°, ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå, IRP, export, modal
*/
?>
<?php
// ---------------------------
// ‡∏™‡πà‡∏ß‡∏ô PHP: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
// ---------------------------
$questions = [
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î
    "icon" => "üóÇÔ∏è",
    "text" => "‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
    "fix" => "‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô",
    "steps" => [
      "‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•/‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£",
      "‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠ inventory",
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
    "icon" => "üóÇÔ∏è",
    "text" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï",
    "fix" => "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",
    "steps" => [
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î policy ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
      "‡∏ï‡∏¥‡∏î‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î label ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
      "‡∏≠‡∏ö‡∏£‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå",
    "icon" => "üîë",
    "text" => "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
    "fix" => "‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô",
    "steps" => [
      "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå",
      "‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°",
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå",
    "icon" => "üîë",
    "text" => "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ 2FA/MFA ‡∏Å‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÅ‡∏Æ‡∏Å‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ 2FA/MFA",
    "fix" => "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô 2FA/MFA ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
    "steps" => [
      "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ 2FA/MFA ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°",
      "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö/‡∏ö‡∏±‡∏ç‡∏ä‡∏µ",
      "‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏ö‡∏£‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ"
    ]
  ],
  [
    "text" => "‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (Least Privilege) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå",
    "fix" => "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
    "steps" => [
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö",
      "‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô",
      "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞"
    ]
  ],
  [
    "text" => "‡πÅ‡∏¢‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Admin ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÅ‡∏•‡∏∞‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏ö‡∏±‡∏ç‡∏ä‡∏µ admin ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•",
    "fix" => "‡πÅ‡∏¢‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ admin ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ",
    "steps" => [
      "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ admin ‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å user ‡∏õ‡∏Å‡∏ï‡∏¥",
      "‡πÉ‡∏ä‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ admin ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô",
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå admin ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤/‡∏¢‡πâ‡∏≤‡∏¢‡∏á‡∏≤‡∏ô/‡∏•‡∏≤‡∏≠‡∏≠‡∏Å ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö/‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏≠‡∏î‡∏µ‡∏ï‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏¢‡πâ‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏à‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ",
    "fix" => "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
    "steps" => [
      "‡πÅ‡∏à‡πâ‡∏á HR/IT ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á",
      "‡∏õ‡∏¥‡∏î/‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
      "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï/‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà",
    "icon" => "üõ°Ô∏è",
    "text" => "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏û‡∏ï‡∏ä‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 14 ‡∏ß‡∏±‡∏ô) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï",
    "fix" => "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏û‡∏ï‡∏ä‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤",
    "steps" => [
      "‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà",
      "‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï",
      "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÇ‡∏à‡∏°‡∏ï‡∏µ",
    "fix" => "‡∏™‡πÅ‡∏Å‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠",
    "steps" => [
      "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡πÅ‡∏Å‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà",
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô",
      "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏ó‡∏µ‡πà‡∏û‡∏ö"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
    "icon" => "üíæ",
    "text" => "‡∏°‡∏µ Asset Inventory ‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏™‡∏°‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏î‡∏ö‡πâ‡∏≤‡∏á ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô",
    "fix" => "‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Asset Inventory",
    "steps" => [
      "‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",
      "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
      "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á"
    ]
  ],
  [
    "text" => "‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö/‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏à‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
    "fix" => "‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î",
    "steps" => [
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
      "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°",
      "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÅ‡∏ö‡∏ö Offline/Immutable/Offsite ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô Ransomware ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å",
    "fix" => "‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÅ‡∏ö‡∏ö Offline/Immutable/Offsite",
    "steps" => [
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
      "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
      "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡∏£‡∏≠‡∏á"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå",
    "icon" => "üîé",
    "text" => "‡∏Å‡∏≥‡∏´‡∏ô‡∏î RTO/RPO ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢‡πÑ‡∏ß‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏£‡∏∞‡∏ö‡∏ö/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤",
    "fix" => "‡∏Å‡∏≥‡∏´‡∏ô‡∏î RTO/RPO ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô",
    "steps" => [
      "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à",
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î RTO/RPO",
      "‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö"
    ]
  ],
  [
    "text" => "‡πÄ‡∏Ñ‡∏¢‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô 6‚Äì12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏≠‡∏≤‡∏à‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏",
    "fix" => "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥",
    "steps" => [
      "‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô",
      "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö",
      "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå",
    "icon" => "üö®",
    "text" => "‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏° Logs ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á (‡πÄ‡∏ä‡πà‡∏ô Syslog/SIEM) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Log ‡∏≠‡∏≤‡∏à‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏¢‡∏≤‡∏Å",
    "fix" => "‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏° Log ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á",
    "steps" => [
      "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô Log Centralization",
      "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á Log",
      "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Log ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ô‡πÄ‡∏ù‡πâ‡∏≤‡∏î‡∏π‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠ 24/7 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤",
    "fix" => "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö",
    "steps" => [
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
      "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
      "‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå",
    "icon" => "ü¶†",
    "text" => "‡∏ó‡∏∏‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏µ Antivirus/EDR ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï",
    "fix" => "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Antivirus/EDR ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
    "steps" => [
      "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô Antivirus/EDR",
      "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á",
      "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£",
    "icon" => "üëî",
    "text" => "‡∏°‡∏µ‡πÅ‡∏ú‡∏ô IRP ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡∏≤‡∏î‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå ‡∏≠‡∏≤‡∏à‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏",
    "fix" => "‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ú‡∏ô IRP",
    "steps" => [
      "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ú‡∏ô IRP ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô",
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ",
      "‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö/‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô (‡πÉ‡∏ô‚Äì‡∏ô‡∏≠‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£) ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏",
    "fix" => "‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô",
    "steps" => [
      "‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠",
      "‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢",
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ Playbook ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏ü‡∏¥‡∏ä‡∏ä‡∏¥‡∏á/‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå/‡πÅ‡∏£‡∏ô‡∏ã‡∏±‡∏°‡πÅ‡∏ß‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡∏≤‡∏î‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤",
    "fix" => "‡∏à‡∏±‡∏î‡∏ó‡∏≥ Playbook ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
    "steps" => [
      "‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢",
      "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå",
      "‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏¢‡∏ã‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏à‡∏•‡∏∏‡∏Å‡∏•‡∏≤‡∏°‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ß‡∏á‡∏Å‡∏ß‡πâ‡∏≤‡∏á",
    "fix" => "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏ã‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠",
    "steps" => [
      "‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏´‡∏ï‡∏∏",
      "‡∏ã‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô",
      "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏ã‡πâ‡∏≠‡∏°"
    ]
  ],
  [
    "text" => "‡πÄ‡∏Ñ‡∏¢‡∏ã‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏õ‡∏µ‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏£‡∏¥‡∏á",
    "fix" => "‡∏ã‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ",
    "steps" => [
      "‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ã‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå",
      "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πâ‡∏≠‡∏°",
      "‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô"
    ]
  ],
  [
    "section" => "‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢",
    "icon" => "üìú",
    "text" => "‡πÅ‡∏ú‡∏ô BCP/DR ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö IRP ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏¢‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÅ‡∏ú‡∏ô BCP/DR ‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö IRP ‡∏≠‡∏≤‡∏à‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢",
    "fix" => "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ú‡∏ô BCP/DR ‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö IRP",
    "steps" => [
      "‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ú‡∏ô BCP/DR ‡∏Å‡∏±‡∏ö IRP",
      "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô",
      "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ú‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥"
    ]
  ],
  [
    "text" => "‡∏ó‡∏£‡∏≤‡∏ö PDPA/‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏≠‡∏≤‡∏à‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏",
    "fix" => "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏",
    "steps" => [
      "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢/‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á",
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏",
      "‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô"
    ]
  ],
  [
    "text" => "‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ CERT/‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
    "fix" => "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ CERT/‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤",
    "steps" => [
      "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CERT/‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç",
      "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠",
      "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠"
    ]
  ],
  [
    "section" => "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô",
    "icon" => "üåê",
    "text" => "‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏ã‡∏ô/‡πÄ‡∏ã‡∏Å‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏à‡∏•‡∏∏‡∏Å‡∏•‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢",
    "fix" => "‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏ã‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏°",
    "steps" => [
      "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢",
      "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏ã‡∏ô/segment",
      "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ firewall ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏ã‡∏ô"
    ]
  ],
  [
    "text" => "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Å‡∏é‡πÑ‡∏ü‡∏£‡πå‡∏ß‡∏≠‡∏•‡∏•‡πå ‡∏õ‡∏¥‡∏î‡∏û‡∏≠‡∏£‡πå‡∏ï/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡πÄ‡∏õ‡∏¥‡∏î‡∏û‡∏≠‡∏£‡πå‡∏ï/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ",
    "fix" => "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏¥‡∏î‡∏û‡∏≠‡∏£‡πå‡∏ï/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô",
    "steps" => [
      "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏é firewall",
      "‡∏õ‡∏¥‡∏î‡∏û‡∏≠‡∏£‡πå‡∏ï/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ",
      "‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞"
    ]
  ],
  [
    "section" => "Cloud/‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå",
    "icon" => "‚òÅÔ∏è",
    "text" => "‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (MFA/Logs/Encryption) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
    "type" => "radio",
    "choices" => [
      ["label" => "‡πÉ‡∏ä‡πà", "score" => 0],
      ["label" => "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", "score" => 1],
      ["label" => "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "score" => 2]
    ],
    "risk" => "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢",
    "fix" => "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ö‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå",
    "steps" => [
      "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ MFA",
      "‡πÄ‡∏õ‡∏¥‡∏î Logging",
      "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Encryption"
    ]
  ]
];
?>
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Cyber IRP Risk Assessment (PHP)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/avif" href="logo.avif">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô CSS: ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°
       --------------------------- */
    body {
      background: linear-gradient(135deg, #f0fdfa 0%, #e0f2fe 100%);
    }
    .cyber-glow {
      /* ‡πÉ‡∏™‡πà‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ */
      text-shadow: 0 2px 8px #38bdf8, 0 0px 2px #0ea5e9;
      letter-spacing: 0.03em;
    }
    .question-card {
      /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° */
      background: #fff;
      border: none;
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 #38bdf822;
      max-width: 600px;
      margin: 0 auto;
      transition: box-shadow 0.2s;
      padding: 2.5rem 2rem 2rem 2rem;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      animation: fadeInUp 0.5s;
    }
    @keyframes fadeInUp {
      from { opacity:0; transform: translateY(30px);}
      to { opacity:1; transform: translateY(0);}
    }
    .question-card:after {
      /* ‡πÄ‡∏™‡πâ‡∏ô gradient ‡πÉ‡∏ï‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á */
      content: "";
      position: absolute;
      left: 1.5rem; right: 1.5rem; bottom: 0;
      height: 4px;
      border-radius: 2px;
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      opacity: 0.12;
    }
    .question-progress {
      /* ‡πÅ‡∏ñ‡∏ö progress */
      background: #e0f2fe;
      border-radius: 1rem;
      overflow: hidden;
      height: 12px;
      margin-bottom: 2rem;
      box-shadow: 0 1px 4px #38bdf822;
    }
    .question-progress-bar {
      /* progress bar ‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      height: 100%;
      transition: width 0.4s cubic-bezier(.4,2,.6,1);
    }
    .radio-group {
      /* ‡∏Å‡∏•‡∏∏‡πà‡∏° radio button */
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 0.5rem;
    }
    .radio-group label {
      /* ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
      background: #f1f5f9;
      border-radius: 0.5rem;
      padding: 0.45rem 1.2rem 0.45rem 1rem;
      font-weight: 500;
      cursor: pointer;
      border: 1.5px solid transparent;
      transition: border 0.2s, background 0.2s;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 1rem;
    }
    .radio-group input[type="radio"] {
      margin-right: 0.3rem;
    }
    .radio-group input[type="radio"]:checked + span {
      color: #0ea5e9;
      font-weight: 700;
    }
    .radio-group input[type="radio"]:focus + span {
      outline: 2px solid #38bdf8;
    }
    .question-section {
      /* ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) */
      color: #0ea5e9;
      font-weight: 600;
      font-size: 1.05rem;
      margin-bottom: 0.2rem;
      letter-spacing: 0.01em;
    }
    .question-number {
      /* ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ç‡πâ‡∏≠ */
      position: absolute;
      top: 1.2rem;
      right: 2rem;
      color: #b6c7d6;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.04em;
    }
    .question-card input[type="text"] {
      /* ‡∏ä‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ */
      background: #f8fafc;
      border: 1.5px solid #e0f2fe;
      border-radius: 0.6rem;
      padding: 0.7rem 1rem;
      font-size: 1rem;
      margin-top: 0.2rem;
      transition: border 0.2s;
      width: 100%;
    }
    .question-card input[type="text"]:focus {
      border-color: #38bdf8;
      outline: none;
      background: #fff;
    }
    .btn-main {
      /* ‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ */
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      color: #fff;
      font-weight: 600;
      border-radius: 0.7rem;
      padding: 0.7rem 2.2rem;
      box-shadow: 0 2px 8px #38bdf822;
      transition: background 0.2s, box-shadow 0.2s;
      border: none;
    }
    .btn-main:hover, .btn-export:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 24px #38bdf822;
    }
    .btn-secondary {
      /* ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö */
      background: #f1f5f9;
      color: #0ea5e9;
      font-weight: 600;
      border-radius: 0.7rem;
      padding: 0.7rem 2.2rem;
      border: none;
      transition: background 0.2s;
    }
    .btn-secondary:hover {
      background: #e0f2fe;
    }
    .btn-group > * { margin: 0 0.3rem 0.5rem 0.3rem; }
    @media (max-width: 600px) {
      /* Responsive ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
      .question-card { padding: 1.2rem 0.7rem 1.2rem 0.7rem; }
      .question-number { right: 1rem; top: 0.7rem; }
      .radio-group label { font-size: 0.97rem; padding: 0.4rem 0.8rem 0.4rem 0.7rem; }
    }
    @media print {
      /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå/Export PDF */
      .print\:hidden { display: none !important; }
      body { background: #fff !important; }
      .question-card { box-shadow: none !important; border: 1px solid #bbb !important; }
      #exportBtns { display: none !important; }
    }
    .panel-header { font-size:1.25rem; font-weight:700; color:#2563eb; background:#f1f5f9; border-radius:0.7rem 0.7rem 0 0; padding:1rem 1.5rem; cursor:pointer; display:flex; align-items:center; justify-content:space-between; }
    .panel-content {
      display: block !important; /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ block ‡πÄ‡∏™‡∏°‡∏≠ */
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.4s cubic-bezier(.4,2,.6,1);
    }
    .panel-content.open {
      max-height: 2000px; /* ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏û‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏£‡∏ö */
    }
    .panel.active .panel-content { display:block; }
    .panel { margin-bottom:2rem; box-shadow:0 2px 12px #38bdf822; border-radius:0.7rem; }
    .panel-header svg { transition:transform 0.2s; }
    .panel.active .panel-header svg { transform:rotate(90deg);}
    .result-table { width:100%; border-collapse:collapse; margin-bottom:1.5rem; }
    .result-table th, .result-table td { border:1px solid #e0e7ef; padding:0.7em 1em; text-align:left; }
    .result-table th { background:#f1f5f9; font-weight:700; }
    .result-table tr:nth-child(even) { background:#f8fafc; }
    .risk-high { color:#dc2626; font-weight:bold; }
    .risk-medium { color:#d97706; font-weight:bold; }
    .risk-low { color:#16a34a; font-weight:bold; }
    .heatmap-table { border-collapse:collapse; margin:1.5rem auto; }
    .heatmap-table td, .heatmap-table th { width:60px; height:40px; text-align:center; font-weight:600; border:1px solid #e0e7ef; }
    .heatmap-low { background:#bbf7d0; }
    .heatmap-medium { background:#fde68a; }
    .heatmap-high { background:#fecaca; }
    .stepper { border-left:4px solid #38bdf8; margin-left:1.5rem; padding-left:2rem; }
    .stepper-phase { position:relative; margin-bottom:2.5rem; }
    .stepper-phase:last-child { margin-bottom:0; }
    .stepper-dot { position:absolute; left:-2.2rem; top:0.2rem; width:1.3rem; height:1.3rem; background:#38bdf8; border-radius:50%; border:3px solid #fff; box-shadow:0 0 0 2px #38bdf8; }
    .stepper-title { font-size:1.1rem; font-weight:700; color:#0ea5e9; margin-bottom:0.5rem; }
    .stepper-table { margin-bottom:0.7rem; }
    .stepper-table th, .stepper-table td { font-size:0.98rem; }
    .summary-card { background:#f1f5f9; border-radius:0.7rem; padding:1.2rem 1.5rem; margin-bottom:1.5rem; font-size:1.1rem; }
    .export-btns { margin-top:2rem; display:flex; flex-wrap:wrap; gap:0.7rem; justify-content:center; }
    .btn-export { background:#f1f5f9; color:#0ea5e9; font-weight:600; border-radius:0.7rem; padding:0.7rem 2.2rem; border:none; transition:background 0.2s; }
    .btn-export:hover { background:#e0f2fe; }
    /* ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô CSS: ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå Pro Report
       --------------------------- */
    .panel-header { background: #f1f5f9; }
    .panel-header span { font-weight: 600; }
    .panel-content { background: #fff; border: 1px solid #e0e7ef; }
    .result-table th {
      background: #f1f5f9;
      color: #0e2233;
      font-weight: 600;
    }
    .result-table td {
      background: #fff;
      color: #0e2233;
    }
    .risk-high { color:#dc2626; font-weight:bold; }
    .risk-medium { color:#d97706; font-weight:bold; }
    .risk-low { color:#16a34a; font-weight:bold; }
    .heatmap-table td, .heatmap-table th {
      background: #f1f5f9;
      color: #0e2233;
      font-weight: 600;
    }
    .stepper-dot { background:#38bdf8; }
    .stepper-title { color:#0ea5e9; }
    /* ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô CSS: ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modal
       --------------------------- */
    .modal-content {
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 #38bdf822;
    }
    .modal-header {
      border-bottom: 1px solid #e0e7ef;
    }
    .modal-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #0e2233;
    }
    .modal-body {
      font-size: 1rem;
      color: #0e2233;
    }
    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
    @media (max-width: 768px) {
      .modal-dialog {
        max-width: 90%;
        margin: 1rem auto;
      }
    }
  </style>
  <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° Bootstrap 5 CSS/JS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<div class="max-w-xl mx-auto my-8 p-2">
  <!-- ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÇ‡∏•‡πÇ‡∏Å‡πâ/‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠)
       --------------------------- -->
  <div class="flex flex-col items-center mb-8">
    <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏£ (‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå logo.avif) -->
    <img 
      src="logo.avif" 
      alt="HackerProtect Pro Logo" 
      style="
        width:110px;
        margin-bottom:18px;
        border-radius: 22px;
        box-shadow: 0 6px 32px 0 #38bdf855, 0 1px 2px #0ea5e955;
        background: linear-gradient(135deg, #f0fdfa 0%, #e0f2fe 100%);
        border: 2.5px solid #38bdf8;
        padding: 8px;
        transition: box-shadow 0.2s;
      "
      class="hover:scale-105 transition-transform duration-200"
    >
    <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏ö‡∏ö Paradise Resort Style -->
    <h1 
      class="text-4xl md:text-5xl font-extrabold text-center mb-2"
      style="
        color: #0e2233;
        letter-spacing: 0.03em;
        text-shadow:
          0 6px 32px #38bdf822,
          0 2px 8px #0ea5e9,
          0 1px 0 #fff,
          0 0 2px #fff;
        font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;
        background: none;
        -webkit-background-clip: initial;
        -webkit-text-fill-color: initial;
        background-clip: initial;
      "
    >
      CHECK RISK
      <span 
        class="align-super font-bold"
        style="
          font-size:0.7em;
          margin-left:0.2em;
          letter-spacing:0.05em;
          color: #38bdf8;
          text-shadow:0 2px 8px #38bdf8, 0 0px 2px #0ea5e9;
          font-family: inherit;
        "
      >
    </div>
    <p 
      class="text-center text-cyan-800 text-lg md:text-xl font-medium mb-2"
      style="font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;"
    >
      ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
    </p>
  </div>
  <!-- ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
       --------------------------- -->
  <section id="formSection">
    <!-- Progress bar -->
    <div class="question-progress">
      <div id="progressBar" class="question-progress-bar" style="width:0%"></div>
    </div>
    <form id="assessmentForm" autocomplete="off">
      <div id="questionBox"></div>
      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö/‡∏ñ‡∏±‡∏î‡πÑ‡∏õ -->
      <div class="btn-group flex flex-row gap-2 mt-4 justify-center print:hidden">
        <button type="button" id="prevBtn" class="btn-secondary" style="min-width:110px;">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <button type="button" id="nextBtn" class="btn-main" style="min-width:110px;">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
      </div>
    </form>
  </section>
  <!-- =========================
       ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå Risk Assessment & IRP
       ========================= -->
  <section id="proResultsSection" style="display:none;">
    <h2 class="text-2xl font-bold mb-6 text-center text-blue-800">Risk Assessment Results</h2>
    <!-- Collapsible Panels -->
    <div class="panel active" id="panel-risk">
      <div class="panel-header">
        <span>Cybersecurity Risk Assessment</span>
        <svg width="18" height="18" fill="none"><path d="M6 7l3 3 3-3" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>
      </div>
      <div class="panel-content">
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">Risk Scenario Table</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Threat Event</th>
                <th>Vulnerability</th>
                <th>Consequence</th>
              </tr>
            </thead>
            <tbody id="riskScenarioRows"></tbody>
          </table>
        </div>
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">Likelihood & Impact Matrix</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Likelihood (1-3)</th>
                <th>Impact (1-3)</th>
                <th>Risk Level</th>
              </tr>
            </thead>
            <tbody id="riskMatrixRows"></tbody>
          </table>
          <div class="mt-4">
            <div class="font-bold text-lg mb-2">Risk Heatmap</div>
            <table class="heatmap-table">
              <tr>
                <th rowspan="2" style="writing-mode:vertical-lr;transform:rotate(180deg);">Impact</th>
                <th colspan="3">Likelihood</th>
              </tr>
              <tr>
                <th>1</th><th>2</th><th>3</th>
              </tr>
              <tbody id="heatmapGrid"></tbody>
            </table>
          </div>
        </div>
        <div>
          <div class="font-bold text-lg mb-2">Risk Response Table</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Risk Level</th>
                <th>Recommended Response</th>
              </tr>
            </thead>
            <tbody id="riskResponseRows"></tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="panel" id="panel-irp">
      <div
        id="irp-toggle"
        class="panel-header"
        tabindex="0"
        role="button"
        aria-expanded="false"
        aria-controls="irp-panel"
        data-testid="irp-toggle"
        style="user-select:none;outline:none;display:flex;align-items:center;justify-content:space-between;cursor:pointer;"
      >
        <span>Incident Response Plan</span>
        <svg id="irp-caret" width="18" height="18" fill="none" style="transition:transform 0.3s;">
          <path d="M6 7l3 3 3-3" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <div
        id="irp-panel"
        class="panel-content"
        data-testid="irp-panel"
        aria-hidden="true"
      >
        <!-- ...‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤... -->
      </div>
    </div>
    <div class="export-btns print:hidden">
      <button type="button" class="btn-export" id="exportPDF2">Export PDF</button>
      <button type="button" class="btn-export" id="exportCSV2">Export CSV</button>
      <button type="button" class="btn-export" id="exportJSON2">Export JSON</button>
    </div>
  </section>
  <!-- ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏° Export
       --------------------------- -->
  <section id="summarySection" style="display:none">
    <div id="summary" class="mt-10"></div>
    <div id="exportBtns" class="export-btns print:hidden">
      <button type="button" class="btn-export" id="exportPDF">Export PDF</button>
      <button type="button" class="btn-export" id="exportCSV">Export CSV</button>
      <button type="button" class="btn-export" id="exportJSON">Export JSON</button>
      <button type="button" class="btn-export" onclick="window.print()">Print</button>
    </div>
  </section>
  <!-- ---------------------------
       ‡∏™‡πà‡∏ß‡∏ô Footer
       --------------------------- -->
  <footer class="mt-12 text-center text-xs text-cyan-700 print:text-black">
    &copy; <?= date('Y') ?> Cyber IRP Risk Assessment | For internal use only
  </footer>
</div>
<!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° Modal HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á -->
<div class="modal fade" id="riskHighModal" tabindex="-1" aria-labelledby="riskHighModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="riskHighModalLabel">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="‡∏õ‡∏¥‡∏î"></button>
      </div>
      <div class="modal-body" id="riskHighModalBody">
        <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
      </div>
    </div>
  </div>
</div>
<script>
// ---------------------------
// ‡∏™‡πà‡∏ß‡∏ô: ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà/‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
// ---------------------------
const QUESTIONS = <?php echo json_encode($questions); ?>; // ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å PHP
const SCORE_MAP = { yes: 0, partial: 1, no: 2 }; // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
const LABEL_MAP = { yes: "‡πÉ‡∏ä‡πà", partial: "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", no: "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà" }; // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
const RISK_LEVEL = { 2: '<span class="risk-high">‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</span>', 1: '<span class="risk-medium">‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>', 0: '<span class="risk-low">‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥</span>' };
const SECTION_ICONS = {
  "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•": "üóÇÔ∏è",
  "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå": "üîë",
  "‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï/‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà": "üõ°Ô∏è",
  "‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•": "üíæ",
  "‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå": "üîé",
  "‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå": "üö®",
  "‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå": "ü¶†",
  "‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£": "üëî",
  "‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢": "üìú",
  "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô": "üåê",
  "Cloud/‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå": "‚òÅÔ∏è"
};

let current = 0; // ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á
let responses = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠

// ---------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞ (tooltip)
// ---------------------------
function getQuestionHint(q) {
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏°‡∏µ‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
  if(q.text.includes("RTO/RPO")) return 'RTO (Recovery Time Objective) ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏<br>RPO (Recovery Point Objective) ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ';
  if(q.text.includes("2FA") || q.text.includes("MFA")) return '2FA/MFA ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏á‡∏Ç‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô+OTP ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô+‡πÅ‡∏≠‡∏õ';
  if(q.text.includes("SIEM")) return 'SIEM ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏ß‡∏° log ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥';
  if(q.text.includes("Immutable")) return 'Immutable Backup ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÇ‡∏à‡∏°‡∏ï‡∏µ';
  if(q.text.includes("Playbook")) return 'Playbook ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå ‡πÄ‡∏ä‡πà‡∏ô ‡∏ü‡∏¥‡∏ä‡∏ä‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå';
  if(q.text.includes("BCP/DR")) return 'BCP (Business Continuity Plan) ‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ú‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à<br>DR (Disaster Recovery) ‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ú‡∏ô‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏';
  if(q.text.includes("PDPA")) return 'PDPA ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢';
  if(q.text.includes("CERT")) return 'CERT ‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏µ‡∏°‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå (‡πÄ‡∏ä‡πà‡∏ô ThaiCERT)';
  if(q.text.includes("EDR")) return 'EDR ‡∏Ñ‡∏∑‡∏≠‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå';
  if(q.text.includes("Asset Inventory")) return 'Asset Inventory ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£';
  if(q.text.includes("Firewall")) return 'Firewall ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢';
  if(q.text.includes("Cloud") || q.text.includes("‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå")) return 'Cloud ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï ‡πÄ‡∏ä‡πà‡∏ô AWS, Azure, Google Cloud';
  // ‡πÄ‡∏û‡∏¥‡πà‡∏° tip ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
  return "";
}

// ---------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠
// ---------------------------
function renderQuestion(idx) {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  const q = QUESTIONS[idx];
  let val = responses[idx]?.choice || "";
  let icon = q.icon || SECTION_ICONS[q.section] || "üîí";
  let html = `<div class="question-card">
    <div style="font-size:2em; margin-bottom:0.2em;">${icon}</div>
    <div class="question-section">${q.section ? icon + " " + q.section : ""}</div>
    <div class="question-number">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${idx+1} / ${QUESTIONS.length}</div>
    <div class="font-medium text-lg text-slate-800 mb-1" style="line-height:1.5">
      ${q.text}
      ${getQuestionHint(q) ? `<button type="button" tabindex="-1" style="background:none;border:none;cursor:pointer;padding:0;margin-left:6px;" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢" onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='block'?'none':'block'">
        <span style="display:inline-block;width:1.2em;height:1.2em;background:#e0f2fe;color:#0ea5e9;border-radius:50%;font-size:0.95em;text-align:center;line-height:1.2em;font-weight:bold;">?</span>
      </button>
      <span class="question-hint" style="display:none;background:#f1f5f9;border-radius:0.5em;padding:0.6em 1em;margin-top:0.5em;display:block;color:#0ea5e9;font-size:0.97em;">${getQuestionHint(q)}</span>` : ""}
    </div>
    <div class="radio-group">`;
  // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á radio button ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  [["yes","‡πÉ‡∏ä‡πà"],["partial","‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"],["no","‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà"]].forEach(([v,l])=>{
    html += `<label>
      <input type="radio" name="choice" value="${v}" class="accent-cyan-500" ${val===v?"checked":""}>
      <span>${l}</span>
    </label>`;
  });
  html += `</div>
    <input type="text" name="comment" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" value="${responses[idx]?.comment ? responses[idx].comment.replace(/"/g,'&quot;') : ""}">
  </div>`;
  // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô questionBox
  document.getElementById('questionBox').innerHTML = html;
  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï progress bar
  document.getElementById('progressBar').style.width = `${Math.round((idx+1)/QUESTIONS.length*100)}%`;
  // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡πÅ‡∏£‡∏Å
  document.getElementById('prevBtn').style.display = idx === 0 ? "none" : "";
  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
  document.getElementById('nextBtn').textContent = idx === QUESTIONS.length-1 ? "‡∏î‡∏π‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ" : "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ";
}

// ---------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
// ---------------------------
function saveCurrent() {
  // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á responses
  const q = QUESTIONS[current];
  const choice = document.querySelector('input[name="choice"]:checked');
  const comment = document.querySelector('input[name="comment"]').value;
  if(choice) {
    responses[current] = { choice: choice.value, comment };
  }
}

// ---------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ
// ---------------------------
function showSummary() {
  document.getElementById('summarySection').style.display = "block";

  let ordered = [];
  // --- ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö ---
  let high = [], medium = [], low = [];
  let total = 0;
  for(let i=0;i<QUESTIONS.length;i++) {
    const ans = responses[i]?.choice;
    const score = SCORE_MAP[ans];
    if(score > 0) {
      total += score;
      if(score === 2) high.push(i);
      else if(score === 1) medium.push(i);
      else low.push(i);
    }
  }
  ordered = [...high, ...medium, ...low];

  // --- Group by section for readability ---
  let sectionMap = {};
  for(const i of ordered) {
    const sec = QUESTIONS[i].section || "‡∏≠‡∏∑‡πà‡∏ô‡πÜ";
    if(!sectionMap[sec]) sectionMap[sec] = [];
    sectionMap[sec].push(i);
  }

  let html = `<div style="
  background: #f8fafc;
  border-radius: 1.5rem;
  padding: 2.5rem 1.5rem;
  box-shadow: 0 4px 32px #38bdf822;
  font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;
  ">
  <!-- <h2 style="
    font-size:2.1rem;
    font-weight: bold;
    color: #0e2233;
    margin-bottom: 2rem;
    text-align:center;
    letter-spacing:0.01em;
    ">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î)</h2> -->
  <div style="display:flex; flex-direction:column; gap:2.5rem;">`;

  if (ordered.length === 0) {
    html += `<div style="margin-top:2.5rem; text-align:center; color:#16a34a; font-size:1.3em; font-weight:600;">
      ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á/‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á
    </div>`;
  } else {
    for(const sec in sectionMap) {
      let secIcon = SECTION_ICONS[sec] || "üîí";
      html += `<div style="margin-bottom:1.5em;">
        <div style="font-size:1.25em; font-weight:bold; color:#0ea5e9; margin-bottom:0.7em; display:flex;align-items:center;gap:0.5em;">
          <span style="font-size:1.5em;">${secIcon}</span> <u>${sec}</u>
        </div>
        <div style="display:flex; flex-direction:column; gap:1.5rem;">`;
      for(const i of sectionMap[sec]) {
        const ans = responses[i]?.choice;
        const score = SCORE_MAP[ans];
        const risk = QUESTIONS[i].risk;
        const fix = QUESTIONS[i].fix;
        const steps = QUESTIONS[i].steps;
        const comment = responses[i]?.comment ? `<div style="margin-top:0.7em; font-size:1.05em; color:#64748b;"><b>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> ${responses[i].comment}</div>` : "";
        let riskColor = score === 2 ? "#dc2626" : score === 1 ? "#d97706" : "#16a34a";
        let riskLabel = score === 2 ? "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á" : score === 1 ? "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á" : "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥";
        let riskIcon = score === 2 ? "üî•" : score === 1 ? "‚ö†Ô∏è" : "‚úÖ";
        html += `
        <div style="
          background: #fff;
          border-radius: 1.2rem;
          box-shadow: 0 2px 12px #38bdf822;
          padding: 1.2rem 1.2rem 1.2rem 1.2rem;
          font-size: 1.13rem;
          color: #0e2233;
          border-left: 8px solid ${riskColor};
          display: flex;
          flex-direction: column;
          gap: 0.7em;
          ">
          <div style="display:flex;align-items:center;gap:0.5em;">
            <span style="font-size:1.3em;color:${riskColor};">${riskIcon}</span>
            <span style="font-weight:600;">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${i+1}:</span>
            <span>${QUESTIONS[i].text}</span>
          </div>
          <div>
            <span style="font-size:1.05em;"><b>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö:</b> <span style="color:#0ea5e9;">${LABEL_MAP[ans]||"-"}</span></span>
            <span style="margin-left:1em; font-size:1.05em;">(‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span class="score" style="color:#0ea5e9;">${score}</span>)</span>
          </div>
          <div>
            <b>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á:</b> <span style="font-size:1.05em; color:${riskColor}; font-weight:bold;">${riskLabel}</span>
          </div>
          ${comment}
          <details style="margin-top:0.5em;">
            <summary style="cursor:pointer;font-weight:600;color:#0ea5e9;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</summary>
            <div style="margin-top:0.7em; color:#dc2626; font-size:1.05em;">
              <b>‚ö†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á:</b> ${risk}
            </div>
            <div style="margin-top:0.5em; color:#0ea5e9; font-size:1.05em;">
              <b>üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</b> ${fix}
            </div>
            <div style="margin-top:0.5em;">
              <b style="color:#0ea5e9;">üîπ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</b>
              <ul style="margin-left:1.5em; margin-top:0.3em; font-size:1.03em; color:#334155;">
                ${steps.map(step=>`<li style="margin-bottom:0.2em;">${step}</li>`).join("")}
              </ul>
            </div>
          </details>
        </div>`;
      }
      html += `</div></div>`;
    }
  }

  html += `</div>
    <div style="margin-top:2.5rem; font-size:1.3em; font-weight:bold; text-align:center;">
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á): <span class="score" style="color:#0ea5e9;">${total}</span> / ${QUESTIONS.length*2}
    </div>
    <div style="margin-top:0.7em; font-size:1.15em; text-align:center;">
      ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏£‡∏ß‡∏°: ${
        total >= QUESTIONS.length*1.5 ? '<span class="risk-high" style="font-size:1.1em;">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</span>' :
        total >= QUESTIONS.length*0.5 ? '<span class="risk-medium" style="font-size:1.1em;">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>' :
        '<span class="risk-low" style="font-size:1.1em;">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥</span>'
      }
    </div>
  </div>`;
  document.getElementById('summary').innerHTML = html;
  document.getElementById('summary').style.display = "block";

  // ‡πÅ‡∏™‡∏î‡∏á pro results ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢
  renderProResults(responses, QUESTIONS);
  setTimeout(()=>document.getElementById('proResultsSection').scrollIntoView({behavior:"smooth"}), 200);
}

// ---------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å AI ‡∏à‡∏≤‡∏Å aiforthai (API)
// ---------------------------
async function callAISummary() {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
  let summaryText = QUESTIONS.map((q,i) => {
    const ans = responses[i]?.choice;
    if(ans) return `‡∏Ç‡πâ‡∏≠: ${q.text}\n‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö: ${LABEL_MAP[ans]}\n`;
    return '';
  }).filter(Boolean).join('\n');
  try {
    const res = await fetch("https://api.aiforthai.in.th/summarize", {
      method: "POST",
      headers: {
        "Apikey": "SyvIiGOP07EK6fIcQdS20UWDjs79G7gP", // <-- ‡πÉ‡∏ä‡πâ API KEY ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏°‡∏≤
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: "text=" + encodeURIComponent(summaryText)
    });
    const data = await res.json();
    if(data && data.summary) {
      document.getElementById('aiSummary').innerText = data.summary;
    } else {
      document.getElementById('aiSummary').innerText = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ";
    }
  } catch(e) {
    document.getElementById('aiSummary').innerText = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ AI";
  }
}

// ---------------------------
// ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ/‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
// ---------------------------
document.getElementById('nextBtn').onclick = function() {
  // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö, ‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ
  saveCurrent();
  if(current < QUESTIONS.length-1) {
    current++;
    renderQuestion(current);
  } else {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
    let allAnswered = QUESTIONS.every((q,i) => responses[i]?.choice);
    if(allAnswered) {
      showSummary();
      // scroll ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•
      setTimeout(()=>document.getElementById('summarySection').scrollIntoView({behavior:"smooth"}), 200);
    } else {
      // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö
      let firstUnanswered = QUESTIONS.findIndex((q,i) => !responses[i]?.choice);
      if(firstUnanswered !== -1) {
        current = firstUnanswered;
        renderQuestion(current);
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏π‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ");
      }
    }
  }
};
document.getElementById('prevBtn').onclick = function() {
  // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö, ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
  saveCurrent();
  if(current > 0) {
    current--;
    renderQuestion(current);
  }
};
document.getElementById('assessmentForm').onsubmit = function(e) {
  // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ submit ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥
  e.preventDefault();
  return false;
};

// ---------------------------
// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡πÅ‡∏£‡∏Å
// ---------------------------
renderQuestion(current);

// ====== PRO REPORT LOGIC ======
function getRiskData(responses, QUESTIONS) {
  // For demo: asset = question, threat = risk, vuln = fix, consequence = risk
  // Likelihood: 1=‡πÉ‡∏ä‡πà, 2=‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à, 3=‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà
  // Impact: ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", "‡∏£‡∏∞‡∏ö‡∏ö", "‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢", "‡πÇ‡∏à‡∏°‡∏ï‡∏µ" ‡πÉ‡∏´‡πâ 3, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ 2
  // Risk Level: High (>=7), Medium (>=4), Low (<4)
  // Response: High=Mitigate/Avoid, Medium=Mitigate/Transfer, Low=Accept/Monitor
  let riskRows = [];
  let matrixRows = [];
  let responseRows = [];
  let heatmap = [[[],[],[]],[[],[],[]],[[],[],[]]]; // [impact-1][likelihood-1]
  for(let i=0;i<QUESTIONS.length;i++) {
    const ans = responses[i]?.choice;
    if(!ans) continue;
    const asset = QUESTIONS[i].text;
    const threat = QUESTIONS[i].risk;
    const vuln = QUESTIONS[i].fix;
    const consequence = QUESTIONS[i].risk;
    const likelihood = ans==="yes"?1 : ans==="partial"?2 : 3;
    let impact = /‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•|‡∏£‡∏∞‡∏ö‡∏ö|‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢|‡πÇ‡∏à‡∏°‡∏ï‡∏µ|‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•|‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π/.test(threat)?3:2;
    let riskScore = likelihood * impact;
    let riskLevel = riskScore>=7?"High":riskScore>=4?"Medium":"Low";
    let response = riskLevel==="High"?"Mitigate / Avoid":riskLevel==="Medium"?"Mitigate / Transfer":"Accept / Monitor";
    riskRows.push({asset,threat,vuln,consequence});
    matrixRows.push({asset,likelihood,impact,riskLevel});
    responseRows.push({asset,riskLevel,response});
    heatmap[impact-1][likelihood-1].push(riskLevel);
  }
  return {riskRows, matrixRows, responseRows, heatmap};
}

function getIRPData(responses, QUESTIONS) {
  // Incident type: ‡∏ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ö "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà" ‡πÉ‡∏ô 2FA, Patch, Backup, Log, Antivirus, IRP plan, Incident contact, Playbook, Segmentation, Firewall, Cloud
  // (index: 3,7,11,14,15,16,17,18,22,23,24)
  let types = [];
  if(responses[3]?.choice==="no") types.push("Account Compromise");
  if(responses[7]?.choice==="no") types.push("Vulnerability Exploitation");
  if(responses[11]?.choice==="no") types.push("Data Loss / Ransomware");
  if(responses[14]?.choice==="no"||responses[15]?.choice==="no") types.push("Malware Outbreak");
  if(responses[16]?.choice==="no"||responses[17]?.choice==="no") types.push("Incident Response Weakness");
  if(responses[18]?.choice==="no"||responses[22]?.choice==="no") types.push("Network Intrusion");
  if(responses[23]?.choice==="no"||responses[24]?.choice==="no") types.push("Cloud Security Issue");
  if(types.length===0) types.push("General Security Weakness");

  // CIRT Team Roles (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
  const cirtRoles = [
    {name:"‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢", role:"CIRT Lead", resp:"‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å"},
    {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏£‡∏ó‡∏¥‡∏û‡∏¢‡πå", role:"Technical Lead", resp:"‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤"},
    {name:"‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", role:"Compliance Officer", resp:"‡∏î‡∏π‡πÅ‡∏•‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô"},
    {name:"‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏£‡∏ó‡∏±‡∏¢", role:"IT Support", resp:"‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô"},
  ];

  // IRP Phases & Actions
  const phases = [
    {
      phase:"Preparation",
      actions:[
        {task:"‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô IRP", who:"CIRT Lead"},
        {task:"‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠", who:"Compliance Officer"},
        {task:"‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠", who:"CIRT Lead, IT Support"}
      ]
    },
    {
      phase:"Detection & Analysis",
      actions:[
        {task:"‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Log/SIEM", who:"Technical Lead"},
        {task:"‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö", who:"Technical Lead, CIRT Lead"},
        {task:"‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á", who:"CIRT Lead"}
      ]
    },
    {
      phase:"Containment & Recovery",
      actions:[
        {task:"‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå", who:"Technical Lead"},
        {task:"‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏£‡∏∞‡∏ö‡∏ö/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡∏£‡∏≠‡∏á", who:"IT Support"},
        {task:"‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö", who:"Technical Lead, IT Support"}
      ]
    },
       {
      phase:"Post-Incident Activities",
      actions:[
        {task:"‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ú‡∏ô", who:"CIRT Lead, Compliance Officer"},
        {task:"‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≥‡∏Å‡∏±‡∏ö", who:"Compliance Officer"},
        {task:"‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£", who:"CIRT Lead"}
      ]
    }
  ];
  return {types, cirtRoles, phases};
}

function renderProResults(responses, QUESTIONS) {
  const risk = getRiskData(responses, QUESTIONS);
   const riskOrder = { "High": 1, "Medium": 2, "Low": 3 };
  const sortedMatrixRows = [...risk.matrixRows].sort((a, b) => {
    return riskOrder[a.riskLevel] - riskOrder[b.riskLevel];
  });

  // Risk Scenario Table
  document.getElementById('riskScenarioRows').innerHTML = risk.riskRows.map(r=>`
    <tr>
      <td>${r.asset}</td>
      <td>${r.threat}</td>
      <td>${r.vuln}</td>
      <td>${r.consequence}</td>
    </tr>
  `).join("");

  // --- NEW: Answer Table ---
  let answerTableHtml = `
    <div class="mb-6">
      <div class="font-bold text-lg mb-2">Answer Table</div>
      <table class="result-table">
        <thead>
          <tr>
            <th>Asset</th>
            <th>Answer</th>
          </tr>
        </thead>
        <tbody>
          ${QUESTIONS.map((q, idx) => {
            const ans = responses[idx]?.choice;
            let label = ans === "yes" ? "‡πÉ‡∏ä‡πà" : ans === "partial" ? "‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à" : ans === "no" ? "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà" : "-";
            return `<tr>
              <td>${q.text}</td>
              <td>${label}</td>
            </tr>`;
          }).join("")}
        </tbody>
      </table>
    </div>
  `;
  // ‡πÅ‡∏ó‡∏£‡∏Å Answer Table ‡∏Å‡πà‡∏≠‡∏ô Risk Level Table
  document.getElementById('riskMatrixRows').parentElement.insertAdjacentHTML('beforebegin', answerTableHtml);

  // Likelihood & Impact Matrix
  document.getElementById('riskMatrixRows').innerHTML = sortedMatrixRows.map((r, idx)=>{
    const qIdx = QUESTIONS.findIndex(q=>q.text===r.asset);
    return `
      <tr>
        <td>${r.asset}</td>
        <td>${r.likelihood}</td>
        <td>${r.impact}</td>
        <td class="risk-${r.riskLevel.toLowerCase()}">
          ${
            r.riskLevel === "High"
            ? `<span style="color:#dc2626;cursor:pointer;text-decoration:underline;font-weight:bold;" class="show-detail" data-idx="${qIdx}" data-risk="high">HIGH</span>`
            : r.riskLevel === "Medium"
            ? `<span style="color:#d97706;cursor:pointer;text-decoration:underline;font-weight:bold;" class="show-detail" data-idx="${qIdx}" data-risk="medium">MEDIUM</span>`
            : `<span style="color:#16a34a;font-weight:bold;">LOW</span>`
          }
        </td>
      </tr>
    `;
  }).join("");

  // --- PRO Risk Heatmap ---
  // Legend
  const legend = `
    <div style="margin-bottom:1em;display:flex;gap:1.5em;align-items:center;">
      <span><span style="display:inline-block;width:1.2em;height:1.2em;background:#fecaca;border-radius:0.3em;margin-right:0.3em;border:1px solid #dc2626;"></span>High</span>
      <span><span style="display:inline-block;width:1.2em;height:1.2em;background:#fde68a;border-radius:0.3em;margin-right:0.3em;border:1px solid #d97706;"></span>Medium</span>
      <span><span style="display:inline-block;width:1.2em;height:1.2em;background:#bbf7d0;border-radius:0.3em;margin-right:0.3em;border:1px solid #16a34a;"></span>Low</span>
      <span style="margin-left:1.5em;color:#64748b;font-size:0.97em;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span>
    </div>
  `;
  // ‡πÉ‡∏™‡πà legend ‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á heatmap
  const heatmapTable = document.querySelector('.heatmap-table');
  if (heatmapTable && !document.getElementById('heatmapLegend')) {
    heatmapTable.insertAdjacentHTML('beforebegin', `<div id="heatmapLegend">${legend}</div>`);
  }

  // Heatmap interactive
  let heatmapHtml = "";
  for(let impact=3;impact>=1;impact--) {
    heatmapHtml += "<tr>";
    for(let likelihood=1;likelihood<=3;likelihood++) {
      let levels = risk.heatmap[impact-1][likelihood-1];
      // ‡∏´‡∏≤ asset ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô cell ‡∏ô‡∏µ‡πâ
      let assets = sortedMatrixRows.filter(r=>r.likelihood===likelihood && r.impact===impact);
      let cellClass = "heatmap-low";
      let riskType = "-";
      if(levels.includes("High")) { cellClass = "heatmap-high"; riskType = "High"; }
      else if(levels.includes("Medium")) { cellClass = "heatmap-medium"; riskType = "Medium"; }
      else if(levels.includes("Low")) { cellClass = "heatmap-low"; riskType = "Low"; }
      let count = assets.length;
      let assetList = assets.map(r=>`<li>${r.asset}</li>`).join("");
      heatmapHtml += `
        <td class="${cellClass} heatmap-cell" style="cursor:pointer;position:relative;" 
            data-impact="${impact}" data-likelihood="${likelihood}" data-risk="${riskType}" data-assets='${JSON.stringify(assets.map(r=>r.asset))}'>
          ${count ? `<b>${count}</b>` : "-"}
          <div class="heatmap-tooltip" style="display:none;position:absolute;z-index:10;left:50%;top:110%;transform:translateX(-50%);background:#fff;border:1px solid #e0e7ef;border-radius:0.7em;box-shadow:0 2px 12px #38bdf822;padding:1em;min-width:220px;">
            <div style="font-weight:bold;color:#0ea5e9;">Impact: ${impact}, Likelihood: ${likelihood}</div>
            <div style="margin:0.3em 0 0.5em 0;"><span style="font-weight:bold;color:${riskType==="High"?"#dc2626":riskType==="Medium"?"#d97706":"#16a34a"};">${riskType}</span></div>
            ${count ? `<div style="font-size:0.97em;"><b>Asset:</b><ul style="margin:0.2em 0 0 1.2em;">${assetList}</ul></div>` : `<div style="color:#64748b;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`}
          </div>
        </td>
      `;
    }
    heatmapHtml += "</tr>";
  }
  document.getElementById('heatmapGrid').innerHTML = heatmapHtml;

  // Tooltip ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
  document.querySelectorAll('.heatmap-cell').forEach(cell=>{
    cell.addEventListener('mouseenter', function() {
      this.querySelector('.heatmap-tooltip').style.display = 'block';
    });
    cell.addEventListener('mouseleave', function() {
      this.querySelector('.heatmap-tooltip').style.display = 'none';
    });
    cell.addEventListener('click', function() {
      const tooltip = this.querySelector('.heatmap-tooltip');
      tooltip.style.display = tooltip.style.display === 'block' ? 'none' : 'block';
    });
  });

  // Risk Response Table
  document.getElementById('riskResponseRows').innerHTML = risk.responseRows.map(r=>`
    <tr>
      <td>${r.asset}</td>
      <td class="risk-${r.riskLevel.toLowerCase()}">${r.riskLevel.toUpperCase()}</td>
      <td>${r.response}</td>
    </tr>
  `).join("");

  // IRP (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
  const irp = getIRPData(responses, QUESTIONS);
  document.getElementById('incidentSummary').innerHTML = `
    <b>Incident Classification:</b> <span style="color:#0ea5e9">${irp.types.join(", ")}</span>
  `;
  document.getElementById('cirtRolesRows').innerHTML = irp.cirtRoles.map(r=>`
    <tr>
      <td>${r.name}</td>
      <td>${r.role}</td>
      <td>${r.resp}</td>
    </tr>
  `).join("");
  document.getElementById('irpStepper').innerHTML = irp.phases.map((p,i)=>`
    <div class="stepper-phase">
      <div class="stepper-dot"></div>
      <div class="stepper-title">${i+1}. ${p.phase}</div>
      <table class="result-table stepper-table">
        <thead>
          <tr>
            <th>Key Action</th>
            <th>Responsible</th>
          </tr>
        </thead>
        <tbody>
          ${p.actions.map(a=>`
            <tr>
              <td>${a.task}</td>
              <td>${a.who}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    </div>
  `).join("");
  document.getElementById('proResultsSection').style.display = "block";

  // Event: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å HIGH ‡∏´‡∏£‡∏∑‡∏≠ MEDIUM (‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)
  setTimeout(()=>{
    document.querySelectorAll('.show-detail').forEach(cell=>{
      cell.onclick = function() {
        const i = +cell.getAttribute('data-idx');
        const riskType = cell.getAttribute('data-risk');
        const q = QUESTIONS[i];
        const ans = responses[i]?.choice;
        const score = SCORE_MAP[ans];
        let riskColor = riskType === "high" ? "#dc2626" : "#d97706";
        let riskLabel = riskType === "high" ? "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á" : "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á";
        let html = `
          <div class="mb-3">
            <span style="font-size:1.2em;font-weight:bold;">${q.text}</span>
          </div>
          <div class="mb-2"><b>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö:</b> <span style="color:#0ea5e9;">${LABEL_MAP[ans]||"-"}</span> (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score})</div>
          <div class="mb-2"><b>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á:</b> <span style="color:${riskColor};font-weight:bold;">${riskLabel}</span></div>
          <div class="mb-2"><b>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á:</b> <span style="color:${riskColor};">${q.risk}</span></div>
          <div class="mb-2"><b>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</b> <span style="color:#0ea5e9;">${q.fix}</span></div>
          <div class="mb-2"><b>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</b>
            <ul>${q.steps.map(step=>`<li>${step}</li>`).join("")}</ul>
          </div>
          ${responses[i]?.comment ? `<div class="mb-2"><b>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> ${responses[i].comment}</div>` : ""}
        `;
        document.getElementById('riskHighModalBody').innerHTML = html;
        new bootstrap.Modal(document.getElementById('riskHighModal')).show();
      };
    });
  }, 100);
}

// ---------------------------
// ‡∏™‡πà‡∏ß‡∏ô: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á IRP panel
// ---------------------------
(function() {
  const toggle = document.getElementById('irp-toggle');
  const panel = document.getElementById('irp-panel');
  const caret = document.getElementById('irp-caret');
  const storageKey = 'incidentResponsePanel:open';

  // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏≤‡∏Å localStorage
  let open = localStorage.getItem(storageKey) === "1";
  setPanel(open);

  function setPanel(isOpen) {
    if(isOpen) {
      panel.classList.add('open');
      panel.setAttribute('aria-hidden', 'false');
      toggle.setAttribute('aria-expanded', 'true');
      caret.style.transform = "rotate(90deg)";
      localStorage.setItem(storageKey, "1");
    } else {
      panel.classList.remove('open');
      panel.setAttribute('aria-hidden', 'true');
      toggle.setAttribute('aria-expanded', 'false');
      caret.style.transform = "rotate(0deg)";
      localStorage.setItem(storageKey, "0");
    }
  }

  function handleToggle(e) {
    if(e.type === "click" || e.key === "Enter" || e.key === " ") {
      open = !open;
      setPanel(open);
      e.preventDefault();
    }
  }
  toggle.addEventListener('click', handleToggle);
  toggle.addEventListener('keydown', handleToggle);

  // Responsive: ‡∏õ‡∏£‡∏±‡∏ö max-height ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î panel ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
  window.addEventListener('resize', ()=>{
    if(open) setPanel(true);
  });
})();
</script>
</body>
</html>