<?php
/*
|--------------------------------------------------------------------------
| р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╣Др╕Яр╕ер╣М (Thai Doc Block)
|--------------------------------------------------------------------------
| р╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ: р╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣Мр╣Бр╕ер╕░ Incident Response Plan
| Flow: р╕гр╕▒р╕Ъ input р╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й, р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З, р╣Бр╕кр╕Фр╕Зр╕Ьр╕е, р╕кр╣Ир╕Зр╕нр╕нр╕Бр╣Др╕Яр╕ер╣М
| Input: responses р╕Ир╕▓р╕Бр╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б
| Output: UI, export PDF/CSV/JSON
| Error: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ null, handle export error, validate input
| р╕кр╣Ир╕зр╕Щр╕Ыр╕гр╕░р╕Бр╕нр╕Ъ: р╕Яр╕нр╕гр╣Мр╕б, р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М, IRP, export, modal
*/
?>
<?php
// ---------------------------
// р╕кр╣Ир╕зр╕Щ PHP: р╕Бр╕│р╕лр╕Щр╕Фр╕Кр╕╕р╕Фр╕Др╕│р╕Цр╕▓р╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З
// ---------------------------
$questions = [
  [
    "section" => "р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е", // р╣Ар╕Юр╕┤р╣Ир╕бр╕лр╕бр╕зр╕Ф
    "icon" => "ЁЯЧВя╕П",
    "text" => "р╕бр╕╡р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕гр╕░р╕Ър╕Ъ/р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н р╕гр╕░р╕Ър╕╕р╕Кр╕▒р╕Фр╣Ар╕Ир╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕гр╕░р╕Ър╕╕р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н р╕нр╕▓р╕Ир╕Чр╕│р╣Гр╕лр╣Йр╕Вр╕▓р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Бр╕ер╕░р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕гр╕▒р╣Ир╕зр╣Др╕лр╕ер╕лр╕гр╕╖р╕нр╕кр╕╣р╕Нр╕лр╕▓р╕вр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╕гр╕░р╕Ър╕Ър╕кр╕│р╕Др╕▒р╕Нр╣Гр╕лр╣Йр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ",
    "steps" => [
      "р╕кр╕│р╕гр╕зр╕Ир╣Бр╕ер╕░р╕гр╕░р╕Ър╕╕р╕Вр╣Йр╕нр╕бр╕╣р╕е/р╕гр╕░р╕Ър╕Ър╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕Вр╕нр╕Зр╕нр╕Зр╕Др╣Мр╕Бр╕г",
      "р╕Ир╕▒р╕Фр╕Чр╕│р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕лр╕гр╕╖р╕н inventory",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "icon" => "ЁЯЧВя╕П",
    "text" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Нр╕Цр╕╣р╕Бр╕Ир╕▒р╕Фр╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Нр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕лр╕гр╕╖р╕нр╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╣Вр╕Фр╕вр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕нр╕Щр╕╕р╕Нр╕▓р╕Х",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕Хр╣Ир╕ер╕░р╕Ыр╕гр╕░р╣Ар╕ар╕Ч",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Ф policy р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕гр╕░р╕Фр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╕Хр╕┤р╕Фр╕Ыр╣Йр╕▓р╕вр╕лр╕гр╕╖р╕нр╕Бр╕│р╕лр╕Щр╕Ф label р╣Гр╕лр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╕нр╕Ър╕гр╕бр╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М",
    "icon" => "ЁЯФС",
    "text" => "р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Яр╕ер╣М/р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕кр╕│р╕Др╕▒р╕Нр╕Ир╕│р╕Бр╕▒р╕Фр╣Ар╕Йр╕Юр╕▓р╕░р╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Нр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Вр╕Фр╕вр╕Ьр╕╣р╣Йр╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣М р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕гр╕▒р╣Ир╕зр╣Др╕лр╕ер╕лр╕гр╕╖р╕нр╣Бр╕Бр╣Йр╣Др╕Вр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "fix" => "р╕Ир╕│р╕Бр╕▒р╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Ар╕Йр╕Юр╕▓р╕░р╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
    "steps" => [
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Яр╕ер╣М/р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М",
      "р╕Ыр╕гр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕кр╕б",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М",
    "icon" => "ЁЯФС",
    "text" => "р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Й 2FA/MFA р╕Бр╕▒р╕Ър╕Ър╕▒р╕Нр╕Кр╕╡р╕кр╕│р╕Др╕▒р╕Нр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Ър╕▒р╕Нр╕Кр╕╡р╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Бр╕ор╕Бр╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щр╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡ 2FA/MFA",
    "fix" => "р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ 2FA/MFA р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ър╕▒р╕Нр╕Кр╕╡р╕кр╕│р╕Др╕▒р╕Н",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡ 2FA/MFA р╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕Щр╕гр╕░р╕Ър╕Ъ/р╕Ър╕▒р╕Нр╕Кр╕╡",
      "р╣Бр╕Ир╣Йр╕Зр╣Бр╕ер╕░р╕нр╕Ър╕гр╕бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й"
    ]
  ],
  [
    "text" => "р╣Гр╕Кр╣Йр╕лр╕ер╕▒р╕Бр╕Бр╕▓р╕гр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Чр╣Ир╕▓р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ (Least Privilege) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕нр╕▓р╕Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ьр╕┤р╕Фр╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Йр╕Юр╕▓р╕░р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Ир╕нр╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И",
    "steps" => [
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Бр╕ер╕░р╕гр╕░р╕Ър╕Ъ",
      "р╕Ыр╕гр╕▒р╕Ър╕ер╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░"
    ]
  ],
  [
    "text" => "р╣Бр╕вр╕Бр╕Ър╕▒р╕Нр╕Кр╕╡ Admin р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Ър╕▒р╕Нр╕Кр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤ р╣Бр╕ер╕░р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Ър╕▒р╕Нр╕Кр╕╡ admin р╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Гр╕Щр╕Зр╕▓р╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕зр╕▒р╕Щ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╣Бр╕ер╕░р╕Вр╕вр╕▓р╕вр╕Ьр╕е",
    "fix" => "р╣Бр╕вр╕Бр╕Ър╕▒р╕Нр╕Кр╕╡ admin р╣Бр╕ер╕░р╕Ър╕▒р╕Нр╕Кр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ы",
    "steps" => [
      "р╕кр╕гр╣Йр╕▓р╕Зр╕Ър╕▒р╕Нр╕Кр╕╡ admin р╣Бр╕вр╕Бр╕Ир╕▓р╕Б user р╕Ыр╕Бр╕Хр╕┤",
      "р╣Гр╕Кр╣Йр╕Ър╕▒р╕Нр╕Кр╕╡ admin р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕зр╕ер╕▓р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣М admin р╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕гр╕▒р╕Ър╣Ар╕Вр╣Йр╕▓/р╕вр╣Йр╕▓р╕вр╕Зр╕▓р╕Щ/р╕ер╕▓р╕нр╕нр╕Б р╕Чр╕╡р╣Ир╕Ыр╕гр╕▒р╕Ъ/р╕Ыр╕┤р╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕▒р╕Щр╕Чр╕╡р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕нр╕Фр╕╡р╕Хр╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╕лр╕гр╕╖р╕нр╕Ьр╕╣р╣Йр╕вр╣Йр╕▓р╕вр╕Зр╕▓р╕Щр╕нр╕▓р╕Ир╕вр╕▒р╕Зр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕гр╕░р╕Ър╕Ър╣Др╕Фр╣Й",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Ыр╕┤р╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╕кр╕Цр╕▓р╕Щр╕░",
    "steps" => [
      "р╣Бр╕Ир╣Йр╕З HR/IT р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З",
      "р╕Ыр╕┤р╕Ф/р╕Ыр╕гр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕▒р╕Щр╕Чр╕╡",
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х/р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И",
    "icon" => "ЁЯЫбя╕П",
    "text" => "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Бр╕Юр╕Хр╕Кр╣Мр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓ (р╣Ар╕Кр╣Ир╕Щ р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕кр╕│р╕Др╕▒р╕Нр╕ар╕▓р╕вр╣Гр╕Щ 14 р╕зр╕▒р╕Щ) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕гр╕░р╕Ър╕Ър╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╕Ьр╣Ир╕▓р╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х",
    "fix" => "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Бр╕Юр╕Хр╕Кр╣Мр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Хр╕▓р╕бр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓",
    "steps" => [
      "р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Ыр╕гр╕░р╕Бр╕▓р╕ир╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И",
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╣Бр╕ер╕░р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕лр╕ер╕▒р╕Зр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕гр╕░р╕Ър╕Ър╕кр╕│р╕Др╕▒р╕Нр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Др╣Йр╕Щр╕Юр╕Ър╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Вр╕Ир╕бр╕Хр╕╡",
    "fix" => "р╕кр╣Бр╕Бр╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕гр╕░р╕Ър╕Ър╕кр╕│р╕Др╕▒р╕Нр╕нр╕вр╣Ир╕▓р╕Зр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╣Бр╕Бр╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И",
      "р╕Бр╕│р╕лр╕Щр╕Фр╕гр╕нр╕Ър╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ",
      "р╣Бр╕Бр╣Йр╣Др╕Вр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕Юр╕Ъ"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "icon" => "ЁЯТ╛",
    "text" => "р╕бр╕╡ Asset Inventory р╕Чр╕╡р╣Ир╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Ар╕кр╕бр╕нр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Др╕бр╣Ир╕Чр╕гр╕▓р╕Ър╕зр╣Ир╕▓р╕бр╕╡р╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╣Гр╕Фр╕Ър╣Йр╕▓р╕З р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Бр╕ер╕░р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х Asset Inventory",
    "steps" => [
      "р╕гр╕зр╕Ър╕гр╕зр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М/р╕гр╕░р╕Ър╕Ър╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф",
      "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Ар╕нр╕Бр╕кр╕▓р╕г",
      "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З"
    ]
  ],
  [
    "text" => "р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ/р╣Др╕Яр╕ер╣Мр╕кр╕│р╕Др╕▒р╕Нр╕Хр╕▓р╕бр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▓р╕Ир╕кр╕╣р╕Нр╕лр╕▓р╕вр╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "fix" => "р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▓р╕бр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Ф",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Фр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕Зр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕кр╕│р╕гр╕нр╕Зр╣Бр╕Ър╕Ъ Offline/Immutable/Offsite р╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕▒р╕Щ Ransomware р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕гр╕нр╕Зр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╕ер╕▒р╕Б",
    "fix" => "р╣Гр╕Кр╣Йр╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╣Бр╕Ър╕Ъ Offline/Immutable/Offsite",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Фр╕Щр╣Вр╕вр╕Ър╕▓р╕вр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕Зр╕Чр╕╡р╣Ир╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Ир╕▓р╕Бр╕кр╕│р╕гр╕нр╕З"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М",
    "icon" => "ЁЯФО",
    "text" => "р╕Бр╕│р╕лр╕Щр╕Ф RTO/RPO р╣Бр╕Ър╕Ър╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Зр╣Ир╕▓р╕вр╣Др╕зр╣Йр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Др╕бр╣Ир╕Чр╕гр╕▓р╕Ър╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ъ/р╕Вр╣Йр╕нр╕бр╕╣р╕е р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Яр╕╖р╣Йр╕Щр╕Яр╕╣р╣Др╕бр╣Ир╕Чр╕▒р╕Щр╣Ар╕зр╕ер╕▓",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Ф RTO/RPO р╣Гр╕лр╣Йр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ",
    "steps" => [
      "р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Др╕зр╕▓р╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Шр╕╕р╕гр╕Бр╕┤р╕И",
      "р╕Бр╕│р╕лр╕Щр╕Ф RTO/RPO",
      "р╣Бр╕Ир╣Йр╕Зр╣Гр╕лр╣Йр╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╕гр╕▒р╕Ър╕Чр╕гр╕▓р╕Ъ"
    ]
  ],
  [
    "text" => "р╣Ар╕Др╕вр╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Ир╕гр╕┤р╕Зр╣Гр╕Щ 6тАУ12 р╣Ар╕Фр╕╖р╕нр╕Щр╕Чр╕╡р╣Ир╕Ьр╣Ир╕▓р╕Щр╕бр╕▓р╣Бр╕ер╕░р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕нр╕▓р╕Ир╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Ир╕гр╕┤р╕Зр╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│",
    "steps" => [
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щ",
      "р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ",
      "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╣Бр╕ер╕░р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М",
    "icon" => "ЁЯЪи",
    "text" => "р╕гр╕зр╕Ър╕гр╕зр╕б Logs р╣Др╕зр╣Йр╕Чр╕╡р╣Ир╕Ир╕╕р╕Фр╕Бр╕ер╕▓р╕З (р╣Ар╕Кр╣Ир╕Щ Syslog/SIEM) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕е Log р╕нр╕▓р╕Ир╕Бр╕гр╕░р╕Ир╕▒р╕Фр╕Бр╕гр╕░р╕Ир╕▓р╕в р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕вр╣Йр╕нр╕Щр╕лр╕ер╕▒р╕Зр╣Др╕Фр╣Йр╕вр╕▓р╕Б",
    "fix" => "р╕гр╕зр╕Ър╕гр╕зр╕б Log р╣Др╕зр╣Йр╕Чр╕╡р╣Ир╕Ир╕╕р╕Фр╕Бр╕ер╕▓р╕З",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╣Вр╕Лр╕ер╕╣р╕Кр╕▒р╕Щ Log Centralization",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Гр╕лр╣Йр╕кр╣Ир╕З Log",
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Log р╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕гр╕░р╕Ър╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Ар╕лр╕Хр╕╕р╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤р╣Бр╕ер╕░р╕бр╕╡р╕Др╕Щр╣Ар╕Эр╣Йр╕▓р╕Фр╕╣р╣Гр╕Щр╣Ар╕зр╕ер╕▓р╕Зр╕▓р╕Щр╕лр╕гр╕╖р╕н 24/7 р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕лр╕Хр╕╕р╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤р╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╕Хр╕гр╕зр╕Ир╕Юр╕Ър╕ер╣Ир╕▓р╕Кр╣Йр╕▓",
    "fix" => "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Бр╕ер╕░р╕бр╕╡р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ",
      "р╕бр╕нр╕Ър╕лр╕бр╕▓р╕вр╕Ьр╕╣р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕бр╕▒р╕ер╣Бр╕зр╕гр╣М",
    "icon" => "ЁЯжа",
    "text" => "р╕Чр╕╕р╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╡ Antivirus/EDR р╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕нр╕▓р╕Ир╕Хр╕┤р╕Фр╕бр╕▒р╕ер╣Бр╕зр╕гр╣Мр╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕лр╕гр╕╖р╕нр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х",
    "fix" => "р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Antivirus/EDR р╣Бр╕ер╕░р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╣Вр╕Лр╕ер╕╣р╕Кр╕▒р╕Щ Antivirus/EDR",
      "р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Гр╕Щр╕Чр╕╕р╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕лр╣Йр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ър╕гр╕┤р╕лр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г",
    "icon" => "ЁЯСФ",
    "text" => "р╕бр╕╡р╣Бр╕Ьр╕Щ IRP р╣Ар╕Ыр╣Зр╕Щр╕ер╕▓р╕вр╕ер╕▒р╕Бр╕йр╕Ур╣Мр╕нр╕▒р╕Бр╕йр╕гр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Др╕бр╣Ир╣Ар╕Бр╕┤р╕Щ 12 р╣Ар╕Фр╕╖р╕нр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╕▓р╕Фр╣Бр╕Ьр╕Щр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М р╕нр╕▓р╕Ир╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╕ер╣Ир╕▓р╕Кр╣Йр╕▓р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Бр╕Ьр╕Щ IRP",
    "steps" => [
      "р╣Ар╕Вр╕╡р╕вр╕Щр╣Бр╕Ьр╕Щ IRP р╣Гр╕лр╣Йр╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Чр╕╕р╕Бр╕Ыр╕╡",
      "р╣Бр╕Ир╣Йр╕Зр╣Гр╕лр╣Йр╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╕гр╕▒р╕Ър╕Чр╕гр╕▓р╕Ъ"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ/р╣Ар╕Ър╕нр╕гр╣Мр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щ (р╣Гр╕ЩтАУр╕Щр╕нр╕Бр╕нр╕Зр╕Др╣Мр╕Бр╕г) р╕Чр╕╡р╣Ир╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Фр╣Йр╣Ар╕гр╣Зр╕зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Ьр╕╣р╣Йр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╣Бр╕ер╕░р╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щ",
    "steps" => [
      "р╕гр╕зр╕Ър╕гр╕зр╕бр╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╣Бр╕ер╕░р╣Ар╕Ър╕нр╕гр╣Мр╕Хр╕┤р╕Фр╕Хр╣Ир╕н",
      "р╕Ир╕▒р╕Фр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щр╕Чр╕╡р╣Ир╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕Зр╣Ир╕▓р╕в",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Вр╣Йр╕нр╕бр╕╣р╕е"
    ]
  ],
  [
    "text" => "р╕бр╕╡ Playbook р╕нр╕вр╣Ир╕▓р╕Зр╕Щр╣Йр╕нр╕вр╕Яр╕┤р╕Кр╕Кр╕┤р╕З/р╕бр╕▒р╕ер╣Бр╕зр╕гр╣М/р╣Бр╕гр╕Щр╕Лр╕▒р╕бр╣Бр╕зр╕гр╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╕▓р╕Фр╣Бр╕Щр╕зр╕Чр╕▓р╕Зр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕р╣Ар╕Йр╕Юр╕▓р╕░р╕лр╕Щр╣Йр╕▓",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│ Playbook р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕кр╕│р╕Др╕▒р╕Н",
    "steps" => [
      "р╕гр╕░р╕Ър╕╕р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в",
      "р╣Ар╕Вр╕╡р╕вр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Бр╕Хр╣Ир╕ер╕░р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М",
      "р╕нр╕Ър╕гр╕бр╕Чр╕╡р╕бр╕Зр╕▓р╕Щ"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕лр╕Хр╕╕р╣Др╕бр╣Ир╣Гр╕лр╣Йр╕ер╕▓р╕б р╣Бр╕ер╕░р╣Ар╕Др╕вр╕Лр╣Йр╕нр╕бр╣Бр╕ер╣Йр╕зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕нр╕▓р╕Ир╕ер╕╕р╕Бр╕ер╕▓р╕бр╕Вр╕вр╕▓р╕вр╕зр╕Зр╕Бр╕зр╣Йр╕▓р╕З",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕лр╕Хр╕╕р╣Бр╕ер╕░р╕Лр╣Йр╕нр╕бр╕гр╕▒р╕Ър╕бр╕╖р╕н",
    "steps" => [
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕лр╕Хр╕╕",
      "р╕Лр╣Йр╕нр╕бр╕гр╕▒р╕Ър╕бр╕╖р╕нр╕Бр╕▒р╕Ър╕Чр╕╡р╕бр╕Зр╕▓р╕Щ",
      "р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╕▓р╕бр╕Ьр╕ер╕Лр╣Йр╕нр╕б"
    ]
  ],
  [
    "text" => "р╣Ар╕Др╕вр╕Лр╣Йр╕нр╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╕Ыр╕╡р╕ер╕░р╕Др╕гр╕▒р╣Йр╕З р╣Бр╕ер╕░р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щ/р╕Ыр╕гр╕▒р╕Ър╣Бр╕Ьр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╕нр╕▓р╕Ир╣Др╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Ир╕гр╕┤р╕З",
    "fix" => "р╕Лр╣Йр╕нр╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╣Бр╕ер╕░р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╕Чр╕╕р╕Бр╕Ыр╕╡",
    "steps" => [
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕Лр╣Йр╕нр╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣М",
      "р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕Лр╣Йр╕нр╕б",
      "р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╣Бр╕ер╕░р╕Ыр╕гр╕▒р╕Ър╣Бр╕Ьр╕Щ"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Хр╕▓р╕бр╕Бр╕Ор╕лр╕бр╕▓р╕в",
    "icon" => "ЁЯУЬ",
    "text" => "р╣Бр╕Ьр╕Щ BCP/DR р╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ IRP р╣Бр╕ер╕░р╣Ар╕Др╕вр╕Чр╕Фр╕кр╕нр╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Бр╕Ьр╕Щ BCP/DR р╣Др╕бр╣Ир╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ IRP р╕нр╕▓р╕Ир╕Яр╕╖р╣Йр╕Щр╕Яр╕╣р╕гр╕░р╕Ър╕Ър╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Хр╕▓р╕бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в",
    "fix" => "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ьр╕Щ BCP/DR р╣Гр╕лр╣Йр╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ IRP",
    "steps" => [
      "р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Бр╕Ьр╕Щ BCP/DR р╕Бр╕▒р╕Ъ IRP",
      "р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Гр╕лр╣Йр╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Щ",
      "р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ьр╕Щр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "text" => "р╕Чр╕гр╕▓р╕Ъ PDPA/р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕ер╕╣р╕Бр╕Др╣Йр╕▓ р╣Бр╕ер╕░р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕нр╕▓р╕Ир╕ер╕░р╣Ар╕бр╕┤р╕Фр╕Бр╕Ор╕лр╕бр╕▓р╕вр╕лр╕гр╕╖р╕нр╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕ир╕╢р╕Бр╕йр╕▓р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╣Бр╕ер╕░р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕",
    "steps" => [
      "р╕ир╕╢р╕Бр╕йр╕▓р╕Бр╕Ор╕лр╕бр╕▓р╕в/р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З",
      "р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕",
      "р╕нр╕Ър╕гр╕бр╕Чр╕╡р╕бр╕Зр╕▓р╕Щ"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н CERT/р╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Нр╕ар╕▓р╕вр╕Щр╕нр╕Бр╣Др╕зр╣Йр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Вр╕нр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕нр╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Нр╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡",
    "fix" => "р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н CERT/р╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Нр╣Др╕зр╣Йр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓",
    "steps" => [
      "р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕е CERT/р╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Н",
      "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕н"
    ]
  ],
  [
    "section" => "р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ",
    "icon" => "ЁЯМР",
    "text" => "р╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╣Бр╕Ър╣Ир╕Зр╣Вр╕Лр╕Щ/р╣Ар╕Лр╕Бр╣Ар╕бр╕Щр╕Хр╣Мр╕ер╕Фр╕Бр╕▓р╕гр╕ер╕▓р╕бр╕Вр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕нр╕▓р╕Ир╕ер╕╕р╕Бр╕ер╕▓р╕бр╣Др╕Ыр╕вр╕▒р╕Зр╕гр╕░р╕Ър╕Ър╕нр╕╖р╣Ир╕Щр╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в",
    "fix" => "р╣Бр╕Ър╣Ир╕Зр╣Вр╕Лр╕Щр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Фр╕Бр╕▓р╕гр╕ер╕▓р╕б",
    "steps" => [
      "р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕в",
      "р╕Бр╕│р╕лр╕Щр╕Фр╣Вр╕Лр╕Щ/segment",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ firewall р╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╣Вр╕Лр╕Щ"
    ]
  ],
  [
    "text" => "р╕Чр╕Ър╕Чр╕зр╕Щр╕Бр╕Ор╣Др╕Яр╕гр╣Мр╕зр╕нр╕ер╕ер╣М р╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡",
    "fix" => "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
    "steps" => [
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕О firewall",
      "р╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Гр╕Кр╣Й",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░"
    ]
  ],
  [
    "section" => "Cloud/р╕Др╕ер╕▓р╕зр╕Фр╣М",
    "icon" => "тШБя╕П",
    "text" => "р╕Др╕ер╕▓р╕зр╕Фр╣Мр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ (MFA/Logs/Encryption) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕Ър╕Щр╕Др╕ер╕▓р╕зр╕Фр╣Мр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕лр╕гр╕╖р╕нр╣Вр╕Ир╕бр╕Хр╕╡р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в",
    "fix" => "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Ър╕Щр╕Др╕ер╕▓р╕зр╕Фр╣М",
    "steps" => [
      "р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Й MFA",
      "р╣Ар╕Ыр╕┤р╕Ф Logging",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Encryption"
    ]
  ]
];
?>
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Cyber IRP Risk Assessment (PHP)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/avif" href="logo.avif">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ---------------------------
       р╕кр╣Ир╕зр╕Щ CSS: р╕Хр╕Бр╣Бр╕Хр╣Ир╕Зр╕лр╕Щр╣Йр╕▓р╕Хр╕▓р╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б
       --------------------------- */
    body {
      background: linear-gradient(135deg, #f0fdfa 0%, #e0f2fe 100%);
    }
    .cyber-glow {
      /* р╣Гр╕кр╣Ир╣Ар╕Зр╕▓р╣Гр╕лр╣Йр╕лр╕▒р╕зр╕Вр╣Йр╕н */
      text-shadow: 0 2px 8px #38bdf8, 0 0px 2px #0ea5e9;
      letter-spacing: 0.03em;
    }
    .question-card {
      /* р╕Бр╕ер╣Ир╕нр╕Зр╕Др╕│р╕Цр╕▓р╕б */
      background: #fff;
      border: none;
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 #38bdf822;
      max-width: 600px;
      margin: 0 auto;
      transition: box-shadow 0.2s;
      padding: 2.5rem 2rem 2rem 2rem;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      animation: fadeInUp 0.5s;
    }
    @keyframes fadeInUp {
      from { opacity:0; transform: translateY(30px);}
      to { opacity:1; transform: translateY(0);}
    }
    .question-card:after {
      /* р╣Ар╕кр╣Йр╕Щ gradient р╣Гр╕Хр╣Йр╕Бр╕ер╣Ир╕нр╕З */
      content: "";
      position: absolute;
      left: 1.5rem; right: 1.5rem; bottom: 0;
      height: 4px;
      border-radius: 2px;
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      opacity: 0.12;
    }
    .question-progress {
      /* р╣Бр╕Цр╕Ъ progress */
      background: #e0f2fe;
      border-radius: 1rem;
      overflow: hidden;
      height: 12px;
      margin-bottom: 2rem;
      box-shadow: 0 1px 4px #38bdf822;
    }
    .question-progress-bar {
      /* progress bar р╕кр╕╡р╕Яр╣Йр╕▓ */
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      height: 100%;
      transition: width 0.4s cubic-bezier(.4,2,.6,1);
    }
    .radio-group {
      /* р╕Бр╕ер╕╕р╣Ир╕б radio button */
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 0.5rem;
    }
    .radio-group label {
      /* р╕Ыр╕╕р╣Ир╕бр╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б */
      background: #f1f5f9;
      border-radius: 0.5rem;
      padding: 0.45rem 1.2rem 0.45rem 1rem;
      font-weight: 500;
      cursor: pointer;
      border: 1.5px solid transparent;
      transition: border 0.2s, background 0.2s;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 1rem;
    }
    .radio-group input[type="radio"] {
      margin-right: 0.3rem;
    }
    .radio-group input[type="radio"]:checked + span {
      color: #0ea5e9;
      font-weight: 700;
    }
    .radio-group input[type="radio"]:focus + span {
      outline: 2px solid #38bdf8;
    }
    .question-section {
      /* р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И (р╕Цр╣Йр╕▓р╕бр╕╡) */
      color: #0ea5e9;
      font-weight: 600;
      font-size: 1.05rem;
      margin-bottom: 0.2rem;
      letter-spacing: 0.01em;
    }
    .question-number {
      /* р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Вр╣Йр╕н */
      position: absolute;
      top: 1.2rem;
      right: 2rem;
      color: #b6c7d6;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.04em;
    }
    .question-card input[type="text"] {
      /* р╕Кр╣Ир╕нр╕Зр╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ */
      background: #f8fafc;
      border: 1.5px solid #e0f2fe;
      border-radius: 0.6rem;
      padding: 0.7rem 1rem;
      font-size: 1rem;
      margin-top: 0.2rem;
      transition: border 0.2s;
      width: 100%;
    }
    .question-card input[type="text"]:focus {
      border-color: #38bdf8;
      outline: none;
      background: #fff;
    }
    .btn-main {
      /* р╕Ыр╕╕р╣Ир╕бр╕Цр╕▒р╕Фр╣Др╕Ы */
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      color: #fff;
      font-weight: 600;
      border-radius: 0.7rem;
      padding: 0.7rem 2.2rem;
      box-shadow: 0 2px 8px #38bdf822;
      transition: background 0.2s, box-shadow 0.2s;
      border: none;
    }
    .btn-main:hover, .btn-export:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 24px #38bdf822;
    }
    .btn-secondary {
      /* р╕Ыр╕╕р╣Ир╕бр╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ */
      background: #f1f5f9;
      color: #0ea5e9;
      font-weight: 600;
      border-radius: 0.7rem;
      padding: 0.7rem 2.2rem;
      border: none;
      transition: background 0.2s;
    }
    .btn-secondary:hover {
      background: #e0f2fe;
    }
    .btn-group > * { margin: 0 0.3rem 0.5rem 0.3rem; }
    @media (max-width: 600px) {
      /* Responsive р╕кр╕│р╕лр╕гр╕▒р╕Ър╕бр╕╖р╕нр╕Цр╕╖р╕н */
      .question-card { padding: 1.2rem 0.7rem 1.2rem 0.7rem; }
      .question-number { right: 1rem; top: 0.7rem; }
      .radio-group label { font-size: 0.97rem; padding: 0.4rem 0.8rem 0.4rem 0.7rem; }
    }
    @media print {
      /* р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Юр╕┤р╕бр╕Юр╣М/Export PDF */
      .print\:hidden { display: none !important; }
      body { background: #fff !important; }
      .question-card { box-shadow: none !important; border: 1px solid #bbb !important; }
      #exportBtns { display: none !important; }
    }
    .panel-header { font-size:1.25rem; font-weight:700; color:#2563eb; background:#f1f5f9; border-radius:0.7rem 0.7rem 0 0; padding:1rem 1.5rem; cursor:pointer; display:flex; align-items:center; justify-content:space-between; }
    .panel-content { display:none; background:#fff; border-radius:0 0 0.7rem 0.7rem; border:1px solid #e0e7ef; border-top:none; padding:1.5rem; }
    .panel.active .panel-content { display:block; }
    .panel { margin-bottom:2rem; box-shadow:0 2px 12px #38bdf822; border-radius:0.7rem; }
    .panel-header svg { transition:transform 0.2s; }
    .panel.active .panel-header svg { transform:rotate(90deg);}
    .result-table { width:100%; border-collapse:collapse; margin-bottom:1.5rem; }
    .result-table th, .result-table td { border:1px solid #e0e7ef; padding:0.7em 1em; text-align:left; }
    .result-table th { background:#f1f5f9; font-weight:700; }
    .result-table tr:nth-child(even) { background:#f8fafc; }
    .risk-high { color:#dc2626; font-weight:bold; }
    .risk-medium { color:#d97706; font-weight:bold; }
    .risk-low { color:#16a34a; font-weight:bold; }
    .heatmap-table { border-collapse:collapse; margin:1.5rem auto; }
    .heatmap-table td, .heatmap-table th { width:60px; height:40px; text-align:center; font-weight:600; border:1px solid #e0e7ef; }
    .heatmap-low { background:#bbf7d0; }
    .heatmap-medium { background:#fde68a; }
    .heatmap-high { background:#fecaca; }
    .stepper { border-left:4px solid #38bdf8; margin-left:1.5rem; padding-left:2rem; }
    .stepper-phase { position:relative; margin-bottom:2.5rem; }
    .stepper-phase:last-child { margin-bottom:0; }
    .stepper-dot { position:absolute; left:-2.2rem; top:0.2rem; width:1.3rem; height:1.3rem; background:#38bdf8; border-radius:50%; border:3px solid #fff; box-shadow:0 0 0 2px #38bdf8; }
    .stepper-title { font-size:1.1rem; font-weight:700; color:#0ea5e9; margin-bottom:0.5rem; }
    .stepper-table { margin-bottom:0.7rem; }
    .stepper-table th, .stepper-table td { font-size:0.98rem; }
    .summary-card { background:#f1f5f9; border-radius:0.7rem; padding:1.2rem 1.5rem; margin-bottom:1.5rem; font-size:1.1rem; }
    .export-btns { margin-top:2rem; display:flex; flex-wrap:wrap; gap:0.7rem; justify-content:center; }
    .btn-export { background:#f1f5f9; color:#0ea5e9; font-weight:600; border-radius:0.7rem; padding:0.7rem 2.2rem; border:none; transition:background 0.2s; }
    .btn-export:hover { background:#e0f2fe; }
    /* ---------------------------
       р╕кр╣Ир╕зр╕Щ CSS: р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М Pro Report
       --------------------------- */
    .panel-header { background: #f1f5f9; }
    .panel-header span { font-weight: 600; }
    .panel-content { background: #fff; border: 1px solid #e0e7ef; }
    .result-table th {
      background: #f1f5f9;
      color: #0e2233;
      font-weight: 600;
    }
    .result-table td {
      background: #fff;
      color: #0e2233;
    }
    .risk-high { color:#dc2626; font-weight:bold; }
    .risk-medium { color:#d97706; font-weight:bold; }
    .risk-low { color:#16a34a; font-weight:bold; }
    .heatmap-table td, .heatmap-table th {
      background: #f1f5f9;
      color: #0e2233;
      font-weight: 600;
    }
    .stepper-dot { background:#38bdf8; }
    .stepper-title { color:#0ea5e9; }
    /* ---------------------------
       р╕кр╣Ир╕зр╕Щ CSS: р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ъ Modal
       --------------------------- */
    .modal-content {
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 #38bdf822;
    }
    .modal-header {
      border-bottom: 1px solid #e0e7ef;
    }
    .modal-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #0e2233;
    }
    .modal-body {
      font-size: 1rem;
      color: #0e2233;
    }
    /* р╕Ыр╕гр╕▒р╕Ър╕Вр╕Щр╕▓р╕Ф modal р╕кр╕│р╕лр╕гр╕▒р╕Ър╕лр╕Щр╣Йр╕▓р╕Ир╕нр╣Ар╕ер╣Зр╕Б */
    @media (max-width: 768px) {
      .modal-dialog {
        max-width: 90%;
        margin: 1rem auto;
      }
    }
  </style>
  <!-- р╣Ар╕Юр╕┤р╣Ир╕б Bootstrap 5 CSS/JS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<div class="max-w-xl mx-auto my-8 p-2">
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б (р╣Вр╕ер╣Вр╕Бр╣Й/р╕лр╕▒р╕зр╕Вр╣Йр╕н)
       --------------------------- -->
  <div class="flex flex-col items-center mb-8">
    <!-- р╣Вр╕ер╣Вр╕Бр╣Йр╕Ър╕гр╕┤р╕йр╕▒р╕Чр╣Бр╕Ър╕Ър╣Вр╕Ыр╕г (р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣М logo.avif) -->
    <img 
      src="logo.avif" 
      alt="HackerProtect Pro Logo" 
      style="
        width:110px;
        margin-bottom:18px;
        border-radius: 22px;
        box-shadow: 0 6px 32px 0 #38bdf855, 0 1px 2px #0ea5e955;
        background: linear-gradient(135deg, #f0fdfa 0%, #e0f2fe 100%);
        border: 2.5px solid #38bdf8;
        padding: 8px;
        transition: box-shadow 0.2s;
      "
      class="hover:scale-105 transition-transform duration-200"
    >
    <!-- р╕лр╕▒р╕зр╕Вр╣Йр╕нр╕лр╕ер╕▒р╕Бр╣Бр╕Ър╕Ъ Paradise Resort Style -->
    <h1 
      class="text-4xl md:text-5xl font-extrabold text-center mb-2"
      style="
        color: #0e2233;
        letter-spacing: 0.03em;
        text-shadow:
          0 6px 32px #38bdf822,
          0 2px 8px #0ea5e9,
          0 1px 0 #fff,
          0 0 2px #fff;
        font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;
        background: none;
        -webkit-background-clip: initial;
        -webkit-text-fill-color: initial;
        background-clip: initial;
      "
    >
      CHECK RISK
      <span 
        class="align-super font-bold"
        style="
          font-size:0.7em;
          margin-left:0.2em;
          letter-spacing:0.05em;
          color: #38bdf8;
          text-shadow:0 2px 8px #38bdf8, 0 0px 2px #0ea5e9;
          font-family: inherit;
        "
      >
    </div>
    <p 
      class="text-center text-cyan-800 text-lg md:text-xl font-medium mb-2"
      style="font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;"
    >
      р╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╕Юр╕гр╣Йр╕нр╕бр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣Мр╕ар╕▓р╕вр╣Гр╕Щр╕нр╕Зр╕Др╣Мр╕Бр╕г
    </p>
  </div>
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щр╕Яр╕нр╕гр╣Мр╕бр╕Др╕│р╕Цр╕▓р╕б
       --------------------------- -->
  <section id="formSection">
    <!-- Progress bar -->
    <div class="question-progress">
      <div id="progressBar" class="question-progress-bar" style="width:0%"></div>
    </div>
    <form id="assessmentForm" autocomplete="off">
      <div id="questionBox"></div>
      <!-- р╕Ыр╕╕р╣Ир╕бр╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ/р╕Цр╕▒р╕Фр╣Др╕Ы -->
      <div class="btn-group flex flex-row gap-2 mt-4 justify-center print:hidden">
        <button type="button" id="prevBtn" class="btn-secondary" style="min-width:110px;">р╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ</button>
        <button type="button" id="nextBtn" class="btn-main" style="min-width:110px;">р╕Цр╕▒р╕Фр╣Др╕Ы</button>
      </div>
    </form>
  </section>
  <!-- =========================
       р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М Risk Assessment & IRP
       ========================= -->
  <section id="proResultsSection" style="display:none;">
    <h2 class="text-2xl font-bold mb-6 text-center text-blue-800">Risk Assessment Results</h2>
    <!-- Collapsible Panels -->
    <div class="panel active" id="panel-risk">
      <div class="panel-header">
        <span>Cybersecurity Risk Assessment</span>
        <svg width="18" height="18" fill="none"><path d="M6 7l3 3 3-3" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>
      </div>
      <div class="panel-content">
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">Risk Scenario Table</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Threat Event</th>
                <th>Vulnerability</th>
                <th>Consequence</th>
              </tr>
            </thead>
            <tbody id="riskScenarioRows"></tbody>
          </table>
        </div>
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">Likelihood & Impact Matrix</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Likelihood (1-3)</th>
                <th>Impact (1-3)</th>
                <th>Risk Level</th>
              </tr>
            </thead>
            <tbody id="riskMatrixRows"></tbody>
          </table>
          <div class="mt-4">
            <div class="font-bold text-lg mb-2">Risk Heatmap</div>
            <table class="heatmap-table">
              <tr>
                <th rowspan="2" style="writing-mode:vertical-lr;transform:rotate(180deg);">Impact</th>
                <th colspan="3">Likelihood</th>
              </tr>
              <tr>
                <th>1</th><th>2</th><th>3</th>
              </tr>
              <tbody id="heatmapGrid"></tbody>
            </table>
          </div>
        </div>
        <div>
          <div class="font-bold text-lg mb-2">Risk Response Table</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Risk Level</th>
                <th>Recommended Response</th>
              </tr>
            </thead>
            <tbody id="riskResponseRows"></tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="panel" id="panel-irp">
      <div
        id="irp-toggle"
        class="panel-header"
        tabindex="0"
        role="button"
        aria-expanded="false"
        aria-controls="irp-panel"
        data-testid="irp-toggle"
        style="user-select:none;outline:none;display:flex;align-items:center;justify-content:space-between;cursor:pointer;"
      >
        <span>Incident Response Plan</span>
        <svg id="irp-caret" width="18" height="18" fill="none" style="transition:transform 0.3s;">
          <path d="M6 7l3 3 3-3" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <div
        id="irp-panel"
        class="panel-content"
        data-testid="irp-panel"
        style="overflow:hidden;max-height:0;transition:max-height 0.4s cubic-bezier(.4,2,.6,1);"
        aria-hidden="true"
      >
        <!-- ...р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓ IRP р╣Ар╕Фр╕┤р╕б... -->
        <div class="summary-card mb-6" id="incidentSummary"></div>
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">CIRT Team Roles</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Role</th>
                <th>Responsibility</th>
              </tr>
            </thead>
            <tbody id="cirtRolesRows"></tbody>
          </table>
        </div>
        <div>
          <div class="font-bold text-lg mb-2">Incident Response Phases</div>
          <div class="stepper" id="irpStepper"></div>
        </div>
      </div>
    </div>
    <div class="export-btns print:hidden">
      <button type="button" class="btn-export" id="exportPDF2">Export PDF</button>
      <button type="button" class="btn-export" id="exportCSV2">Export CSV</button>
      <button type="button" class="btn-export" id="exportJSON2">Export JSON</button>
    </div>
  </section>
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щр╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╣Бр╕ер╕░р╕Ыр╕╕р╣Ир╕б Export
       --------------------------- -->
  <section id="summarySection" style="display:none">
    <div id="summary" class="mt-10"></div>
    <div id="exportBtns" class="export-btns print:hidden">
      <button type="button" class="btn-export" id="exportPDF">Export PDF</button>
      <button type="button" class="btn-export" id="exportCSV">Export CSV</button>
      <button type="button" class="btn-export" id="exportJSON">Export JSON</button>
      <button type="button" class="btn-export" onclick="window.print()">Print</button>
    </div>
  </section>
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щ Footer
       --------------------------- -->
  <footer class="mt-12 text-center text-xs text-cyan-700 print:text-black">
    &copy; <?= date('Y') ?> Cyber IRP Risk Assessment | For internal use only
  </footer>
</div>
<!-- р╣Ар╕Юр╕┤р╣Ир╕б Modal HTML р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З -->
<div class="modal fade" id="riskHighModal" tabindex="-1" aria-labelledby="riskHighModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="riskHighModalLabel">р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="р╕Ыр╕┤р╕Ф"></button>
      </div>
      <div class="modal-body" id="riskHighModalBody">
        <!-- р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Хр╕гр╕Зр╕Щр╕╡р╣Й -->
      </div>
    </div>
  </div>
</div>
<div id="app" class="container mx-auto px-4 py-8">
  <!-- р╣Вр╕Др╣Йр╕Ф JavaScript р╕Ир╕░р╣Бр╕Чр╕гр╕Б UI р╣Гр╕Щр╕Щр╕╡р╣Й -->
</div>
<script>
// ---------------------------
// р╕кр╣Ир╕зр╕Щ: р╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣И/р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓
// ---------------------------
const QUESTIONS = <?php echo json_encode($questions); ?>;
const SCORE_MAP = { yes: 0, partial: 1, no: 2 };
const LABEL_MAP = { yes: "р╣Гр╕Кр╣И", partial: "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", no: "р╣Др╕бр╣Ир╣Гр╕Кр╣И" };
const SECTION_ICONS = {
  "р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е": "ЁЯЧВя╕П",
  "р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М": "ЁЯФС",
  "р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х/р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И": "ЁЯЫбя╕П",
  "р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е": "ЁЯТ╛",
  "р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М": "ЁЯФО",
  "р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М": "ЁЯЪи",
  "р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕бр╕▒р╕ер╣Бр╕зр╕гр╣М": "ЁЯжа",
  "р╕Бр╕▓р╕гр╕Ър╕гр╕┤р╕лр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г": "ЁЯСФ",
  "р╕Бр╕▓р╕гр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Хр╕▓р╕бр╕Бр╕Ор╕лр╕бр╕▓р╕в": "ЁЯУЬ",
  "р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ": "ЁЯМР",
  "Cloud/р╕Др╕ер╕▓р╕зр╕Фр╣М": "тШБя╕П"
};
let responses = [];
let current = 0;

// ---------------------------
// р╣Бр╕кр╕Фр╕З UI р╕лр╕ер╕▒р╕Бр╣Ар╕бр╕╖р╣Ир╕нр╣Вр╕лр╕ер╕Фр╕лр╕Щр╣Йр╕▓
// ---------------------------
document.addEventListener('DOMContentLoaded', function() {
  // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ responses р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
  if (sessionStorage.getItem('cyberResponses')) {
    responses = JSON.parse(sessionStorage.getItem('cyberResponses'));
    renderResultsView();
  } else {
    renderQuestionView();
  }
});

// ---------------------------
// р╣Бр╕кр╕Фр╕Зр╕лр╕Щр╣Йр╕▓р╕Др╕│р╕Цр╕▓р╕б
// ---------------------------
function renderQuestionView() {
  document.getElementById('app').innerHTML = `
    <div class="progress-container">
      <div class="progress-bar" style="width: 0%"></div>
    </div>
    <div id="questionContainer" class="fade-in"></div>
    <div class="btn-container">
      <button id="prevBtn" class="btn-secondary" onclick="prevQuestion()">р╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ</button>
      <button id="nextBtn" class="btn-main" onclick="nextQuestion()">р╕Хр╣Ир╕нр╣Др╕Ы</button>
    </div>
  `;
  showQuestion(current);
}

// ---------------------------
// р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
// ---------------------------
function renderResultsView() {
  document.getElementById('app').innerHTML = `
    <div id="resultsContainer" class="fade-in">
      <h2 class="text-center text-2xl font-bold mb-8">р╕Ьр╕ер╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Фр╣Йр╕▓р╕Щр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣М</h2>
      <div id="mainBoxes" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
    </div>
    <div id="mainModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
      <div class="bg-white max-w-4xl mx-auto my-10 p-8 rounded-xl shadow-xl">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold" id="modalTitle">р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф</h3>
          <button onclick="hideModal()" class="text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div id="modalBody" class="overflow-y-auto max-h-[70vh]"></div>
      </div>
    </div>
  `;
  renderMainBoxes();
  
  // р╣Ар╕Юр╕┤р╣Ир╕бр╕Ыр╕╕р╣Ир╕б "р╣Ар╕гр╕┤р╣Ир╕бр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Гр╕лр╕бр╣И"
  document.getElementById('resultsContainer').insertAdjacentHTML('beforeend', `
    <div class="text-center mt-10">
      <button onclick="resetAssessment()" class="btn-secondary">р╣Ар╕гр╕┤р╣Ир╕бр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Гр╕лр╕бр╣И</button>
    </div>
  `);
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Бр╕кр╕Фр╕Зр╕Бр╕ер╣Ир╕нр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Хр╣Ир╕ер╕░р╕кр╣Ир╕зр╕Щ
// ---------------------------
function renderMainBoxes() {
  const boxes = [
    { id: "box-summary", icon: "ЁЯУК", title: "р╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ", desc: "р╕Фр╕╣р╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Др╕░р╣Бр╕Щр╕Щ р╕Ир╕╕р╕Фр╣Бр╕Вр╣Зр╕З р╣Бр╕ер╕░р╕Ир╕╕р╕Фр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З", func: "showSummaryBox" },
    { id: "box-high-risk", icon: "тЪая╕П", title: "р╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З", desc: "р╕Фр╕╣р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕Зр╣Бр╕ер╕░р╣Бр╕Щр╕зр╕Чр╕▓р╕Зр╣Бр╕Бр╣Йр╣Др╕В", func: "showHighRiskBox" },
    { id: "box-risk", icon: "ЁЯУИ", title: "Risk Assessment", desc: "р╕Фр╕╣р╕Ьр╕ер╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Вр╕Фр╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф", func: "showRiskBox" },
    { id: "box-irp", icon: "ЁЯЪи", title: "Incident Response Plan", desc: "р╕Фр╕╣р╣Бр╕Ьр╕Щр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣М", func: "showIRPBox" }
  ];
  
  let html = `<div class="grid grid-cols-1 md:grid-cols-2 gap-6">`;
  boxes.forEach(box => {
    html += `
      <div id="${box.id}" onclick="${box.func}()" class="bg-white rounded-xl shadow-lg p-6 cursor-pointer transform hover:scale-105 transition-all" style="border-left:6px solid #0ea5e9;">
        <div class="flex items-center mb-4">
          <span class="text-3xl mr-3">${box.icon}</span>
          <h3 class="text-xl font-bold text-blue-800">${box.title}</h3>
        </div>
        <p class="text-slate-700 mb-4">${box.desc}</p>
        <div class="text-right">
          <button class="inline-flex items-center text-blue-600 hover:text-blue-800">
            р╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф
            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>
      </div>
    `;
  });
  html += `</div>`;
  document.getElementById('mainBoxes').innerHTML = html;
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕Хр╣Ир╕ер╕░р╕Бр╕ер╣Ир╕нр╕З
// ---------------------------
function showSummaryBox() {
  document.getElementById('modalTitle').textContent = "р╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ";
  document.getElementById('modalBody').innerHTML = `<div id="summaryResultBox" class="p-4"></div>`;
  renderSummaryOnly(responses, QUESTIONS);
  showModal();
}

function showHighRiskBox() {
  document.getElementById('modalTitle').textContent = "р╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З";
  document.getElementById('modalBody').innerHTML = `<div id="highRiskResultBox" class="p-4"></div>`;
  renderHighRiskOnly(responses, QUESTIONS);
  showModal();
}

function showRiskBox() {
  document.getElementById('modalTitle').textContent = "р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З (Risk Assessment)";
  document.getElementById('modalBody').innerHTML = `<div id="riskResultBox" class="p-4"></div>`;
  renderRiskOnly(responses, QUESTIONS);
  showModal();
}

function showIRPBox() {
  document.getElementById('modalTitle').textContent = "р╣Бр╕Ьр╕Щр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М (Incident Response Plan)";
  document.getElementById('modalBody').innerHTML = `<div id="irpResultBox" class="p-4"></div>`;
  renderIRPOnly(responses, QUESTIONS);
  showModal();
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ render р╣Ар╕Йр╕Юр╕▓р╕░р╣Бр╕Хр╣Ир╕ер╕░р╕кр╣Ир╕зр╕Щ
// ---------------------------
function renderSummaryOnly(responses, QUESTIONS) {
  let total = 0;
  let high = [], medium = [], low = [];
  let sectionScores = {};
  
  // р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕Др╕│р╕Цр╕▓р╕бр╕Хр╕▓р╕бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И
  const sectionMap = {};
  QUESTIONS.forEach((q, i) => {
    if (!sectionMap[q.section]) sectionMap[q.section] = [];
    sectionMap[q.section].push(i);
  });

  for(let i=0; i<QUESTIONS.length; i++) {
    const ans = responses[i]?.choice;
    const score = SCORE_MAP[ans] || 0;
    const section = QUESTIONS[i].section;
    
    if(!sectionScores[section]) {
      sectionScores[section] = {total: 0, max: 0};
    }
    
    sectionScores[section].max += 2; // р╕Др╕░р╣Бр╕Щр╕Щр╣Ар╕Хр╣Зр╕бр╕Др╕╖р╕н 2 р╕Хр╣Ир╕нр╕Вр╣Йр╕н
    if(score > 0) {
      total += score;
      sectionScores[section].total += score;
      if(score === 2) high.push(i);
      else if(score === 1) medium.push(i);
    }
  }
  
  // р╕Др╕│р╕Щр╕зр╕Ур╕Др╕░р╣Бр╕Щр╕Щр╕гр╕зр╕б
  const maxScore = QUESTIONS.length * 2;
  const percentage = Math.round((total / maxScore) * 100);
  const riskLevel = 
    percentage >= 75 ? {text: "р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З", color: "#dc2626"} :
    percentage >= 40 ? {text: "р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З", color: "#d97706"} : 
                      {text: "р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕│", color: "#16a34a"};
  
  // р╕Ир╕▒р╕Фр╣Ар╕гр╕╡р╕вр╕Зр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕Хр╕▓р╕бр╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З (р╕бр╕▓р╕Бр╣Др╕Ыр╕Щр╣Йр╕нр╕в)
  const sortedSections = Object.keys(sectionScores).sort((a, b) => {
    const scoreA = sectionScores[a].total / sectionScores[a].max;
    const scoreB = sectionScores[b].total / sectionScores[b].max;
    return scoreB - scoreA;
  });
  
  let html = `
    <div class="mb-8">
      <div class="flex items-center justify-between mb-4">
        <div>
          <h3 class="text-xl font-bold">р╕Др╕░р╣Бр╕Щр╕Щр╕гр╕зр╕б</h3>
          <p class="text-slate-600">р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ ${responses.filter(r => r?.choice).length} р╕Ир╕▓р╕Бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф ${QUESTIONS.length} р╕Вр╣Йр╕н</p>
        </div>
        <div class="text-right">
          <div class="text-3xl font-bold" style="color: ${riskLevel.color}">${percentage}%</div>
          <div class="font-bold" style="color: ${riskLevel.color}">${riskLevel.text}</div>
        </div>
      </div>
      
      <div class="w-full bg-gray-200 rounded-full h-4 mt-2">
        <div class="h-4 rounded-full" style="width: ${percentage}%; background-color: ${riskLevel.color}"></div>
      </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
      <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-md">
        <h4 class="font-bold text-red-700 mb-2">р╕Юр╕Ър╕Ир╕╕р╕Фр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З ${high.length} р╕Ир╕╕р╕Ф</h4>
        ${high.length > 0 ? 
          `<ul class="list-disc pl-5 text-red-700">
            ${high.slice(0, 5).map(i => `<li>${QUESTIONS[i].text}</li>`).join('')}
            ${high.length > 5 ? `<li>р╣Бр╕ер╕░р╕нр╕╡р╕Б ${high.length - 5} р╕гр╕▓р╕вр╕Бр╕▓р╕г...</li>` : ''}
          </ul>` : 
          '<p class="text-slate-600">р╣Др╕бр╣Ир╕Юр╕Ър╕Ир╕╕р╕Фр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</p>'
        }
      </div>
      <div class="bg-amber-50 border-l-4 border-amber-500 p-4 rounded-md">
        <h4 class="font-bold text-amber-700 mb-2">р╕Юр╕Ър╕Ир╕╕р╕Фр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З ${medium.length} р╕Ир╕╕р╕Ф</h4>
        ${medium.length > 0 ? 
          `<ul class="list-disc pl-5 text-amber-700">
            ${medium.slice(0, 5).map(i => `<li>${QUESTIONS[i].text}</li>`).join('')}
            ${medium.length > 5 ? `<li>р╣Бр╕ер╕░р╕нр╕╡р╕Б ${medium.length - 5} р╕гр╕▓р╕вр╕Бр╕▓р╕г...</li>` : ''}
          </ul>` : 
          '<p class="text-slate-600">р╣Др╕бр╣Ир╕Юр╕Ър╕Ир╕╕р╕Фр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З</p>'
        }
      </div>
    </div>
    
    <h3 class="text-xl font-bold mb-4">р╕Ьр╕ер╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Бр╕вр╕Бр╕Хр╕▓р╕бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И</h3>
    <div class="grid grid-cols-1 gap-4">
      ${sortedSections.map(section => {
        const sectionScore = sectionScores[section];
        const sectionPercentage = Math.round((sectionScore.total / sectionScore.max) * 100);
        let barColor;
        if (sectionPercentage >= 75) barColor = "#dc2626";
        else if (sectionPercentage >= 40) barColor = "#d97706";
        else barColor = "#16a34a";
        
        return `
          <div class="bg-white p-4 rounded-md shadow-sm">
            <div class="flex items-center justify-between mb-2">
              <div class="flex items-center">
                <span class="text-xl mr-2">${SECTION_ICONS[section] || 'ЁЯУЛ'}</span>
                <h4 class="font-bold">${section}</h4>
              </div>
              <div class="text-right">
                <span class="font-bold" style="color: ${barColor}">${sectionPercentage}%</span>
              </div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="h-2 rounded-full" style="width: ${sectionPercentage}%; background-color: ${barColor}"></div>
            </div>
          </div>
        `;
      }).join('')}
    </div>
  `;
  
  document.getElementById('summaryResultBox').innerHTML = html;
}

function renderHighRiskOnly(responses, QUESTIONS) {
  let highRiskIndexes = [];
  for(let i=0; i<QUESTIONS.length; i++) {
    const ans = responses[i]?.choice;
    const score = SCORE_MAP[ans] || 0;
    if(score === 2) highRiskIndexes.push(i);
  }
  
  if(highRiskIndexes.length === 0) {
    document.getElementById('highRiskResultBox').innerHTML = `
      <div class="bg-green-50 p-6 rounded-lg text-center">
        <div class="text-5xl mb-4">ЁЯОЙ</div>
        <h3 class="text-xl font-bold text-green-700 mb-2">р╣Др╕бр╣Ир╕Юр╕Ър╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</h3>
        <p class="text-slate-600">р╕Чр╕╕р╕Бр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Гр╕Щр╕гр╕░р╕Фр╕▒р╕Ър╕Чр╕╡р╣Ир╕вр╕нр╕бр╕гр╕▒р╕Ър╣Др╕Фр╣Й</p>
      </div>
    `;
    return;
  }
  
  let html = `
    <div class="mb-6">
      <div class="flex items-center justify-between">
        <h3 class="text-xl font-bold text-red-700">р╕Юр╕Ър╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З ${highRiskIndexes.length} р╕гр╕▓р╕вр╕Бр╕▓р╕г</h3>
        <button onclick="printHighRiskReport()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2z"></path>
          </svg>
          р╕Юр╕┤р╕бр╕Юр╣Мр╕гр╕▓р╕вр╕Зр╕▓р╕Щ
        </button>
      </div>
      <p class="text-slate-600 mb-4">р╕Бр╕гр╕╕р╕Ур╕▓р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Хр╣Ир╕нр╣Др╕Ыр╕Щр╕╡р╣Йр╣Вр╕Фр╕вр╕Фр╣Ир╕зр╕Щ</p>
    </div>
    
    <div class="space-y-6">
      ${highRiskIndexes.map((i, idx) => {
        const q = QUESTIONS[i];
        const ans = responses[i]?.choice;
        
        return `
          <div class="bg-white border-l-4 border-red-500 rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-lg font-bold text-red-700">р╕Вр╣Йр╕нр╕Чр╕╡р╣И ${i+1}: ${q.text}</h4>
              <span class="bg-red-100 text-red-800 text-sm font-bold px-3 py-1 rounded-full">р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</span>
            </div>
            
            <div class="space-y-3 mb-4">
              <div><b>р╕Др╕│р╕Хр╕нр╕Ъ:</b> <span class="text-blue-600">${LABEL_MAP[ans]||"-"}</span></div>
              <div><b>тЪая╕П р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> <span class="text-red-600">${q.risk}</span></div>
              <div><b>ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│:</b> <span class="text-blue-600">${q.fix}</span></div>
            </div>
            
            <div class="bg-slate-50 p-4 rounded-md">
              <div class="font-bold mb-2 text-slate-700">ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В:</div>
              <ol class="list-decimal pl-5 space-y-1 text-slate-700">
                ${q.steps.map(step=>`<li>${step}</li>`).join("")}
              </ol>
            </div>
            
            ${responses[i]?.comment ? `
              <div class="mt-4 bg-amber-50 p-3 rounded-md">
                <div class="font-bold text-amber-800">р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:</div>
                <div class="text-amber-700">${responses[i].comment}</div>
              </div>
            ` : ""}
          </div>
        `;
      }).join('')}
    </div>
  `;
  
  document.getElementById('highRiskResultBox').innerHTML = html;
}

function renderRiskOnly(responses, QUESTIONS) {
  const risk = getRiskData(responses, QUESTIONS);
  
  let html = `
    <div class="mb-6">
      <h3 class="text-xl font-bold mb-2">Risk Scenario Analysis</h3>
      <p class="text-slate-600 mb-4">р╕Бр╕▓р╕гр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Фр╣Йр╕▓р╕Щр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣М</p>
      
      <div class="overflow-x-auto">
        <table class="min-w-full bg-white border border-gray-200">
          <thead>
            <tr class="bg-gray-100 text-gray-700">
              <th class="py-3 px-4 border-b text-left">Asset</th>
              <th class="py-3 px-4 border-b text-left">Threat</th>
              <th class="py-3 px-4 border-b text-left">Vulnerability</th>
              <th class="py-3 px-4 border-b text-left">Impact</th>
              <th class="py-3 px-4 border-b text-left">Risk Level</th>
            </tr>
          </thead>
          <tbody>
            ${risk.matrixRows.map(r=>`
              <tr class="border-b hover:bg-gray-50">
                <td class="py-3 px-4">${r.asset}</td>
                <td class="py-3 px-4">${r.threat}</td>
                <td class="py-3 px-4">${r.vuln}</td>
                <td class="py-3 px-4">${r.impact}</td>
                <td class="py-3 px-4">
                  <span class="px-2 py-1 rounded-full text-xs font-bold
                    ${r.riskLevel === 'High' ? 'bg-red-100 text-red-700' : 
                    r.riskLevel === 'Medium' ? 'bg-amber-100 text-amber-700' : 
                    'bg-green-100 text-green-700'}">
                    ${r.riskLevel}
                  </span>
                </td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="mb-6">
      <h3 class="text-xl font-bold mb-4">Risk Heatmap</h3>
      
      <div class="grid grid-cols-4 gap-px bg-gray-200 border border-gray-300">
        <div class="bg-white p-3 text-center font-bold">Impact тЖУ / Likelihood тЖТ</div>
        <div class="bg-white p-3 text-center">Low (1)</div>
        <div class="bg-white p-3 text-center">Medium (2)</div>
        <div class="bg-white p-3 text-center">High (3)</div>
        
        ${[3, 2, 1].map(impact => `
          <div class="bg-white p-3 text-center font-bold">${impact === 3 ? 'High' : impact === 2 ? 'Medium' : 'Low'} (${impact})</div>
          ${[1, 2, 3].map(likelihood => {
            const cell = risk.heatmap[impact-1][likelihood-1];
            const count = cell.length;
            let cellClass = "bg-white";
            let textClass = "text-gray-500";
            
            if (count > 0) {
              if (impact * likelihood >= 7) { 
                cellClass = "bg-red-100"; 
                textClass = "text-red-800";
              } else if (impact * likelihood >= 4) { 
                cellClass = "bg-amber-100"; 
                textClass = "text-amber-800";
              } else { 
                cellClass = "bg-green-100"; 
                textClass = "text-green-800";
              }
            }
            
            return `
              <div class="${cellClass} p-3 text-center relative group cursor-pointer">
                <span class="${textClass} font-bold">${count || '-'}</span>
                ${ count > 0 ? `
                  <div class="hidden group-hover:block absolute z-10 w-64 p-3 bg-white border shadow-lg rounded-md -left-1/3 top-full">
                    <div class="font-bold mb-1">Impact: ${impact}, Likelihood: ${likelihood}</div>
                    <div class="text-sm mb-2">
                      Risk Level: <span class="${
                        impact * likelihood >= 7 ? "text-red-700 font-bold" : 
                        impact * likelihood >= 4 ? "text-amber-700 font-bold" : 
                        "text-green-700 font-bold"
                      }">${impact * likelihood >= 7 ? "High" : impact * likelihood >= 4 ? "Medium" : "Low"}</span>
                    </div>
                    <ul class="list-disc pl-4 text-sm">
                      ${risk.matrixRows.filter(r => r.impact === impact && r.likelihood === likelihood)
                        .map(r => `<li class="truncate" title="${r.asset}">${r.asset}</li>`)
                        .join("")}
                    </ul>
                  </div>
                ` : ''}
              </div>
            `;
          }).join("")}
        `).join("")}
      </div>
      
      <div class="flex items-center gap-4 mt-4 justify-center text-sm">
        <div class="flex items-center">
          <div class="w-4 h-4 rounded bg-red-100 border border-red-300 mr-1"></div>
          <span>High Risk</span>
        </div>
        <div class="flex items-center">
          <div class="w-4 h-4 rounded bg-amber-100 border border-amber-300 mr-1"></div>
          <span>Medium Risk</span>
        </div>
        <div class="flex items-center">
          <div class="w-4 h-4 rounded bg-green-100 border border-green-300 mr-1"></div>
          <span>Low Risk</span>
        </div>
      </div>
    </div>
    
    <div>
      <h3 class="text-xl font-bold mb-4">Risk Response Strategy</h3>
      
      <div class="overflow-x-auto">
        <table class="min-w-full bg-white border border-gray-200">
          <thead>
            <tr class="bg-gray-100 text-gray-700">
              <th class="py-3 px-4 border-b text-left">Asset</th>
              <th class="py-3 px-4 border-b text-left">Risk Level</th>
              <th class="py-3 px-4 border-b text-left">Response Strategy</th>
            </tr>
          </thead>
          <tbody>
            ${risk.responseRows.map(r=>`
              <tr class="border-b hover:bg-gray-50">
                <td class="py-3 px-4">${r.asset}</td>
                <td class="py-3 px-4">
                  <span class="px-2 py-1 rounded-full text-xs font-bold
                    ${r.riskLevel === 'High' ? 'bg-red-100 text-red-700' : 
                    r.riskLevel === 'Medium' ? 'bg-amber-100 text-amber-700' : 
                    'bg-green-100 text-green-700'}">
                    ${r.riskLevel}
                  </span>
                </td>
                <td class="py-3 px-4">${r.response}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </div>
    </div>
  `;
  
  document.getElementById('riskResultBox').innerHTML = html;
}

function renderIRPOnly(responses, QUESTIONS) {
  const irp = getIRPData(responses, QUESTIONS);
  
  let html = `
    <div class="bg-blue-50 p-6 rounded-lg mb-6">
      <h3 class="text-xl font-bold text-blue-800 mb-2">Incident Classification</h3>
      <p class="text-slate-600 mb-2">р╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Юр╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Гр╕Щр╣Ар╕гр╕╖р╣Ир╕нр╕З:</p>
      <div class="flex flex-wrap gap-2 mt-2">
        ${irp.types.map(type => `
          <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
            ${type}
          </span>
        `).join('')}
      </div>
    </div>
    
    <div class="mb-6">
      <h3 class="text-xl font-bold mb-4">CIRT Team Roles</h3>
      <p class="text-slate-600 mb-4">Computer Incident Response Team р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Юр╕гр╣Йр╕нр╕б</p>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        ${irp.cirtRoles.map(r=>`
          <div class="bg-white shadow rounded-lg p-4">
            <h4 class="font-bold text-lg text-blue-800">${r.role}</h4>
            <p class="text-slate-700 mb-2">${r.name}</p>
            <p class="text-slate-600 text-sm">${r.resp}</p>
          </div>
        `).join("")}
      </div>
    </div>
    
    <div>
      <h3 class="text-xl font-bold mb-4">Incident Response Phases</h3>
      
      <div class="relative">
        ${irp.phases.map((p, i)=>`
          <div class="mb-8 relative">
            ${i < irp.phases.length - 1 ? `
              <div class="absolute h-full w-1 bg-blue-200 left-4 top-4 z-0"></div>
            ` : ''}
            <div class="flex">
              <div class="bg-blue-500 rounded-full w-8 h-8 flex items-center justify-center text-white font-bold z-10">
                ${i + 1}
              </div>
              <div class="ml-4 flex-1">
                <h4 class="text-lg font-bold text-blue-800 mb-2">${p.phase}</h4>
                <div class="bg-white shadow rounded-lg overflow-hidden">
                  <table class="min-w-full">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="py-2 px-4 border-b text-left">Key Action</th>
                        <th class="py-2 px-4 border-b text-left">Responsible</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${p.actions.map(a=>`
                        <tr class="border-b hover:bg-gray-50">
                          <td class="py-3 px-4">${a.task}</td>
                          <td class="py-3 px-4">${a.who}</td>
                        </tr>
                      `).join("")}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        `).join("")}
      </div>
    </div>
  `;
  
  document.getElementById('irpResultBox').innerHTML = html;
}

// ---------------------------
// р╕Юр╕┤р╕бр╕Юр╣Мр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З
// ---------------------------
function printHighRiskReport() {
  let highRiskIndexes = [];
  for(let i=0; i<QUESTIONS.length; i++) {
    const ans = responses[i]?.choice;
    const score = SCORE_MAP[ans] || 0;
    if(score === 2) highRiskIndexes.push(i);
  }
  
  if(highRiskIndexes.length === 0) {
    alert("р╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З");
    return;
  }
  
  let html = `<html><head>
    <title>р╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З - Cyber Risk Assessment</title>
    <style>
      body { font-family: 'Prompt', 'Sarabun', Arial, sans-serif; margin: 0; padding: 20px; color: #333; }
      .header { text-align: center; margin-bottom: 30px; }
      .risk-card { background: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px; border-left: 6px solid #dc2626; }
      .risk-title { font-size: 18px; font-weight: bold; color: #dc2626; margin-bottom: 10px; }
      .risk-detail { margin-bottom: 8px; }
      .risk-step { margin-left: 20px; color: #555; }
      .steps-container { background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 10px 0; }
      .page-break { page-break-after: always; }
      @media print {
        body { font-size: 12pt; }
        .no-print { display: none; }
      }
    </style>
    </head>
    <body>
      <div class="header">
        <h1 style="color:#dc2626;margin-bottom:5px;">р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</h1>
        <p>Cyber Risk Assessment Report</p>
        <p style="color:#666;">р╕зр╕▒р╕Щр╕Чр╕╡р╣И: ${new Date().toLocaleDateString('th-TH', {year: 'numeric', month: 'long', day: 'numeric'})}</p>
      </div>
      
      <p style="margin-bottom:20px;">р╕Юр╕Ър╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З <b>${highRiskIndexes.length}</b> р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╣Вр╕Фр╕вр╕Фр╣Ир╕зр╕Щ</p>`;

  highRiskIndexes.forEach((i, idx) => {
    const q = QUESTIONS[i];
    const ans = responses[i]?.choice;
    
    // р╣Ар╕Юр╕┤р╣Ир╕б page break р╕Чр╕╕р╕Б 2 р╕гр╕▓р╕вр╕Бр╕▓р╕г
    if (idx > 0 && idx % 2 === 0) {
      html += '<div class="page-break"></div>';
    }
    
    html += `
      <div class="risk-card">
        <div class="risk-title">р╕Вр╣Йр╕нр╕Чр╕╡р╣И ${i+1}: ${q.text}</div>
        <div class="risk-detail"><b>р╕лр╕бр╕зр╕Ф:</b> ${q.section}</div>
        <div class="risk-detail"><b>р╕Др╕│р╕Хр╕нр╕Ъ:</b> <span style="color:#0ea5e9;">${LABEL_MAP[ans]||"-"}</span></div>
        <div class="risk-detail"><b>р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> <span style="color:#dc2626;font-weight:bold;">р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</span></div>
        <div class="risk-detail"><b>тЪая╕П р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> ${q.risk}</div>
        <div class="risk-detail"><b>ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│:</b> ${q.fix}</div>
        <div class="steps-container">
          <div class="risk-detail"><b>ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В:</b></div>
          <ol class="risk-step">
            ${q.steps.map(step=>`<li>${step}</li>`).join("")}
          </ol>
        </div>
        ${responses[i]?.comment ? `<div class="risk-detail" style="margin-top:10px;"><b>р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:</b> ${responses[i].comment}</div>` : ""}
      </div>
    `;
  });

  html += `
      <div class="no-print" style="text-align:center;margin-top:30px;">
        <button onclick="window.print()" style="background:#0ea5e9;color:#fff;font-weight:bold;padding:10px 20px;border-radius:5px;border:none;cursor:pointer;">р╕Юр╕┤р╕бр╕Юр╣Мр╕гр╕▓р╕вр╕Зр╕▓р╕Щ</button>
      </div>
    </body></html>`;

  let win = window.open("", "_blank");
  win.document.write(html);
  win.document.close();
}

// ---------------------------
// Modal р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕кр╕Фр╕Зр╕Ьр╕е
// ---------------------------
function showModal() {
  document.getElementById('mainModal').classList.remove('hidden');
  document.getElementById('mainModal').classList.add('flex');
}
function hideModal() {
  document.getElementById('mainModal').classList.add('hidden');
  document.getElementById('mainModal').classList.remove('flex');
}

// ---------------------------
// р╣Ар╕гр╕┤р╣Ир╕бр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Гр╕лр╕бр╣И
// ---------------------------
function resetAssessment() {
  if(confirm('р╕Др╕╕р╕Ур╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Гр╕лр╕бр╣Ир╣Гр╕Кр╣Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И? р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Фр╕┤р╕бр╕Ир╕░р╕Цр╕╣р╕Бр╕ер╕Ъ')) {
    sessionStorage.removeItem('cyberResponses');
    responses = [];
    current = 0;
    renderQuestionView();
  }
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Др╕│р╕Щр╕зр╕Ур╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З (р╣Бр╕Ър╕Ър╣Ар╕Хр╣Зр╕б)
// ---------------------------
function getRiskData(responses, QUESTIONS) {
  let riskRows = [];
  let matrixRows = [];
  let responseRows = [];
  let heatmap = [[[],[],[]],[[],[],[]],[[],[],[]]]; // [impact-1][likelihood-1]
  
  for(let i=0;i<QUESTIONS.length;i++) {
    const ans = responses[i]?.choice;
    if(!ans) continue;
    
    const asset = QUESTIONS[i].text;
    const threat = QUESTIONS[i].risk;
    const vuln = QUESTIONS[i].fix;
    const consequence = QUESTIONS[i].risk;
    const likelihood = ans==="yes"?1 : ans==="partial"?2 : 3;
    let impact = /р╕Вр╣Йр╕нр╕бр╕╣р╕е|р╕гр╕░р╕Ър╕Ъ|р╕кр╕╣р╕Нр╕лр╕▓р╕в|р╣Вр╕Ир╕бр╕Хр╕╡|р╕гр╕▒р╣Ир╕зр╣Др╕лр╕е|р╕Яр╕╖р╣Йр╕Щр╕Яр╕╣/.test(threat)?3:2;
    let riskScore = likelihood * impact;
    let riskLevel = riskScore>=7?"High":riskScore>=4?"Medium":"Low";
    let response = riskLevel==="High"?"Mitigate / Avoid":riskLevel==="Medium"?"Mitigate / Transfer":"Accept / Monitor";
    
    riskRows.push({asset, threat, vuln, consequence});
    matrixRows.push({asset, likelihood, impact, riskLevel});
    responseRows.push({asset, riskLevel, response});
    heatmap[impact-1][likelihood-1].push(riskLevel);
  }
  
  // р╣Ар╕гр╕╡р╕вр╕Зр╕ер╕│р╕Фр╕▒р╕Ър╕Хр╕▓р╕бр╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З
  const riskOrder = { "High": 1, "Medium": 2, "Low": 3 };
  matrixRows.sort((a, b) => riskOrder[a.riskLevel] - riskOrder[b.riskLevel]);
  responseRows.sort((a, b) => riskOrder[a.riskLevel] - riskOrder[b.riskLevel]);
  
  return {riskRows, matrixRows, responseRows, heatmap};
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Др╕│р╕Щр╕зр╕У IRP (р╣Бр╕Ър╕Ър╣Ар╕Хр╣Зр╕б)
// ---------------------------
function getIRPData(responses, QUESTIONS) {
  let types = [];
  if(responses[3]?.choice==="no") types.push("Account Compromise");
  if(responses[7]?.choice==="no") types.push("Vulnerability Exploitation");
  if(responses[11]?.choice==="no") types.push("Data Loss / Ransomware");
  if(responses[14]?.choice==="no"||responses[15]?.choice==="no") types.push("Malware Outbreak");
  if(responses[16]?.choice==="no"||responses[17]?.choice==="no") types.push("Incident Response Weakness");
  if(responses[18]?.choice==="no"||responses[22]?.choice==="no") types.push("Network Intrusion");
  if(responses[23]?.choice==="no"||responses[24]?.choice==="no") types.push("Cloud Security Issue");
  if(types.length===0) types.push("General Security Weakness");

  const cirtRoles = [
    {name:"р╕Щр╕▓р╕вр╕кр╕бр╕Кр╕▓р╕в", role:"CIRT Lead", resp:"р╕Др╕зр╕Ър╕Др╕╕р╕бр╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╣Бр╕ер╕░р╕Хр╕▒р╕Фр╕кр╕┤р╕Щр╣Гр╕Ир╕лр╕ер╕▒р╕Б"},
    {name:"р╕Щр╕▓р╕Зр╕кр╕▓р╕зр╕Юр╕гр╕Чр╕┤р╕Юр╕вр╣М", role:"Technical Lead", resp:"р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕Чр╕Др╕Щр╕┤р╕Др╣Бр╕ер╕░р╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓"},
    {name:"р╕Щр╕▓р╕вр╕зр╕┤р╕Чр╕вр╕▓", role:"Compliance Officer", resp:"р╕Фр╕╣р╣Бр╕ер╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Ф р╕Бр╕Ор╕лр╕бр╕▓р╕в р╣Бр╕ер╕░р╕Бр╕▓р╕гр╕гр╕▓р╕вр╕Зр╕▓р╕Щ"},
    {name:"р╕Др╕╕р╕Ур╕нр╕гр╕Чр╕▒р╕в", role:"IT Support", resp:"р╕кр╕Щр╕▒р╕Ър╕кр╕Щр╕╕р╕Щр╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ър╣Бр╕ер╕░р╕Ыр╕гр╕░р╕кр╕▓р╕Щр╕Зр╕▓р╕Щ"},
  ];

  const phases = [
    {
      phase:"Preparation",
      actions:[
        {task:"р╕Ир╕▒р╕Фр╕Чр╕│р╕Щр╣Вр╕вр╕Ър╕▓р╕вр╣Бр╕ер╕░р╣Бр╕Ьр╕Щ IRP", who:"CIRT Lead"},
        {task:"р╕нр╕Ър╕гр╕бр╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╣Бр╕ер╕░р╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕н", who:"Compliance Officer"},
        {task:"р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ьр╕Щр╣Бр╕ер╕░р╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н", who:"CIRT Lead, IT Support"}
      ]
    },
    {
      phase:"Detection & Analysis",
      actions:[
        {task:"р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤р╕Ир╕▓р╕Б Log/SIEM", who:"Technical Lead"},
        {task:"р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╣Бр╕ер╕░р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ", who:"Technical Lead, CIRT Lead"},
        {task:"р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Чр╕╡р╕бр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З", who:"CIRT Lead"}
      ]
    },
    {
      phase:"Containment & Recovery",
      actions:[
        {task:"р╕Ир╕│р╕Бр╕▒р╕Фр╕Вр╕нр╕Ър╣Ар╕Вр╕Хр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М", who:"Technical Lead"},
        {task:"р╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ъ/р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╕кр╕│р╕гр╕нр╕З", who:"IT Support"},
        {task:"р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ", who:"Technical Lead, IT Support"}
      ]
    },
    {
      phase:"Post-Incident Activities",
      actions:[
        {task:"р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╣Бр╕ер╕░р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Бр╕Ьр╕Щ", who:"CIRT Lead, Compliance Officer"},
        {task:"р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Хр╣Ир╕нр╕Ьр╕╣р╣Йр╕Ър╕гр╕┤р╕лр╕▓р╕г/р╕лр╕Щр╣Ир╕зр╕вр╕Зр╕▓р╕Щр╕Бр╕│р╕Бр╕▒р╕Ъ", who:"Compliance Officer"},
        {task:"р╕нр╕Ър╕гр╕бр╣Бр╕ер╕░р╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╕Бр╕▒р╕Ър╕Ър╕╕р╕Др╕ер╕▓р╕Бр╕г", who:"CIRT Lead"}
      ]
    }
  ];
  
  return {types, cirtRoles, phases};
}

// ----------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Бр╕кр╕Фр╕Зр╕Др╕│р╕Цр╕▓р╕б (р╕кр╣Ир╕зр╕Щ Quiz)
// ----------------------------
function showQuestion(index) {
  if (index < 0) index = 0;
  if (index >= QUESTIONS.length) {
    finishQuiz();
    return;
  }
  
  current = index;
  const q = QUESTIONS[index];
  const resp = responses[index] || {};
  
  document.querySelector(".progress-bar").style.width = `${((index + 1) / QUESTIONS.length) * 100}%`;
  
  let html = `
    <div class="question-section">
      <div class="question-header">
        <div class="section-tag">${SECTION_ICONS[q.section] || 'ЁЯУЛ'} ${q.section}</div>
        <div class="question-num">р╕Вр╣Йр╕нр╕Чр╕╡р╣И ${index + 1} р╕Ир╕▓р╕Б ${QUESTIONS.length}</div>
      </div>
      <div class="question-text">${q.text}</div>
      <div class="choices">
        <label class="choice-item ${resp.choice === 'yes' ? 'selected' : ''}">
          <input type="radio" name="q${index}" value="yes" ${resp.choice === 'yes' ? 'checked' : ''}>
          <span class="choice-text">р╣Гр╕Кр╣И</span>
          <span class="choice-desc">р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╣Бр╕ер╣Йр╕з</span>
        </label>
        <label class="choice-item ${resp.choice === 'partial' ? 'selected' : ''}">
          <input type="radio" name="q${index}" value="partial" ${resp.choice === 'partial' ? 'checked' : ''}>
          <span class="choice-text">р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И</span>
          <span class="choice-desc">р╕нр╕вр╕╣р╣Ир╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕г</span>
        </label>
        <label class="choice-item ${resp.choice === 'no' ? 'selected' : ''}">
          <input type="radio" name="q${index}" value="no" ${resp.choice === 'no' ? 'checked' : ''}>
          <span class="choice-text">р╣Др╕бр╣Ир╣Гр╕Кр╣И</span>
          <span class="choice-desc">р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕г</span>
        </label>
      </div>
      <div class="comment-field">
        <label>р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ (р╕Цр╣Йр╕▓р╕бр╕╡):</label>
        <textarea id="comment">${resp.comment || ''}</textarea>
      </div>
    </div>
  `;
  
  document.getElementById("questionContainer").innerHTML = html;
  document.getElementById("prevBtn").style.visibility = index === 0 ? "hidden" : "visible";
  document.getElementById("nextBtn").textContent = index === QUESTIONS.length - 1 ? "р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ" : "р╕Цр╕▒р╕Фр╣Др╕Ы";
  
  // р╣Ар╕Юр╕┤р╣Ир╕б Event listener р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕ер╕╖р╕нр╕Бр╕Др╕│р╕Хр╕нр╕Ъ
  document.querySelectorAll('.choice-item').forEach(item => {
    item.addEventListener('click', function() {
      document.querySelectorAll('.choice-item').forEach(el => el.classList.remove('selected'));
      this.classList.add('selected');
    });
  });
}

function prevQuestion() {
  saveCurrentResponse();
  showQuestion(current - 1);
}

function nextQuestion() {
  if (!saveCurrentResponse()) {
    alert("р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕Др╕│р╕Хр╕нр╕Ъ");
    return;
  }
  showQuestion(current + 1);
}

function saveCurrentResponse() {
  const selected = document.querySelector(`input[name="q${current}"]:checked`);
  if (!selected) return false;
  
  const comment = document.getElementById("comment").value;
  responses[current] = { choice: selected.value, comment };
  sessionStorage.setItem('cyberResponses', JSON.stringify(responses));
  return true;
}

function finishQuiz() {
  sessionStorage.setItem('cyberResponses', JSON.stringify(responses));
  renderResultsView();
}
</script>
</body>
</html>