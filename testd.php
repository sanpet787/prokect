<?php
/*
|--------------------------------------------------------------------------
| р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╣Др╕Яр╕ер╣М (Thai Doc Block)
|--------------------------------------------------------------------------
| р╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ: р╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣Мр╣Бр╕ер╕░ Incident Response Plan
| Flow: р╕гр╕▒р╕Ъ input р╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й, р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З, р╣Бр╕кр╕Фр╕Зр╕Ьр╕е, р╕кр╣Ир╕Зр╕нр╕нр╕Бр╣Др╕Яр╕ер╣М
| Input: responses р╕Ир╕▓р╕Бр╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б
| Output: UI, export PDF/CSV/JSON
| Error: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ null, handle export error, validate input
| р╕кр╣Ир╕зр╕Щр╕Ыр╕гр╕░р╕Бр╕нр╕Ъ: р╕Яр╕нр╕гр╣Мр╕б, р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М, IRP, export, modal
*/
?>
<?php
// ---------------------------
// р╕кр╣Ир╕зр╕Щ PHP: р╕Бр╕│р╕лр╕Щр╕Фр╕Кр╕╕р╕Фр╕Др╕│р╕Цр╕▓р╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З
// ---------------------------
$questions = [
  [
    "section" => "р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е", // р╣Ар╕Юр╕┤р╣Ир╕бр╕лр╕бр╕зр╕Ф
    "icon" => "ЁЯЧВя╕П",
    "text" => "р╕бр╕╡р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕гр╕░р╕Ър╕Ъ/р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н р╕гр╕░р╕Ър╕╕р╕Кр╕▒р╕Фр╣Ар╕Ир╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕гр╕░р╕Ър╕╕р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н р╕нр╕▓р╕Ир╕Чр╕│р╣Гр╕лр╣Йр╕Вр╕▓р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Бр╕ер╕░р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕гр╕▒р╣Ир╕зр╣Др╕лр╕ер╕лр╕гр╕╖р╕нр╕кр╕╣р╕Нр╕лр╕▓р╕вр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╕гр╕░р╕Ър╕Ър╕кр╕│р╕Др╕▒р╕Нр╣Гр╕лр╣Йр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ",
    "steps" => [
      "р╕кр╕│р╕гр╕зр╕Ир╣Бр╕ер╕░р╕гр╕░р╕Ър╕╕р╕Вр╣Йр╕нр╕бр╕╣р╕е/р╕гр╕░р╕Ър╕Ър╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕Вр╕нр╕Зр╕нр╕Зр╕Др╣Мр╕Бр╕г",
      "р╕Ир╕▒р╕Фр╕Чр╕│р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕лр╕гр╕╖р╕н inventory",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "icon" => "ЁЯЧВя╕П",
    "text" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Нр╕Цр╕╣р╕Бр╕Ир╕▒р╕Фр╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Нр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕лр╕гр╕╖р╕нр╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╣Вр╕Фр╕вр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕нр╕Щр╕╕р╕Нр╕▓р╕Х",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕Хр╣Ир╕ер╕░р╕Ыр╕гр╕░р╣Ар╕ар╕Ч",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Ф policy р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕гр╕░р╕Фр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╕Хр╕┤р╕Фр╕Ыр╣Йр╕▓р╕вр╕лр╕гр╕╖р╕нр╕Бр╕│р╕лр╕Щр╕Ф label р╣Гр╕лр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╕нр╕Ър╕гр╕бр╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М",
    "icon" => "ЁЯФС",
    "text" => "р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Яр╕ер╣М/р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕кр╕│р╕Др╕▒р╕Нр╕Ир╕│р╕Бр╕▒р╕Фр╣Ар╕Йр╕Юр╕▓р╕░р╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Нр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Вр╕Фр╕вр╕Ьр╕╣р╣Йр╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣М р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕гр╕▒р╣Ир╕зр╣Др╕лр╕ер╕лр╕гр╕╖р╕нр╣Бр╕Бр╣Йр╣Др╕Вр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "fix" => "р╕Ир╕│р╕Бр╕▒р╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Ар╕Йр╕Юр╕▓р╕░р╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
    "steps" => [
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Яр╕ер╣М/р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М",
      "р╕Ыр╕гр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕кр╕б",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М",
    "icon" => "ЁЯФС",
    "text" => "р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Й 2FA/MFA р╕Бр╕▒р╕Ър╕Ър╕▒р╕Нр╕Кр╕╡р╕кр╕│р╕Др╕▒р╕Нр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Ър╕▒р╕Нр╕Кр╕╡р╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Бр╕ор╕Бр╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щр╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡ 2FA/MFA",
    "fix" => "р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ 2FA/MFA р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ър╕▒р╕Нр╕Кр╕╡р╕кр╕│р╕Др╕▒р╕Н",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡ 2FA/MFA р╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕Щр╕гр╕░р╕Ър╕Ъ/р╕Ър╕▒р╕Нр╕Кр╕╡",
      "р╣Бр╕Ир╣Йр╕Зр╣Бр╕ер╕░р╕нр╕Ър╕гр╕бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й"
    ]
  ],
  [
    "text" => "р╣Гр╕Кр╣Йр╕лр╕ер╕▒р╕Бр╕Бр╕▓р╕гр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Чр╣Ир╕▓р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ (Least Privilege) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕нр╕▓р╕Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ьр╕┤р╕Фр╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Йр╕Юр╕▓р╕░р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Ир╕нр╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И",
    "steps" => [
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Бр╕ер╕░р╕гр╕░р╕Ър╕Ъ",
      "р╕Ыр╕гр╕▒р╕Ър╕ер╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░"
    ]
  ],
  [
    "text" => "р╣Бр╕вр╕Бр╕Ър╕▒р╕Нр╕Кр╕╡ Admin р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Ър╕▒р╕Нр╕Кр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤ р╣Бр╕ер╕░р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Ър╕▒р╕Нр╕Кр╕╡ admin р╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Гр╕Щр╕Зр╕▓р╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕зр╕▒р╕Щ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╣Бр╕ер╕░р╕Вр╕вр╕▓р╕вр╕Ьр╕е",
    "fix" => "р╣Бр╕вр╕Бр╕Ър╕▒р╕Нр╕Кр╕╡ admin р╣Бр╕ер╕░р╕Ър╕▒р╕Нр╕Кр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ы",
    "steps" => [
      "р╕кр╕гр╣Йр╕▓р╕Зр╕Ър╕▒р╕Нр╕Кр╕╡ admin р╣Бр╕вр╕Бр╕Ир╕▓р╕Б user р╕Ыр╕Бр╕Хр╕┤",
      "р╣Гр╕Кр╣Йр╕Ър╕▒р╕Нр╕Кр╕╡ admin р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕зр╕ер╕▓р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╕кр╕┤р╕Чр╕Шр╕┤р╣М admin р╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕гр╕▒р╕Ър╣Ар╕Вр╣Йр╕▓/р╕вр╣Йр╕▓р╕вр╕Зр╕▓р╕Щ/р╕ер╕▓р╕нр╕нр╕Б р╕Чр╕╡р╣Ир╕Ыр╕гр╕▒р╕Ъ/р╕Ыр╕┤р╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕▒р╕Щр╕Чр╕╡р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕нр╕Фр╕╡р╕Хр╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╕лр╕гр╕╖р╕нр╕Ьр╕╣р╣Йр╕вр╣Йр╕▓р╕вр╕Зр╕▓р╕Щр╕нр╕▓р╕Ир╕вр╕▒р╕Зр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕гр╕░р╕Ър╕Ър╣Др╕Фр╣Й",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Ыр╕┤р╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╕кр╕Цр╕▓р╕Щр╕░",
    "steps" => [
      "р╣Бр╕Ир╣Йр╕З HR/IT р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З",
      "р╕Ыр╕┤р╕Ф/р╕Ыр╕гр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕▒р╕Щр╕Чр╕╡",
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х/р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И",
    "icon" => "ЁЯЫбя╕П",
    "text" => "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Бр╕Юр╕Хр╕Кр╣Мр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓ (р╣Ар╕Кр╣Ир╕Щ р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕кр╕│р╕Др╕▒р╕Нр╕ар╕▓р╕вр╣Гр╕Щ 14 р╕зр╕▒р╕Щ) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕гр╕░р╕Ър╕Ър╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╕Ьр╣Ир╕▓р╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х",
    "fix" => "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Бр╕Юр╕Хр╕Кр╣Мр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Хр╕▓р╕бр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓",
    "steps" => [
      "р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Ыр╕гр╕░р╕Бр╕▓р╕ир╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И",
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╣Бр╕ер╕░р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕лр╕ер╕▒р╕Зр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕гр╕░р╕Ър╕Ър╕кр╕│р╕Др╕▒р╕Нр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Др╣Йр╕Щр╕Юр╕Ър╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Вр╕Ир╕бр╕Хр╕╡",
    "fix" => "р╕кр╣Бр╕Бр╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕гр╕░р╕Ър╕Ър╕кр╕│р╕Др╕▒р╕Нр╕нр╕вр╣Ир╕▓р╕Зр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╣Бр╕Бр╕Щр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И",
      "р╕Бр╕│р╕лр╕Щр╕Фр╕гр╕нр╕Ър╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ",
      "р╣Бр╕Бр╣Йр╣Др╕Вр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕Юр╕Ъ"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "icon" => "ЁЯТ╛",
    "text" => "р╕бр╕╡ Asset Inventory р╕Чр╕╡р╣Ир╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Ар╕кр╕бр╕нр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Др╕бр╣Ир╕Чр╕гр╕▓р╕Ър╕зр╣Ир╕▓р╕бр╕╡р╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╣Гр╕Фр╕Ър╣Йр╕▓р╕З р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Бр╕ер╕░р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х Asset Inventory",
    "steps" => [
      "р╕гр╕зр╕Ър╕гр╕зр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М/р╕гр╕░р╕Ър╕Ър╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф",
      "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Ар╕нр╕Бр╕кр╕▓р╕г",
      "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З"
    ]
  ],
  [
    "text" => "р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ/р╣Др╕Яр╕ер╣Мр╕кр╕│р╕Др╕▒р╕Нр╕Хр╕▓р╕бр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▓р╕Ир╕кр╕╣р╕Нр╕лр╕▓р╕вр╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
    "fix" => "р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▓р╕бр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Ф",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Фр╕гр╕нр╕Ър╣Ар╕зр╕ер╕▓р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕Зр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕кр╕│р╕гр╕нр╕Зр╣Бр╕Ър╕Ъ Offline/Immutable/Offsite р╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕▒р╕Щ Ransomware р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕гр╕нр╕Зр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╕ер╕▒р╕Б",
    "fix" => "р╣Гр╕Кр╣Йр╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╣Бр╕Ър╕Ъ Offline/Immutable/Offsite",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Фр╕Щр╣Вр╕вр╕Ър╕▓р╕вр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е",
      "р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕Зр╕Чр╕╡р╣Ир╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Ир╕▓р╕Бр╕кр╕│р╕гр╕нр╕З"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М",
    "icon" => "ЁЯФО",
    "text" => "р╕Бр╕│р╕лр╕Щр╕Ф RTO/RPO р╣Бр╕Ър╕Ър╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Зр╣Ир╕▓р╕вр╣Др╕зр╣Йр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Др╕бр╣Ир╕Чр╕гр╕▓р╕Ър╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ъ/р╕Вр╣Йр╕нр╕бр╕╣р╕е р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Яр╕╖р╣Йр╕Щр╕Яр╕╣р╣Др╕бр╣Ир╕Чр╕▒р╕Щр╣Ар╕зр╕ер╕▓",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Ф RTO/RPO р╣Гр╕лр╣Йр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ",
    "steps" => [
      "р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Др╕зр╕▓р╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Шр╕╕р╕гр╕Бр╕┤р╕И",
      "р╕Бр╕│р╕лр╕Щр╕Ф RTO/RPO",
      "р╣Бр╕Ир╣Йр╕Зр╣Гр╕лр╣Йр╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╕гр╕▒р╕Ър╕Чр╕гр╕▓р╕Ъ"
    ]
  ],
  [
    "text" => "р╣Ар╕Др╕вр╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Ир╕гр╕┤р╕Зр╣Гр╕Щ 6тАУ12 р╣Ар╕Фр╕╖р╕нр╕Щр╕Чр╕╡р╣Ир╕Ьр╣Ир╕▓р╕Щр╕бр╕▓р╣Бр╕ер╕░р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕нр╕▓р╕Ир╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Ир╕гр╕┤р╕Зр╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│",
    "steps" => [
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щ",
      "р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ",
      "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╣Бр╕ер╕░р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М",
    "icon" => "ЁЯЪи",
    "text" => "р╕гр╕зр╕Ър╕гр╕зр╕б Logs р╣Др╕зр╣Йр╕Чр╕╡р╣Ир╕Ир╕╕р╕Фр╕Бр╕ер╕▓р╕З (р╣Ар╕Кр╣Ир╕Щ Syslog/SIEM) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕е Log р╕нр╕▓р╕Ир╕Бр╕гр╕░р╕Ир╕▒р╕Фр╕Бр╕гр╕░р╕Ир╕▓р╕в р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕вр╣Йр╕нр╕Щр╕лр╕ер╕▒р╕Зр╣Др╕Фр╣Йр╕вр╕▓р╕Б",
    "fix" => "р╕гр╕зр╕Ър╕гр╕зр╕б Log р╣Др╕зр╣Йр╕Чр╕╡р╣Ир╕Ир╕╕р╕Фр╕Бр╕ер╕▓р╕З",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╣Вр╕Лр╕ер╕╣р╕Кр╕▒р╕Щ Log Centralization",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Гр╕лр╣Йр╕кр╣Ир╕З Log",
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Log р╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕гр╕░р╕Ър╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Ар╕лр╕Хр╕╕р╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤р╣Бр╕ер╕░р╕бр╕╡р╕Др╕Щр╣Ар╕Эр╣Йр╕▓р╕Фр╕╣р╣Гр╕Щр╣Ар╕зр╕ер╕▓р╕Зр╕▓р╕Щр╕лр╕гр╕╖р╕н 24/7 р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕лр╕Хр╕╕р╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤р╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╕Хр╕гр╕зр╕Ир╕Юр╕Ър╕ер╣Ир╕▓р╕Кр╣Йр╕▓",
    "fix" => "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Бр╕ер╕░р╕бр╕╡р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ",
    "steps" => [
      "р╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ",
      "р╕бр╕нр╕Ър╕лр╕бр╕▓р╕вр╕Ьр╕╣р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕бр╕▒р╕ер╣Бр╕зр╕гр╣М",
    "icon" => "ЁЯжа",
    "text" => "р╕Чр╕╕р╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╡ Antivirus/EDR р╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕нр╕▓р╕Ир╕Хр╕┤р╕Фр╕бр╕▒р╕ер╣Бр╕зр╕гр╣Мр╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕лр╕гр╕╖р╕нр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х",
    "fix" => "р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Antivirus/EDR р╣Бр╕ер╕░р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤",
    "steps" => [
      "р╣Ар╕ер╕╖р╕нр╕Бр╣Вр╕Лр╕ер╕╣р╕Кр╕▒р╕Щ Antivirus/EDR",
      "р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Гр╕Щр╕Чр╕╕р╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕лр╣Йр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ър╕гр╕┤р╕лр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г",
    "icon" => "ЁЯСФ",
    "text" => "р╕бр╕╡р╣Бр╕Ьр╕Щ IRP р╣Ар╕Ыр╣Зр╕Щр╕ер╕▓р╕вр╕ер╕▒р╕Бр╕йр╕Ур╣Мр╕нр╕▒р╕Бр╕йр╕гр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Др╕бр╣Ир╣Ар╕Бр╕┤р╕Щ 12 р╣Ар╕Фр╕╖р╕нр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╕▓р╕Фр╣Бр╕Ьр╕Щр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М р╕нр╕▓р╕Ир╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╕ер╣Ир╕▓р╕Кр╣Йр╕▓р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Бр╕Ьр╕Щ IRP",
    "steps" => [
      "р╣Ар╕Вр╕╡р╕вр╕Щр╣Бр╕Ьр╕Щ IRP р╣Гр╕лр╣Йр╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Чр╕╕р╕Бр╕Ыр╕╡",
      "р╣Бр╕Ир╣Йр╕Зр╣Гр╕лр╣Йр╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╕гр╕▒р╕Ър╕Чр╕гр╕▓р╕Ъ"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ъ/р╣Ар╕Ър╕нр╕гр╣Мр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щ (р╣Гр╕ЩтАУр╕Щр╕нр╕Бр╕нр╕Зр╕Др╣Мр╕Бр╕г) р╕Чр╕╡р╣Ир╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Фр╣Йр╣Ар╕гр╣Зр╕зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Ьр╕╣р╣Йр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╣Бр╕ер╕░р╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щ",
    "steps" => [
      "р╕гр╕зр╕Ър╕гр╕зр╕бр╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╣Бр╕ер╕░р╣Ар╕Ър╕нр╕гр╣Мр╕Хр╕┤р╕Фр╕Хр╣Ир╕н",
      "р╕Ир╕▒р╕Фр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щр╕Чр╕╡р╣Ир╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕Зр╣Ир╕▓р╕в",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Вр╣Йр╕нр╕бр╕╣р╕е"
    ]
  ],
  [
    "text" => "р╕бр╕╡ Playbook р╕нр╕вр╣Ир╕▓р╕Зр╕Щр╣Йр╕нр╕вр╕Яр╕┤р╕Кр╕Кр╕┤р╕З/р╕бр╕▒р╕ер╣Бр╕зр╕гр╣М/р╣Бр╕гр╕Щр╕Лр╕▒р╕бр╣Бр╕зр╕гр╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╕▓р╕Фр╣Бр╕Щр╕зр╕Чр╕▓р╕Зр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕р╣Ар╕Йр╕Юр╕▓р╕░р╕лр╕Щр╣Йр╕▓",
    "fix" => "р╕Ир╕▒р╕Фр╕Чр╕│ Playbook р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕кр╕│р╕Др╕▒р╕Н",
    "steps" => [
      "р╕гр╕░р╕Ър╕╕р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в",
      "р╣Ар╕Вр╕╡р╕вр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Бр╕Хр╣Ир╕ер╕░р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М",
      "р╕нр╕Ър╕гр╕бр╕Чр╕╡р╕бр╕Зр╕▓р╕Щ"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕лр╕Хр╕╕р╣Др╕бр╣Ир╣Гр╕лр╣Йр╕ер╕▓р╕б р╣Бр╕ер╕░р╣Ар╕Др╕вр╕Лр╣Йр╕нр╕бр╣Бр╕ер╣Йр╕зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕нр╕▓р╕Ир╕ер╕╕р╕Бр╕ер╕▓р╕бр╕Вр╕вр╕▓р╕вр╕зр╕Зр╕Бр╕зр╣Йр╕▓р╕З",
    "fix" => "р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕лр╕Хр╕╕р╣Бр╕ер╕░р╕Лр╣Йр╕нр╕бр╕гр╕▒р╕Ър╕бр╕╖р╕н",
    "steps" => [
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕лр╕Хр╕╕",
      "р╕Лр╣Йр╕нр╕бр╕гр╕▒р╕Ър╕бр╕╖р╕нр╕Бр╕▒р╕Ър╕Чр╕╡р╕бр╕Зр╕▓р╕Щ",
      "р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╕▓р╕бр╕Ьр╕ер╕Лр╣Йр╕нр╕б"
    ]
  ],
  [
    "text" => "р╣Ар╕Др╕вр╕Лр╣Йр╕нр╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╕Ыр╕╡р╕ер╕░р╕Др╕гр╕▒р╣Йр╕З р╣Бр╕ер╕░р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щ/р╕Ыр╕гр╕▒р╕Ър╣Бр╕Ьр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╕нр╕▓р╕Ир╣Др╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Ир╕гр╕┤р╕З",
    "fix" => "р╕Лр╣Йр╕нр╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╣Бр╕ер╕░р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╕Чр╕╕р╕Бр╕Ыр╕╡",
    "steps" => [
      "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕Лр╣Йр╕нр╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣М",
      "р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕Лр╣Йр╕нр╕б",
      "р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╣Бр╕ер╕░р╕Ыр╕гр╕▒р╕Ър╣Бр╕Ьр╕Щ"
    ]
  ],
  [
    "section" => "р╕Бр╕▓р╕гр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Хр╕▓р╕бр╕Бр╕Ор╕лр╕бр╕▓р╕в",
    "icon" => "ЁЯУЬ",
    "text" => "р╣Бр╕Ьр╕Щ BCP/DR р╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ IRP р╣Бр╕ер╕░р╣Ар╕Др╕вр╕Чр╕Фр╕кр╕нр╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Бр╕Ьр╕Щ BCP/DR р╣Др╕бр╣Ир╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ IRP р╕нр╕▓р╕Ир╕Яр╕╖р╣Йр╕Щр╕Яр╕╣р╕гр╕░р╕Ър╕Ър╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Хр╕▓р╕бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в",
    "fix" => "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ьр╕Щ BCP/DR р╣Гр╕лр╣Йр╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ IRP",
    "steps" => [
      "р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Бр╕Ьр╕Щ BCP/DR р╕Бр╕▒р╕Ъ IRP",
      "р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Гр╕лр╣Йр╕кр╕нр╕Фр╕Др╕ер╣Йр╕нр╕Зр╕Бр╕▒р╕Щ",
      "р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ьр╕Щр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│"
    ]
  ],
  [
    "text" => "р╕Чр╕гр╕▓р╕Ъ PDPA/р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕ер╕╣р╕Бр╕Др╣Йр╕▓ р╣Бр╕ер╕░р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕нр╕▓р╕Ир╕ер╕░р╣Ар╕бр╕┤р╕Фр╕Бр╕Ор╕лр╕бр╕▓р╕вр╕лр╕гр╕╖р╕нр╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕",
    "fix" => "р╕ир╕╢р╕Бр╕йр╕▓р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╣Бр╕ер╕░р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕",
    "steps" => [
      "р╕ир╕╢р╕Бр╕йр╕▓р╕Бр╕Ор╕лр╕бр╕▓р╕в/р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З",
      "р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕",
      "р╕нр╕Ър╕гр╕бр╕Чр╕╡р╕бр╕Зр╕▓р╕Щ"
    ]
  ],
  [
    "text" => "р╕бр╕╡р╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н CERT/р╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Нр╕ар╕▓р╕вр╕Щр╕нр╕Бр╣Др╕зр╣Йр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Вр╕нр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕нр╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Нр╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡",
    "fix" => "р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н CERT/р╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Нр╣Др╕зр╣Йр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓",
    "steps" => [
      "р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕е CERT/р╕Ьр╕╣р╣Йр╣Ар╕Кр╕╡р╣Ир╕вр╕зр╕Кр╕▓р╕Н",
      "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н",
      "р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕н"
    ]
  ],
  [
    "section" => "р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ",
    "icon" => "ЁЯМР",
    "text" => "р╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╣Бр╕Ър╣Ир╕Зр╣Вр╕Лр╕Щ/р╣Ар╕Лр╕Бр╣Ар╕бр╕Щр╕Хр╣Мр╕ер╕Фр╕Бр╕▓р╕гр╕ер╕▓р╕бр╕Вр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕нр╕▓р╕Ир╕ер╕╕р╕Бр╕ер╕▓р╕бр╣Др╕Ыр╕вр╕▒р╕Зр╕гр╕░р╕Ър╕Ър╕нр╕╖р╣Ир╕Щр╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в",
    "fix" => "р╣Бр╕Ър╣Ир╕Зр╣Вр╕Лр╕Щр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Фр╕Бр╕▓р╕гр╕ер╕▓р╕б",
    "steps" => [
      "р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕в",
      "р╕Бр╕│р╕лр╕Щр╕Фр╣Вр╕Лр╕Щ/segment",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ firewall р╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╣Вр╕Лр╕Щ"
    ]
  ],
  [
    "text" => "р╕Чр╕Ър╕Чр╕зр╕Щр╕Бр╕Ор╣Др╕Яр╕гр╣Мр╕зр╕нр╕ер╕ер╣М р╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╣Ар╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╣Вр╕Ир╕бр╕Хр╕╡",
    "fix" => "р╕Чр╕Ър╕Чр╕зр╕Щр╣Бр╕ер╕░р╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ",
    "steps" => [
      "р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕О firewall",
      "р╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Гр╕Кр╣Й",
      "р╕Чр╕Ър╕Чр╕зр╕Щр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕вр╕░"
    ]
  ],
  [
    "section" => "Cloud/р╕Др╕ер╕▓р╕зр╕Фр╣М",
    "icon" => "тШБя╕П",
    "text" => "р╕Др╕ер╕▓р╕зр╕Фр╣Мр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ (MFA/Logs/Encryption) р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?",
    "type" => "radio",
    "choices" => [
      ["label" => "р╣Гр╕Кр╣И", "score" => 0],
      ["label" => "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", "score" => 1],
      ["label" => "р╣Др╕бр╣Ир╣Гр╕Кр╣И", "score" => 2]
    ],
    "risk" => "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕Ър╕Щр╕Др╕ер╕▓р╕зр╕Фр╣Мр╕нр╕▓р╕Ир╕Цр╕╣р╕Бр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕лр╕гр╕╖р╕нр╣Вр╕Ир╕бр╕Хр╕╡р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в",
    "fix" => "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Ър╕Щр╕Др╕ер╕▓р╕зр╕Фр╣М",
    "steps" => [
      "р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Й MFA",
      "р╣Ар╕Ыр╕┤р╕Ф Logging",
      "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Encryption"
    ]
  ]
];
?>
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Cyber IRP Risk Assessment (PHP)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/avif" href="logo.avif">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ---------------------------
       р╕кр╣Ир╕зр╕Щ CSS: р╕Хр╕Бр╣Бр╕Хр╣Ир╕Зр╕лр╕Щр╣Йр╕▓р╕Хр╕▓р╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б
       --------------------------- */
    body {
      background: linear-gradient(135deg, #f0fdfa 0%, #e0f2fe 100%);
    }
    .cyber-glow {
      /* р╣Гр╕кр╣Ир╣Ар╕Зр╕▓р╣Гр╕лр╣Йр╕лр╕▒р╕зр╕Вр╣Йр╕н */
      text-shadow: 0 2px 8px #38bdf8, 0 0px 2px #0ea5e9;
      letter-spacing: 0.03em;
    }
    .question-card {
      /* р╕Бр╕ер╣Ир╕нр╕Зр╕Др╕│р╕Цр╕▓р╕б */
      background: #fff;
      border: none;
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 #38bdf822;
      max-width: 600px;
      margin: 0 auto;
      transition: box-shadow 0.2s;
      padding: 2.5rem 2rem 2rem 2rem;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      animation: fadeInUp 0.5s;
    }
    @keyframes fadeInUp {
      from { opacity:0; transform: translateY(30px);}
      to { opacity:1; transform: translateY(0);}
    }
    .question-card:after {
      /* р╣Ар╕кр╣Йр╕Щ gradient р╣Гр╕Хр╣Йр╕Бр╕ер╣Ир╕нр╕З */
      content: "";
      position: absolute;
      left: 1.5rem; right: 1.5rem; bottom: 0;
      height: 4px;
      border-radius: 2px;
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      opacity: 0.12;
    }
    .question-progress {
      /* р╣Бр╕Цр╕Ъ progress */
      background: #e0f2fe;
      border-radius: 1rem;
      overflow: hidden;
      height: 12px;
      margin-bottom: 2rem;
      box-shadow: 0 1px 4px #38bdf822;
    }
    .question-progress-bar {
      /* progress bar р╕кр╕╡р╕Яр╣Йр╕▓ */
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      height: 100%;
      transition: width 0.4s cubic-bezier(.4,2,.6,1);
    }
    .radio-group {
      /* р╕Бр╕ер╕╕р╣Ир╕б radio button */
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 0.5rem;
    }
    .radio-group label {
      /* р╕Ыр╕╕р╣Ир╕бр╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б */
      background: #f1f5f9;
      border-radius: 0.5rem;
      padding: 0.45rem 1.2rem 0.45rem 1rem;
      font-weight: 500;
      cursor: pointer;
      border: 1.5px solid transparent;
      transition: border 0.2s, background 0.2s;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 1rem;
    }
    .radio-group input[type="radio"] {
      margin-right: 0.3rem;
    }
    .radio-group input[type="radio"]:checked + span {
      color: #0ea5e9;
      font-weight: 700;
    }
    .radio-group input[type="radio"]:focus + span {
      outline: 2px solid #38bdf8;
    }
    .question-section {
      /* р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И (р╕Цр╣Йр╕▓р╕бр╕╡) */
      color: #0ea5e9;
      font-weight: 600;
      font-size: 1.05rem;
      margin-bottom: 0.2rem;
      letter-spacing: 0.01em;
    }
    .question-number {
      /* р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Вр╣Йр╕н */
      position: absolute;
      top: 1.2rem;
      right: 2rem;
      color: #b6c7d6;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.04em;
    }
    .question-card input[type="text"] {
      /* р╕Кр╣Ир╕нр╕Зр╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ */
      background: #f8fafc;
      border: 1.5px solid #e0f2fe;
      border-radius: 0.6rem;
      padding: 0.7rem 1rem;
      font-size: 1rem;
      margin-top: 0.2rem;
      transition: border 0.2s;
      width: 100%;
    }
    .question-card input[type="text"]:focus {
      border-color: #38bdf8;
      outline: none;
      background: #fff;
    }
    .btn-main {
      /* р╕Ыр╕╕р╣Ир╕бр╕Цр╕▒р╕Фр╣Др╕Ы */
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      color: #fff;
      font-weight: 600;
      border-radius: 0.7rem;
      padding: 0.7rem 2.2rem;
      box-shadow: 0 2px 8px #38bdf822;
      transition: background 0.2s, box-shadow 0.2s;
      border: none;
    }
    .btn-main:hover, .btn-export:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 24px #38bdf822;
    }
    .btn-secondary {
      /* р╕Ыр╕╕р╣Ир╕бр╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ */
      background: #f1f5f9;
      color: #0ea5e9;
      font-weight: 600;
      border-radius: 0.7rem;
      padding: 0.7rem 2.2rem;
      border: none;
      transition: background 0.2s;
    }
    .btn-secondary:hover {
      background: #e0f2fe;
    }
    .btn-group > * { margin: 0 0.3rem 0.5rem 0.3rem; }
    @media (max-width: 600px) {
      /* Responsive р╕кр╕│р╕лр╕гр╕▒р╕Ър╕бр╕╖р╕нр╕Цр╕╖р╕н */
      .question-card { padding: 1.2rem 0.7rem 1.2rem 0.7rem; }
      .question-number { right: 1rem; top: 0.7rem; }
      .radio-group label { font-size: 0.97rem; padding: 0.4rem 0.8rem 0.4rem 0.7rem; }
    }
    @media print {
      /* р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Юр╕┤р╕бр╕Юр╣М/Export PDF */
      .print\:hidden { display: none !important; }
      body { background: #fff !important; }
      .question-card { box-shadow: none !important; border: 1px solid #bbb !important; }
      #exportBtns { display: none !important; }
    }
    .panel-header { font-size:1.25rem; font-weight:700; color:#2563eb; background:#f1f5f9; border-radius:0.7rem 0.7rem 0 0; padding:1rem 1.5rem; cursor:pointer; display:flex; align-items:center; justify-content:space-between; }
    .panel-content {
      display: block !important; /* р╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╣Гр╕лр╣Й block р╣Ар╕кр╕бр╕н */
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.4s cubic-bezier(.4,2,.6,1);
    }
    .panel-content.open {
      max-height: 2000px; /* р╕лр╕гр╕╖р╕нр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕бр╕▓р╕Бр╕Юр╕нр╣Гр╕лр╣Йр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Бр╕кр╕Фр╕Зр╕Др╕гр╕Ъ */
    }
    .panel.active .panel-content { display:block; }
    .panel { margin-bottom:2rem; box-shadow:0 2px 12px #38bdf822; border-radius:0.7rem; }
    .panel-header svg { transition:transform 0.2s; }
    .panel.active .panel-header svg { transform:rotate(90deg);}
    .result-table { width:100%; border-collapse:collapse; margin-bottom:1.5rem; }
    .result-table th, .result-table td { border:1px solid #e0e7ef; padding:0.7em 1em; text-align:left; }
    .result-table th { background:#f1f5f9; font-weight:700; }
    .result-table tr:nth-child(even) { background:#f8fafc; }
    .risk-high { color:#dc2626; font-weight:bold; }
    .risk-medium { color:#d97706; font-weight:bold; }
    .risk-low { color:#16a34a; font-weight:bold; }
    .heatmap-table { border-collapse:collapse; margin:1.5rem auto; }
    .heatmap-table td, .heatmap-table th { width:60px; height:40px; text-align:center; font-weight:600; border:1px solid #e0e7ef; }
    .heatmap-low { background:#bbf7d0; }
    .heatmap-medium { background:#fde68a; }
    .heatmap-high { background:#fecaca; }
    .stepper { border-left:4px solid #38bdf8; margin-left:1.5rem; padding-left:2rem; }
    .stepper-phase { position:relative; margin-bottom:2.5rem; }
    .stepper-phase:last-child { margin-bottom:0; }
    .stepper-dot { position:absolute; left:-2.2rem; top:0.2rem; width:1.3rem; height:1.3rem; background:#38bdf8; border-radius:50%; border:3px solid #fff; box-shadow:0 0 0 2px #38bdf8; }
    .stepper-title { font-size:1.1rem; font-weight:700; color:#0ea5e9; margin-bottom:0.5rem; }
    .stepper-table { margin-bottom:0.7rem; }
    .stepper-table th, .stepper-table td { font-size:0.98rem; }
    .summary-card { background:#f1f5f9; border-radius:0.7rem; padding:1.2rem 1.5rem; margin-bottom:1.5rem; font-size:1.1rem; }
    .export-btns { margin-top:2rem; display:flex; flex-wrap:wrap; gap:0.7rem; justify-content:center; }
    .btn-export { background:#f1f5f9; color:#0ea5e9; font-weight:600; border-radius:0.7rem; padding:0.7rem 2.2rem; border:none; transition:background 0.2s; }
    .btn-export:hover { background:#e0f2fe; }
    /* ---------------------------
       р╕кр╣Ир╕зр╕Щ CSS: р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М Pro Report
       --------------------------- */
    .panel-header { background: #f1f5f9; }
    .panel-header span { font-weight: 600; }
    .panel-content { background: #fff; border: 1px solid #e0e7ef; }
    .result-table th {
      background: #f1f5f9;
      color: #0e2233;
      font-weight: 600;
    }
    .result-table td {
      background: #fff;
      color: #0e2233;
    }
    .risk-high { color:#dc2626; font-weight:bold; }
    .risk-medium { color:#d97706; font-weight:bold; }
    .risk-low { color:#16a34a; font-weight:bold; }
    .heatmap-table td, .heatmap-table th {
      background: #f1f5f9;
      color: #0e2233;
      font-weight: 600;
    }
    .stepper-dot { background:#38bdf8; }
    .stepper-title { color:#0ea5e9; }
    /* ---------------------------
       р╕кр╣Ир╕зр╕Щ CSS: р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ъ Modal
       --------------------------- */
    .modal-content {
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 #38bdf822;
    }
    .modal-header {
      border-bottom: 1px solid #e0e7ef;
    }
    .modal-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #0e2233;
    }
    .modal-body {
      font-size: 1rem;
      color: #0e2233;
    }
    /* р╕Ыр╕гр╕▒р╕Ър╕Вр╕Щр╕▓р╕Ф modal р╕кр╕│р╕лр╕гр╕▒р╕Ър╕лр╕Щр╣Йр╕▓р╕Ир╕нр╣Ар╕ер╣Зр╕Б */
    @media (max-width: 768px) {
      .modal-dialog {
        max-width: 90%;
        margin: 1rem auto;
      }
    }
  </style>
  <!-- р╣Ар╕Юр╕┤р╣Ир╕б Bootstrap 5 CSS/JS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<div class="max-w-xl mx-auto my-8 p-2">
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б (р╣Вр╕ер╣Вр╕Бр╣Й/р╕лр╕▒р╕зр╕Вр╣Йр╕н)
       --------------------------- -->
  <div class="flex flex-col items-center mb-8">
    <!-- р╣Вр╕ер╣Вр╕Бр╣Йр╕Ър╕гр╕┤р╕йр╕▒р╕Чр╣Бр╕Ър╕Ър╣Вр╕Ыр╕г (р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣М logo.avif) -->
    <img 
      src="logo.avif" 
      alt="HackerProtect Pro Logo" 
      style="
        width:110px;
        margin-bottom:18px;
        border-radius: 22px;
        box-shadow: 0 6px 32px 0 #38bdf855, 0 1px 2px #0ea5e955;
        background: linear-gradient(135deg, #f0fdfa 0%, #e0f2fe 100%);
        border: 2.5px solid #38bdf8;
        padding: 8px;
        transition: box-shadow 0.2s;
      "
      class="hover:scale-105 transition-transform duration-200"
    >
    <!-- р╕лр╕▒р╕зр╕Вр╣Йр╕нр╕лр╕ер╕▒р╕Бр╣Бр╕Ър╕Ъ Paradise Resort Style -->
    <h1 
      class="text-4xl md:text-5xl font-extrabold text-center mb-2"
      style="
        color: #0e2233;
        letter-spacing: 0.03em;
        text-shadow:
          0 6px 32px #38bdf822,
          0 2px 8px #0ea5e9,
          0 1px 0 #fff,
          0 0 2px #fff;
        font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;
        background: none;
        -webkit-background-clip: initial;
        -webkit-text-fill-color: initial;
        background-clip: initial;
      "
    >
      CHECK RISK
      <span 
        class="align-super font-bold"
        style="
          font-size:0.7em;
          margin-left:0.2em;
          letter-spacing:0.05em;
          color: #38bdf8;
          text-shadow:0 2px 8px #38bdf8, 0 0px 2px #0ea5e9;
          font-family: inherit;
        "
      >
    </div>
    <p 
      class="text-center text-cyan-800 text-lg md:text-xl font-medium mb-2"
      style="font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;"
    >
      р╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Др╕зр╕▓р╕бр╕Юр╕гр╣Йр╕нр╕бр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣Мр╕ар╕▓р╕вр╣Гр╕Щр╕нр╕Зр╕Др╣Мр╕Бр╕г
    </p>
  </div>
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щр╕Яр╕нр╕гр╣Мр╕бр╕Др╕│р╕Цр╕▓р╕б
       --------------------------- -->
  <section id="formSection">
    <!-- Progress bar -->
    <div class="question-progress">
      <div id="progressBar" class="question-progress-bar" style="width:0%"></div>
    </div>
    <form id="assessmentForm" autocomplete="off">
      <div id="questionBox"></div>
      <!-- р╕Ыр╕╕р╣Ир╕бр╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ/р╕Цр╕▒р╕Фр╣Др╕Ы -->
      <div class="btn-group flex flex-row gap-2 mt-4 justify-center print:hidden">
        <button type="button" id="prevBtn" class="btn-secondary" style="min-width:110px;">р╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ</button>
        <button type="button" id="nextBtn" class="btn-main" style="min-width:110px;">р╕Цр╕▒р╕Фр╣Др╕Ы</button>
      </div>
    </form>
  </section>
  <!-- =========================
       р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М Risk Assessment & IRP
       ========================= -->
  <section id="proResultsSection" style="display:none;">
    <h2 class="text-2xl font-bold mb-6 text-center text-blue-800">Risk Assessment Results</h2>
    <!-- Collapsible Panels -->
    <div class="panel active" id="panel-risk">
      <div class="panel-header">
        <span>Cybersecurity Risk Assessment</span>
        <svg width="18" height="18" fill="none"><path d="M6 7l3 3 3-3" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>
      </div>
      <div class="panel-content">
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">Risk Scenario Table</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Threat Event</th>
                <th>Vulnerability</th>
                <th>Consequence</th>
              </tr>
            </thead>
            <tbody id="riskScenarioRows"></tbody>
          </table>
        </div>
        <div class="mb-6">
          <div class="font-bold text-lg mb-2">Likelihood & Impact Matrix</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Likelihood (1-3)</th>
                <th>Impact (1-3)</th>
                <th>Risk Level</th>
              </tr>
            </thead>
            <tbody id="riskMatrixRows"></tbody>
          </table>
          <div class="mt-4">
            <div class="font-bold text-lg mb-2">Risk Heatmap</div>
            <table class="heatmap-table">
              <tr>
                <th rowspan="2" style="writing-mode:vertical-lr;transform:rotate(180deg);">Impact</th>
                <th colspan="3">Likelihood</th>
              </tr>
              <tr>
                <th>1</th><th>2</th><th>3</th>
              </tr>
              <tbody id="heatmapGrid"></tbody>
            </table>
          </div>
        </div>
        <div>
          <div class="font-bold text-lg mb-2">Risk Response Table</div>
          <table class="result-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Risk Level</th>
                <th>Recommended Response</th>
              </tr>
            </thead>
            <tbody id="riskResponseRows"></tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="panel" id="panel-irp">
      <div
        id="irp-toggle"
        class="panel-header"
        tabindex="0"
        role="button"
        aria-expanded="false"
        aria-controls="irp-panel"
        data-testid="irp-toggle"
        style="user-select:none;outline:none;display:flex;align-items:center;justify-content:space-between;cursor:pointer;"
      >
        <span>Incident Response Plan</span>
        <svg id="irp-caret" width="18" height="18" fill="none" style="transition:transform 0.3s;">
          <path d="M6 7l3 3 3-3" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <div
        id="irp-panel"
        class="panel-content"
        data-testid="irp-panel"
        aria-hidden="true"
      >
        <!-- ...р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓... -->
      </div>
    </div>
    <div class="export-btns print:hidden">
      <button type="button" class="btn-export" id="exportPDF2">Export PDF</button>
      <button type="button" class="btn-export" id="exportCSV2">Export CSV</button>
      <button type="button" class="btn-export" id="exportJSON2">Export JSON</button>
    </div>
  </section>
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щр╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╣Бр╕ер╕░р╕Ыр╕╕р╣Ир╕б Export
       --------------------------- -->
  <section id="summarySection" style="display:none">
    <div id="summary" class="mt-10"></div>
    <div id="exportBtns" class="export-btns print:hidden">
      <button type="button" class="btn-export" id="exportPDF">Export PDF</button>
      <button type="button" class="btn-export" id="exportCSV">Export CSV</button>
      <button type="button" class="btn-export" id="exportJSON">Export JSON</button>
      <button type="button" class="btn-export" onclick="window.print()">Print</button>
    </div>
  </section>
  <!-- ---------------------------
       р╕кр╣Ир╕зр╕Щ Footer
       --------------------------- -->
  <footer class="mt-12 text-center text-xs text-cyan-700 print:text-black">
    &copy; <?= date('Y') ?> Cyber IRP Risk Assessment | For internal use only
  </footer>
</div>
<!-- р╣Ар╕Юр╕┤р╣Ир╕б Modal HTML р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З -->
<div class="modal fade" id="riskHighModal" tabindex="-1" aria-labelledby="riskHighModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="riskHighModalLabel">р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="р╕Ыр╕┤р╕Ф"></button>
      </div>
      <div class="modal-body" id="riskHighModalBody">
        <!-- р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Хр╕гр╕Зр╕Щр╕╡р╣Й -->
      </div>
    </div>
  </div>
</div>
<script>
// ---------------------------
// р╕кр╣Ир╕зр╕Щ: р╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣И/р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓
// ---------------------------
const QUESTIONS = <?php echo json_encode($questions); ?>; // р╕Фр╕╢р╕Зр╕Др╕│р╕Цр╕▓р╕бр╕Ир╕▓р╕Б PHP
const SCORE_MAP = { yes: 0, partial: 1, no: 2 }; // р╕Бр╕│р╕лр╕Щр╕Фр╕Др╕░р╣Бр╕Щр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б
const LABEL_MAP = { yes: "р╣Гр╕Кр╣И", partial: "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И", no: "р╣Др╕бр╣Ир╣Гр╕Кр╣И" }; // р╣Бр╕Ыр╕ер╕Зр╕Др╣Ир╕▓р╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕Ыр╣Зр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б
const RISK_LEVEL = { 2: '<span class="risk-high">р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</span>', 1: '<span class="risk-medium">р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З</span>', 0: '<span class="risk-low">р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕│</span>' };
const SECTION_ICONS = {
  "р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е": "ЁЯЧВя╕П",
  "р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М": "ЁЯФС",
  "р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х/р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И": "ЁЯЫбя╕П",
  "р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е": "ЁЯТ╛",
  "р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М": "ЁЯФО",
  "р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М": "ЁЯЪи",
  "р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕бр╕▒р╕ер╣Бр╕зр╕гр╣М": "ЁЯжа",
  "р╕Бр╕▓р╕гр╕Ър╕гр╕┤р╕лр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г": "ЁЯСФ",
  "р╕Бр╕▓р╕гр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Хр╕▓р╕бр╕Бр╕Ор╕лр╕бр╕▓р╕в": "ЁЯУЬ",
  "р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ": "ЁЯМР",
  "Cloud/р╕Др╕ер╕▓р╕зр╕Фр╣М": "тШБя╕П"
};

let current = 0; // р╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕Бр╕│р╕ер╕▒р╕Зр╣Бр╕кр╕Фр╕З
let responses = []; // р╣Ар╕Бр╣Зр╕Ър╕Др╕│р╕Хр╕нр╕Ър╣Бр╕Хр╣Ир╕ер╕░р╕Вр╣Йр╕н

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Др╕╖р╕Щр╕Др╣Ир╕▓р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╕ир╕▒р╕Юр╕Чр╣Мр╣Ар╕Йр╕Юр╕▓р╕░ (tooltip)
// ---------------------------
function getQuestionHint(q) {
  // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Др╕│р╕Цр╕▓р╕бр╕бр╕╡р╕ир╕▒р╕Юр╕Чр╣Мр╣Ар╕Йр╕Юр╕▓р╕░р╕лр╕гр╕╖р╕нр╣Др╕бр╣И р╣Бр╕ер╣Йр╕зр╕Др╕╖р╕Щр╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в
  if(q.text.includes("RTO/RPO")) return 'RTO (Recovery Time Objective) р╕Др╕╖р╕нр╣Ар╕зр╕ер╕▓р╕кр╕╣р╕Зр╕кр╕╕р╕Фр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕Ър╕Хр╣Йр╕нр╕Зр╕Бр╕ер╕▒р╕Ър╕бр╕▓р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕лр╕ер╕▒р╕Зр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕<br>RPO (Recovery Point Objective) р╕Др╕╖р╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╣Др╕Фр╣Й';
  if(q.text.includes("2FA") || q.text.includes("MFA")) return '2FA/MFA р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щр╣Бр╕Ър╕Ър╕кр╕нр╕Зр╕Вр╕▒р╣Йр╕Щ р╣Ар╕Кр╣Ир╕Щ р╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ+OTP р╕лр╕гр╕╖р╕нр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ+р╣Бр╕нр╕Ы';
  if(q.text.includes("SIEM")) return 'SIEM р╕Др╕╖р╕нр╕гр╕░р╕Ър╕Ър╕гр╕зр╕б log р╣Ар╕Юр╕╖р╣Ир╕нр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Бр╕ер╕░р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Ар╕лр╕Хр╕╕р╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤';
  if(q.text.includes("Immutable")) return 'Immutable Backup р╕Др╕╖р╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕гр╕нр╕Зр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕Бр╣Йр╣Др╕Вр╕лр╕гр╕╖р╕нр╕ер╕Ър╣Др╕Фр╣Йр╣Вр╕Фр╕вр╕Ьр╕╣р╣Йр╣Вр╕Ир╕бр╕Хр╕╡';
  if(q.text.includes("Playbook")) return 'Playbook р╕Др╕╖р╕нр╕Др╕╣р╣Ир╕бр╕╖р╕нр╕лр╕гр╕╖р╕нр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М р╣Ар╕Кр╣Ир╕Щ р╕Яр╕┤р╕Кр╕Кр╕┤р╕Зр╕лр╕гр╕╖р╕нр╕бр╕▒р╕ер╣Бр╕зр╕гр╣М';
  if(q.text.includes("BCP/DR")) return 'BCP (Business Continuity Plan) р╕Др╕╖р╕нр╣Бр╕Ьр╕Щр╕Др╕зр╕▓р╕бр╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Шр╕╕р╕гр╕Бр╕┤р╕И<br>DR (Disaster Recovery) р╕Др╕╖р╕нр╣Бр╕Ьр╕Щр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ър╕лр╕ер╕▒р╕Зр╣Ар╕Бр╕┤р╕Фр╣Ар╕лр╕Хр╕╕';
  if(q.text.includes("PDPA")) return 'PDPA р╕Др╕╖р╕нр╕Бр╕Ор╕лр╕бр╕▓р╕вр╕Др╕╕р╣Йр╕бр╕Др╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕зр╕Щр╕Ър╕╕р╕Др╕Др╕ер╕Вр╕нр╕Зр╣Др╕Чр╕в';
  if(q.text.includes("CERT")) return 'CERT р╕Др╕╖р╕нр╕Чр╕╡р╕бр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╣Др╕Лр╣Ар╕Ър╕нр╕гр╣М (р╣Ар╕Кр╣Ир╕Щ ThaiCERT)';
  if(q.text.includes("EDR")) return 'EDR р╕Др╕╖р╕нр╕Лр╕нр╕Яр╕Хр╣Мр╣Бр╕зр╕гр╣Мр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╕ар╕▒р╕вр╕Др╕╕р╕Бр╕Др╕▓р╕бр╕Ър╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М';
  if(q.text.includes("Asset Inventory")) return 'Asset Inventory р╕Др╕╖р╕нр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М/р╕гр╕░р╕Ър╕Ър╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Гр╕Щр╕нр╕Зр╕Др╣Мр╕Бр╕г';
  if(q.text.includes("Firewall")) return 'Firewall р╕Др╕╖р╕нр╕гр╕░р╕Ър╕Ър╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Бр╕ер╕░р╕Др╕зр╕Ър╕Др╕╕р╕бр╕Бр╕▓р╕гр╕гр╕▒р╕Ър╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕в';
  if(q.text.includes("Cloud") || q.text.includes("р╕Др╕ер╕▓р╕зр╕Фр╣М")) return 'Cloud р╕Др╕╖р╕нр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕Ър╕Щр╕нр╕┤р╕Щр╣Ар╕Чр╕нр╕гр╣Мр╣Ар╕Щр╣Зр╕Х р╣Ар╕Кр╣Ир╕Щ AWS, Azure, Google Cloud';
  // р╣Ар╕Юр╕┤р╣Ир╕б tip р╕нр╕╖р╣Ир╕Щр╣Ж р╣Др╕Фр╣Йр╕Чр╕╡р╣Ир╕Щр╕╡р╣И
  return "";
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Бр╕кр╕Фр╕Зр╕Др╕│р╕Цр╕▓р╕бр╕Чр╕╡р╕ер╕░р╕Вр╣Йр╕н
// ---------------------------
function renderQuestion(idx) {
  // р╕кр╕гр╣Йр╕▓р╕З HTML р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕кр╕Фр╕Зр╕Др╕│р╕Цр╕▓р╕бр╣Бр╕ер╕░р╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б
  const q = QUESTIONS[idx];
  let val = responses[idx]?.choice || "";
  let icon = q.icon || SECTION_ICONS[q.section] || "ЁЯФТ";
  let html = `<div class="question-card">
    <div style="font-size:2em; margin-bottom:0.2em;">${icon}</div>
    <div class="question-section">${q.section ? icon + " " + q.section : ""}</div>
    <div class="question-number">р╕Вр╣Йр╕нр╕Чр╕╡р╣И ${idx+1} / ${QUESTIONS.length}</div>
    <div class="font-medium text-lg text-slate-800 mb-1" style="line-height:1.5">
      ${q.text}
      ${getQuestionHint(q) ? `<button type="button" tabindex="-1" style="background:none;border:none;cursor:pointer;padding:0;margin-left:6px;" title="р╕Фр╕╣р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в" onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='block'?'none':'block'">
        <span style="display:inline-block;width:1.2em;height:1.2em;background:#e0f2fe;color:#0ea5e9;border-radius:50%;font-size:0.95em;text-align:center;line-height:1.2em;font-weight:bold;">?</span>
      </button>
      <span class="question-hint" style="display:none;background:#f1f5f9;border-radius:0.5em;padding:0.6em 1em;margin-top:0.5em;display:block;color:#0ea5e9;font-size:0.97em;">${getQuestionHint(q)}</span>` : ""}
    </div>
    <div class="radio-group">`;
  // р╕зр╕Щр╕ер╕╣р╕Ыр╕кр╕гр╣Йр╕▓р╕З radio button р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕ер╕░р╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б
  [["yes","р╣Гр╕Кр╣И"],["partial","р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И"],["no","р╣Др╕бр╣Ир╣Гр╕Кр╣И"]].forEach(([v,l])=>{
    html += `<label>
      <input type="radio" name="choice" value="${v}" class="accent-cyan-500" ${val===v?"checked":""}>
      <span>${l}</span>
    </label>`;
  });
  html += `</div>
    <input type="text" name="comment" placeholder="р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ (р╕Цр╣Йр╕▓р╕бр╕╡)" value="${responses[idx]?.comment ? responses[idx].comment.replace(/"/g,'&quot;') : ""}">
  </div>`;
  // р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Гр╕Щ questionBox
  document.getElementById('questionBox').innerHTML = html;
  // р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х progress bar
  document.getElementById('progressBar').style.width = `${Math.round((idx+1)/QUESTIONS.length*100)}%`;
  // р╕Лр╣Ир╕нр╕Щр╕Ыр╕╕р╣Ир╕бр╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ър╕Цр╣Йр╕▓р╣Ар╕Ыр╣Зр╕Щр╕Вр╣Йр╕нр╣Бр╕гр╕Б
  document.getElementById('prevBtn').style.display = idx === 0 ? "none" : "";
  // р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Ыр╕╕р╣Ир╕бр╕Цр╕▒р╕Фр╣Др╕Ыр╕Цр╣Йр╕▓р╣Ар╕Ыр╣Зр╕Щр╕Вр╣Йр╕нр╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в
  document.getElementById('nextBtn').textContent = idx === QUESTIONS.length-1 ? "р╕Фр╕╣р╕Ьр╕ер╕кр╕гр╕╕р╕Ы" : "р╕Цр╕▒р╕Фр╣Др╕Ы";
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Др╕│р╕Хр╕нр╕Ър╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ
// ---------------------------
function saveCurrent() {
  // р╕нр╣Ир╕▓р╕Щр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕ер╕░р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ р╣Бр╕ер╣Йр╕зр╣Ар╕Бр╣Зр╕Ър╕ер╕З responses
  const q = QUESTIONS[current];
  const choice = document.querySelector('input[name="choice"]:checked');
  const comment = document.querySelector('input[name="comment"]').value;
  if(choice) {
    responses[current] = { choice: choice.value, comment };
  }
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕кр╕гр╕╕р╕Ы
// ---------------------------
function showSummary() {
  document.getElementById('summarySection').style.display = "block";

  let ordered = [];
  // --- р╣Бр╕вр╕Бр╕Вр╣Йр╕нр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╕▓р╕бр╕гр╕░р╕Фр╕▒р╕Ъ ---
  let high = [], medium = [], low = [];
  let total = 0;
  for(let i=0;i<QUESTIONS.length;i++) {
    const ans = responses[i]?.choice;
    const score = SCORE_MAP[ans];
    if(score > 0) {
      total += score;
      if(score === 2) high.push(i);
      else if(score === 1) medium.push(i);
      else low.push(i);
    }
  }
  ordered = [...high, ...medium, ...low];

  // --- Group by section for readability ---
  let sectionMap = {};
  for(const i of ordered) {
    const sec = QUESTIONS[i].section || "р╕нр╕╖р╣Ир╕Щр╣Ж";
    if(!sectionMap[sec]) sectionMap[sec] = [];
    sectionMap[sec].push(i);
  }

  let html = `<div style="
  background: #f8fafc;
  border-radius: 1.5rem;
  padding: 2.5rem 1.5rem;
  box-shadow: 0 4px 32px #38bdf822;
  font-family: 'Prompt', 'Sarabun', 'Segoe UI', Arial, sans-serif;
  ">
  <!-- <h2 style="
    font-size:2.1rem;
    font-weight: bold;
    color: #0e2233;
    margin-bottom: 2rem;
    text-align:center;
    letter-spacing:0.01em;
    ">р╕кр╕гр╕╕р╕Ыр╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕Др╕зр╕гр╣Бр╕Бр╣Йр╣Др╕В/р╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З (р╣Ар╕гр╕╡р╕вр╕Зр╕Хр╕▓р╕бр╕гр╕░р╕Фр╕▒р╕Ър╣Бр╕ер╕░р╕лр╕бр╕зр╕Ф)</h2> -->
  <div style="display:flex; flex-direction:column; gap:2.5rem;">`;

  if (ordered.length === 0) {
    html += `<div style="margin-top:2.5rem; text-align:center; color:#16a34a; font-size:1.3em; font-weight:600;">
      р╣Др╕бр╣Ир╕Юр╕Ър╕Вр╣Йр╕нр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Бр╕Бр╣Йр╣Др╕Вр╕лр╕гр╕╖р╕нр╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З/р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З
    </div>`;
  } else {
    for(const sec in sectionMap) {
      let secIcon = SECTION_ICONS[sec] || "ЁЯФТ";
      html += `<div style="margin-bottom:1.5em;">
        <div style="font-size:1.25em; font-weight:bold; color:#0ea5e9; margin-bottom:0.7em; display:flex;align-items:center;gap:0.5em;">
          <span style="font-size:1.5em;">${secIcon}</span> <u>${sec}</u>
        </div>
        <div style="display:flex; flex-direction:column; gap:1.5rem;">`;
      for(const i of sectionMap[sec]) {
        const ans = responses[i]?.choice;
        const score = SCORE_MAP[ans];
        const risk = QUESTIONS[i].risk;
        const fix = QUESTIONS[i].fix;
        const steps = QUESTIONS[i].steps;
        const comment = responses[i]?.comment ? `<div style="margin-top:0.7em; font-size:1.05em; color:#64748b;"><b>р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:</b> ${responses[i].comment}</div>` : "";
        let riskColor = score === 2 ? "#dc2626" : score === 1 ? "#d97706" : "#16a34a";
        let riskLabel = score === 2 ? "р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З" : score === 1 ? "р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З" : "р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕│";
        let riskIcon = score === 2 ? "ЁЯФе" : score === 1 ? "тЪая╕П" : "тЬЕ";
        html += `
        <div style="
          background: #fff;
          border-radius: 1.2rem;
          box-shadow: 0 2px 12px #38bdf822;
          padding: 1.2rem 1.2rem 1.2rem 1.2rem;
          font-size: 1.13rem;
          color: #0e2233;
          border-left: 8px solid ${riskColor};
          display: flex;
          flex-direction: column;
          gap: 0.7em;
          ">
          <div style="display:flex;align-items:center;gap:0.5em;">
            <span style="font-size:1.3em;color:${riskColor};">${riskIcon}</span>
            <span style="font-weight:600;">р╕Вр╣Йр╕нр╕Чр╕╡р╣И ${i+1}:</span>
            <span>${QUESTIONS[i].text}</span>
          </div>
          <div>
            <span style="font-size:1.05em;"><b>р╕Др╕│р╕Хр╕нр╕Ъ:</b> <span style="color:#0ea5e9;">${LABEL_MAP[ans]||"-"}</span></span>
            <span style="margin-left:1em; font-size:1.05em;">(р╕Др╕░р╣Бр╕Щр╕Щ: <span class="score" style="color:#0ea5e9;">${score}</span>)</span>
          </div>
          <div>
            <b>р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> <span style="font-size:1.05em; color:${riskColor}; font-weight:bold;">${riskLabel}</span>
          </div>
          ${comment}
          <details style="margin-top:0.5em;">
            <summary style="cursor:pointer;font-weight:600;color:#0ea5e9;">р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Бр╕ер╕░р╣Бр╕Щр╕зр╕Чр╕▓р╕Зр╣Бр╕Бр╣Йр╣Др╕В</summary>
            <div style="margin-top:0.7em; color:#dc2626; font-size:1.05em;">
              <b>тЪая╕П р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> ${risk}
            </div>
            <div style="margin-top:0.5em; color:#0ea5e9; font-size:1.05em;">
              <b>ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│:</b> ${fix}
            </div>
            <div style="margin-top:0.5em;">
              <b style="color:#0ea5e9;">ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В:</b>
              <ul style="margin-left:1.5em; margin-top:0.3em; font-size:1.03em; color:#334155;">
                ${steps.map(step=>`<li style="margin-bottom:0.2em;">${step}</li>`).join("")}
              </ul>
            </div>
          </details>
        </div>`;
      }
      html += `</div></div>`;
    }
  }

  html += `</div>
    <div style="margin-top:2.5rem; font-size:1.3em; font-weight:bold; text-align:center;">
      р╕Др╕░р╣Бр╕Щр╕Щр╕гр╕зр╕б (р╣Ар╕Йр╕Юр╕▓р╕░р╕Вр╣Йр╕нр╣Ар╕кр╕╡р╣Ир╕вр╕З): <span class="score" style="color:#0ea5e9;">${total}</span> / ${QUESTIONS.length*2}
    </div>
    <div style="margin-top:0.7em; font-size:1.15em; text-align:center;">
      р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕гр╕зр╕б: ${
        total >= QUESTIONS.length*1.5 ? '<span class="risk-high" style="font-size:1.1em;">р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З</span>' :
        total >= QUESTIONS.length*0.5 ? '<span class="risk-medium" style="font-size:1.1em;">р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З</span>' :
        '<span class="risk-low" style="font-size:1.1em;">р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕│</span>'
      }
    </div>
  </div>`;
  document.getElementById('summary').innerHTML = html;
  document.getElementById('summary').style.display = "block";

  // р╣Бр╕кр╕Фр╕З pro results р╕Хр╣Ир╕нр╕Чр╣Йр╕▓р╕в
  renderProResults(responses, QUESTIONS);
  setTimeout(()=>document.getElementById('proResultsSection').scrollIntoView({behavior:"smooth"}), 200);
}

// ---------------------------
// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Ар╕гр╕╡р╕вр╕Б AI р╕Ир╕▓р╕Б aiforthai (API)
// ---------------------------
async function callAISummary() {
  // р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕кр╕гр╕╕р╕Ыр╕Др╕│р╕Хр╕нр╕Ъ
  let summaryText = QUESTIONS.map((q,i) => {
    const ans = responses[i]?.choice;
    if(ans) return `р╕Вр╣Йр╕н: ${q.text}\nр╕Др╕│р╕Хр╕нр╕Ъ: ${LABEL_MAP[ans]}\n`;
    return '';
  }).filter(Boolean).join('\n');
  try {
    const res = await fetch("https://api.aiforthai.in.th/summarize", {
      method: "POST",
      headers: {
        "Apikey": "SyvIiGOP07EK6fIcQdS20UWDjs79G7gP", // <-- р╣Гр╕Кр╣Й API KEY р╕Чр╕╡р╣Ир╣Гр╕лр╣Йр╕бр╕▓
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: "text=" + encodeURIComponent(summaryText)
    });
    const data = await res.json();
    if(data && data.summary) {
      document.getElementById('aiSummary').innerText = data.summary;
    } else {
      document.getElementById('aiSummary').innerText = "р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╣Др╕Фр╣Йр╣Гр╕Щр╕Вр╕Ур╕░р╕Щр╕╡р╣Й";
    }
  } catch(e) {
    document.getElementById('aiSummary').innerText = "р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н AI";
  }
}

// ---------------------------
// р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ыр╕╕р╣Ир╕бр╕Цр╕▒р╕Фр╣Др╕Ы/р╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ
// ---------------------------
document.getElementById('nextBtn').onclick = function() {
  // р╣Ар╕бр╕╖р╣Ир╕нр╕Бр╕Фр╕Цр╕▒р╕Фр╣Др╕Ы: р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Др╕│р╕Хр╕нр╕Ъ, р╣Др╕Ыр╕Вр╣Йр╕нр╕Цр╕▒р╕Фр╣Др╕Ы р╕лр╕гр╕╖р╕нр╣Бр╕кр╕Фр╕Зр╕кр╕гр╕╕р╕Ы
  saveCurrent();
  if(current < QUESTIONS.length-1) {
    current++;
    renderQuestion(current);
  } else {
    // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Хр╕нр╕Ър╕Др╕гр╕Ър╕Чр╕╕р╕Бр╕Вр╣Йр╕нр╕лр╕гр╕╖р╕нр╕вр╕▒р╕З
    let allAnswered = QUESTIONS.every((q,i) => responses[i]?.choice);
    if(allAnswered) {
      showSummary();
      // scroll р╣Др╕Ыр╕вр╕▒р╕Зр╕кр╕гр╕╕р╕Ыр╕Ьр╕е
      setTimeout(()=>document.getElementById('summarySection').scrollIntoView({behavior:"smooth"}), 200);
    } else {
      // р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Др╕гр╕Ъ р╣Гр╕лр╣Йр╣Др╕Ыр╕Вр╣Йр╕нр╣Бр╕гр╕Бр╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Хр╕нр╕Ъ
      let firstUnanswered = QUESTIONS.findIndex((q,i) => !responses[i]?.choice);
      if(firstUnanswered !== -1) {
        current = firstUnanswered;
        renderQuestion(current);
        alert("р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕нр╕Ър╕Чр╕╕р╕Бр╕Вр╣Йр╕нр╕Бр╣Ир╕нр╕Щр╕Фр╕╣р╕Ьр╕ер╕кр╕гр╕╕р╕Ы");
      }
    }
  }
};
document.getElementById('prevBtn').onclick = function() {
  // р╣Ар╕бр╕╖р╣Ир╕нр╕Бр╕Фр╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ: р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Др╕│р╕Хр╕нр╕Ъ, р╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕Вр╣Йр╕нр╕Бр╣Ир╕нр╕Щр╕лр╕Щр╣Йр╕▓
  saveCurrent();
  if(current > 0) {
    current--;
    renderQuestion(current);
  }
};
document.getElementById('assessmentForm').onsubmit = function(e) {
  // р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Бр╕▓р╕г submit р╕Яр╕нр╕гр╣Мр╕бр╣Бр╕Ър╕Ър╕Ыр╕Бр╕Хр╕┤
  e.preventDefault();
  return false;
};

// ---------------------------
// р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Бр╕кр╕Фр╕Зр╕Др╕│р╕Цр╕▓р╕бр╕Вр╣Йр╕нр╣Бр╕гр╕Б
// ---------------------------
renderQuestion(current);

// ====== PRO REPORT LOGIC ======
function getRiskData(responses, QUESTIONS) {
  // For demo: asset = question, threat = risk, vuln = fix, consequence = risk
  // Likelihood: 1=р╣Гр╕Кр╣И, 2=р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И, 3=р╣Др╕бр╣Ир╣Гр╕Кр╣И
  // Impact: р╕Цр╣Йр╕▓р╕бр╕╡р╕Др╕│р╕зр╣Ир╕▓ "р╕Вр╣Йр╕нр╕бр╕╣р╕е", "р╕гр╕░р╕Ър╕Ъ", "р╕кр╕╣р╕Нр╕лр╕▓р╕в", "р╣Вр╕Ир╕бр╕Хр╕╡" р╣Гр╕лр╣Й 3, р╕нр╕╖р╣Ир╕Щр╣Ж 2
  // Risk Level: High (>=7), Medium (>=4), Low (<4)
  // Response: High=Mitigate/Avoid, Medium=Mitigate/Transfer, Low=Accept/Monitor
  let riskRows = [];
  let matrixRows = [];
  let responseRows = [];
  let heatmap = [[[],[],[]],[[],[],[]],[[],[],[]]]; // [impact-1][likelihood-1]
  for(let i=0;i<QUESTIONS.length;i++) {
    const ans = responses[i]?.choice;
    if(!ans) continue;
    const asset = QUESTIONS[i].text;
    const threat = QUESTIONS[i].risk;
    const vuln = QUESTIONS[i].fix;
    const consequence = QUESTIONS[i].risk;
    const likelihood = ans==="yes"?1 : ans==="partial"?2 : 3;
    let impact = /р╕Вр╣Йр╕нр╕бр╕╣р╕е|р╕гр╕░р╕Ър╕Ъ|р╕кр╕╣р╕Нр╕лр╕▓р╕в|р╣Вр╕Ир╕бр╕Хр╕╡|р╕гр╕▒р╣Ир╕зр╣Др╕лр╕е|р╕Яр╕╖р╣Йр╕Щр╕Яр╕╣/.test(threat)?3:2;
    let riskScore = likelihood * impact;
    let riskLevel = riskScore>=7?"High":riskScore>=4?"Medium":"Low";
    let response = riskLevel==="High"?"Mitigate / Avoid":riskLevel==="Medium"?"Mitigate / Transfer":"Accept / Monitor";
    riskRows.push({asset,threat,vuln,consequence});
    matrixRows.push({asset,likelihood,impact,riskLevel});
    responseRows.push({asset,riskLevel,response});
    heatmap[impact-1][likelihood-1].push(riskLevel);
  }
  return {riskRows, matrixRows, responseRows, heatmap};
}

function getIRPData(responses, QUESTIONS) {
  // Incident type: р╕Цр╣Йр╕▓р╕Хр╕нр╕Ъ "р╣Др╕бр╣Ир╣Гр╕Кр╣И" р╣Гр╕Щ 2FA, Patch, Backup, Log, Antivirus, IRP plan, Incident contact, Playbook, Segmentation, Firewall, Cloud
  // (index: 3,7,11,14,15,16,17,18,22,23,24)
  let types = [];
  if(responses[3]?.choice==="no") types.push("Account Compromise");
  if(responses[7]?.choice==="no") types.push("Vulnerability Exploitation");
  if(responses[11]?.choice==="no") types.push("Data Loss / Ransomware");
  if(responses[14]?.choice==="no"||responses[15]?.choice==="no") types.push("Malware Outbreak");
  if(responses[16]?.choice==="no"||responses[17]?.choice==="no") types.push("Incident Response Weakness");
  if(responses[18]?.choice==="no"||responses[22]?.choice==="no") types.push("Network Intrusion");
  if(responses[23]?.choice==="no"||responses[24]?.choice==="no") types.push("Cloud Security Issue");
  if(types.length===0) types.push("General Security Weakness");

  // CIRT Team Roles (р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З)
  const cirtRoles = [
    {name:"р╕Щр╕▓р╕вр╕кр╕бр╕Кр╕▓р╕в", role:"CIRT Lead", resp:"р╕Др╕зр╕Ър╕Др╕╕р╕бр╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╣Бр╕ер╕░р╕Хр╕▒р╕Фр╕кр╕┤р╕Щр╣Гр╕Ир╕лр╕ер╕▒р╕Б"},
    {name:"р╕Щр╕▓р╕Зр╕кр╕▓р╕зр╕Юр╕гр╕Чр╕┤р╕Юр╕вр╣М", role:"Technical Lead", resp:"р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕Чр╕Др╕Щр╕┤р╕Др╣Бр╕ер╕░р╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓"},
    {name:"р╕Щр╕▓р╕вр╕зр╕┤р╕Чр╕вр╕▓", role:"Compliance Officer", resp:"р╕Фр╕╣р╣Бр╕ер╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Ф р╕Бр╕Ор╕лр╕бр╕▓р╕в р╣Бр╕ер╕░р╕Бр╕▓р╕гр╕гр╕▓р╕вр╕Зр╕▓р╕Щ"},
    {name:"р╕Др╕╕р╕Ур╕нр╕гр╕Чр╕▒р╕в", role:"IT Support", resp:"р╕кр╕Щр╕▒р╕Ър╕кр╕Щр╕╕р╕Щр╕Бр╕▓р╕гр╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ър╣Бр╕ер╕░р╕Ыр╕гр╕░р╕кр╕▓р╕Щр╕Зр╕▓р╕Щ"},
  ];

  // IRP Phases & Actions
  const phases = [
    {
      phase:"Preparation",
      actions:[
        {task:"р╕Ир╕▒р╕Фр╕Чр╕│р╕Щр╣Вр╕вр╕Ър╕▓р╕вр╣Бр╕ер╕░р╣Бр╕Ьр╕Щ IRP", who:"CIRT Lead"},
        {task:"р╕нр╕Ър╕гр╕бр╕Чр╕╡р╕бр╕Зр╕▓р╕Щр╣Бр╕ер╕░р╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕н", who:"Compliance Officer"},
        {task:"р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ьр╕Щр╣Бр╕ер╕░р╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Хр╕┤р╕Фр╕Хр╣Ир╕н", who:"CIRT Lead, IT Support"}
      ]
    },
    {
      phase:"Detection & Analysis",
      actions:[
        {task:"р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤р╕Ир╕▓р╕Б Log/SIEM", who:"Technical Lead"},
        {task:"р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╣Бр╕ер╕░р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ", who:"Technical Lead, CIRT Lead"},
        {task:"р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Чр╕╡р╕бр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З", who:"CIRT Lead"}
      ]
    },
    {
      phase:"Containment & Recovery",
      actions:[
        {task:"р╕Ир╕│р╕Бр╕▒р╕Фр╕Вр╕нр╕Ър╣Ар╕Вр╕Хр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М", who:"Technical Lead"},
        {task:"р╕Бр╕╣р╣Йр╕Др╕╖р╕Щр╕гр╕░р╕Ър╕Ъ/р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╕кр╕│р╕гр╕нр╕З", who:"IT Support"},
        {task:"р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ", who:"Technical Lead, IT Support"}
      ]
    },
       {
      phase:"Post-Incident Activities",
      actions:[
        {task:"р╕кр╕гр╕╕р╕Ыр╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╣Бр╕ер╕░р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Бр╕Ьр╕Щ", who:"CIRT Lead, Compliance Officer"},
        {task:"р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Хр╣Ир╕нр╕Ьр╕╣р╣Йр╕Ър╕гр╕┤р╕лр╕▓р╕г/р╕лр╕Щр╣Ир╕зр╕вр╕Зр╕▓р╕Щр╕Бр╕│р╕Бр╕▒р╕Ъ", who:"Compliance Officer"},
        {task:"р╕нр╕Ър╕гр╕бр╣Бр╕ер╕░р╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╕Бр╕▒р╕Ър╕Ър╕╕р╕Др╕ер╕▓р╕Бр╕г", who:"CIRT Lead"}
      ]
    }
  ];
  return {types, cirtRoles, phases};
}

function renderProResults(responses, QUESTIONS) {
  const risk = getRiskData(responses, QUESTIONS);
   const riskOrder = { "High": 1, "Medium": 2, "Low": 3 };
  const sortedMatrixRows = [...risk.matrixRows].sort((a, b) => {
    return riskOrder[a.riskLevel] - riskOrder[b.riskLevel];
  });

  // Risk Scenario Table
  document.getElementById('riskScenarioRows').innerHTML = risk.riskRows.map(r=>`
    <tr>
      <td>${r.asset}</td>
      <td>${r.threat}</td>
      <td>${r.vuln}</td>
      <td>${r.consequence}</td>
    </tr>
  `).join("");

  // --- NEW: Answer Table ---
  let answerTableHtml = `
    <div class="mb-6">
      <div class="font-bold text-lg mb-2">Answer Table</div>
      <table class="result-table">
        <thead>
          <tr>
            <th>Asset</th>
            <th>Answer</th>
          </tr>
        </thead>
        <tbody>
          ${QUESTIONS.map((q, idx) => {
            const ans = responses[idx]?.choice;
            let label = ans === "yes" ? "р╣Гр╕Кр╣И" : ans === "partial" ? "р╣Др╕бр╣Ир╣Бр╕Щр╣Ир╣Гр╕И" : ans === "no" ? "р╣Др╕бр╣Ир╣Гр╕Кр╣И" : "-";
            return `<tr>
              <td>${q.text}</td>
              <td>${label}</td>
            </tr>`;
          }).join("")}
        </tbody>
      </table>
    </div>
  `;
  // р╣Бр╕Чр╕гр╕Б Answer Table р╕Бр╣Ир╕нр╕Щ Risk Level Table
  document.getElementById('riskMatrixRows').parentElement.insertAdjacentHTML('beforebegin', answerTableHtml);

  // Likelihood & Impact Matrix
  document.getElementById('riskMatrixRows').innerHTML = sortedMatrixRows.map((r, idx)=>{
    const qIdx = QUESTIONS.findIndex(q=>q.text===r.asset);
    return `
      <tr>
        <td>${r.asset}</td>
        <td>${r.likelihood}</td>
        <td>${r.impact}</td>
        <td class="risk-${r.riskLevel.toLowerCase()}">
          ${
            r.riskLevel === "High"
            ? `<span style="color:#dc2626;cursor:pointer;text-decoration:underline;font-weight:bold;" class="show-detail" data-idx="${qIdx}" data-risk="high">HIGH</span>`
            : r.riskLevel === "Medium"
            ? `<span style="color:#d97706;cursor:pointer;text-decoration:underline;font-weight:bold;" class="show-detail" data-idx="${qIdx}" data-risk="medium">MEDIUM</span>`
            : `<span style="color:#16a34a;font-weight:bold;">LOW</span>`
          }
        </td>
      </tr>
    `;
  }).join("");

  // --- PRO Risk Heatmap ---
  // Legend
  const legend = `
    <div style="margin-bottom:1em;display:flex;gap:1.5em;align-items:center;">
      <span><span style="display:inline-block;width:1.2em;height:1.2em;background:#fecaca;border-radius:0.3em;margin-right:0.3em;border:1px solid #dc2626;"></span>High</span>
      <span><span style="display:inline-block;width:1.2em;height:1.2em;background:#fde68a;border-radius:0.3em;margin-right:0.3em;border:1px solid #d97706;"></span>Medium</span>
      <span><span style="display:inline-block;width:1.2em;height:1.2em;background:#bbf7d0;border-radius:0.3em;margin-right:0.3em;border:1px solid #16a34a;"></span>Low</span>
      <span style="margin-left:1.5em;color:#64748b;font-size:0.97em;">р╕Др╕ер╕┤р╕Бр╕лр╕гр╕╖р╕нр╕Кр╕╡р╣Йр╕Чр╕╡р╣Ир╕Кр╣Ир╕нр╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф</span>
    </div>
  `;
  // р╣Гр╕кр╣И legend р╕Бр╣Ир╕нр╕Щр╕Хр╕▓р╕гр╕▓р╕З heatmap
  const heatmapTable = document.querySelector('.heatmap-table');
  if (heatmapTable && !document.getElementById('heatmapLegend')) {
    heatmapTable.insertAdjacentHTML('beforebegin', `<div id="heatmapLegend">${legend}</div>`);
  }

  // Heatmap interactive
  let heatmapHtml = "";
  for(let impact=3;impact>=1;impact--) {
    heatmapHtml += "<tr>";
    for(let likelihood=1;likelihood<=3;likelihood++) {
      let levels = risk.heatmap[impact-1][likelihood-1];
      // р╕лр╕▓ asset р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Гр╕Щ cell р╕Щр╕╡р╣Й
      let assets = sortedMatrixRows.filter(r=>r.likelihood===likelihood && r.impact===impact);
      let cellClass = "heatmap-low";
      let riskType = "-";
      if(levels.includes("High")) { cellClass = "heatmap-high"; riskType = "High"; }
      else if(levels.includes("Medium")) { cellClass = "heatmap-medium"; riskType = "Medium"; }
      else if(levels.includes("Low")) { cellClass = "heatmap-low"; riskType = "Low"; }
      let count = assets.length;
      let assetList = assets.map(r=>`<li>${r.asset}</li>`).join("");
      heatmapHtml += `
        <td class="${cellClass} heatmap-cell" style="cursor:pointer;position:relative;" 
            data-impact="${impact}" data-likelihood="${likelihood}" data-risk="${riskType}" data-assets='${JSON.stringify(assets.map(r=>r.asset))}'>
          ${count ? `<b>${count}</b>` : "-"}
          <div class="heatmap-tooltip" style="display:none;position:absolute;z-index:10;left:50%;top:110%;transform:translateX(-50%);background:#fff;border:1px solid #e0e7ef;border-radius:0.7em;box-shadow:0 2px 12px #38bdf822;padding:1em;min-width:220px;">
            <div style="font-weight:bold;color:#0ea5e9;">Impact: ${impact}, Likelihood: ${likelihood}</div>
            <div style="margin:0.3em 0 0.5em 0;"><span style="font-weight:bold;color:${riskType==="High"?"#dc2626":riskType==="Medium"?"#d97706":"#16a34a"};">${riskType}</span></div>
            ${count ? `<div style="font-size:0.97em;"><b>Asset:</b><ul style="margin:0.2em 0 0 1.2em;">${assetList}</ul></div>` : `<div style="color:#64748b;">р╣Др╕бр╣Ир╕бр╕╡р╕гр╕▓р╕вр╕Бр╕▓р╕г</div>`}
          </div>
        </td>
      `;
    }
    heatmapHtml += "</tr>";
  }
  document.getElementById('heatmapGrid').innerHTML = heatmapHtml;

  // Tooltip р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ
  document.querySelectorAll('.heatmap-cell').forEach(cell=>{
    cell.addEventListener('mouseenter', function() {
      this.querySelector('.heatmap-tooltip').style.display = 'block';
    });
    cell.addEventListener('mouseleave', function() {
      this.querySelector('.heatmap-tooltip').style.display = 'none';
    });
    cell.addEventListener('click', function() {
      const tooltip = this.querySelector('.heatmap-tooltip');
      tooltip.style.display = tooltip.style.display === 'block' ? 'none' : 'block';
    });
  });

  // Risk Response Table
  document.getElementById('riskResponseRows').innerHTML = risk.responseRows.map(r=>`
    <tr>
      <td>${r.asset}</td>
      <td class="risk-${r.riskLevel.toLowerCase()}">${r.riskLevel.toUpperCase()}</td>
      <td>${r.response}</td>
    </tr>
  `).join("");

  // IRP (р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕Фр╕┤р╕б)
  const irp = getIRPData(responses, QUESTIONS);
  document.getElementById('incidentSummary').innerHTML = `
    <b>Incident Classification:</b> <span style="color:#0ea5e9">${irp.types.join(", ")}</span>
  `;
  document.getElementById('cirtRolesRows').innerHTML = irp.cirtRoles.map(r=>`
    <tr>
      <td>${r.name}</td>
      <td>${r.role}</td>
      <td>${r.resp}</td>
    </tr>
  `).join("");
  document.getElementById('irpStepper').innerHTML = irp.phases.map((p,i)=>`
    <div class="stepper-phase">
      <div class="stepper-dot"></div>
      <div class="stepper-title">${i+1}. ${p.phase}</div>
      <table class="result-table stepper-table">
        <thead>
          <tr>
            <th>Key Action</th>
            <th>Responsible</th>
          </tr>
        </thead>
        <tbody>
          ${p.actions.map(a=>`
            <tr>
              <td>${a.task}</td>
              <td>${a.who}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    </div>
  `).join("");
  document.getElementById('proResultsSection').style.display = "block";

  // Event: р╣Ар╕бр╕╖р╣Ир╕нр╕Др╕ер╕┤р╕Б HIGH р╕лр╕гр╕╖р╕н MEDIUM (р╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕нр╕▒р╕Бр╕йр╕г)
  setTimeout(()=>{
    document.querySelectorAll('.show-detail').forEach(cell=>{
      cell.onclick = function() {
        const i = +cell.getAttribute('data-idx');
        const riskType = cell.getAttribute('data-risk');
        const q = QUESTIONS[i];
        const ans = responses[i]?.choice;
        const score = SCORE_MAP[ans];
        let riskColor = riskType === "high" ? "#dc2626" : "#d97706";
        let riskLabel = riskType === "high" ? "р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З" : "р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З";
        let html = `
          <div class="mb-3">
            <span style="font-size:1.2em;font-weight:bold;">${q.text}</span>
          </div>
          <div class="mb-2"><b>р╕Др╕│р╕Хр╕нр╕Ъ:</b> <span style="color:#0ea5e9;">${LABEL_MAP[ans]||"-"}</span> (р╕Др╕░р╣Бр╕Щр╕Щ: ${score})</div>
          <div class="mb-2"><b>р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> <span style="color:${riskColor};font-weight:bold;">${riskLabel}</span></div>
          <div class="mb-2"><b>р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З:</b> <span style="color:${riskColor};">${q.risk}</span></div>
          <div class="mb-2"><b>р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│:</b> <span style="color:#0ea5e9;">${q.fix}</span></div>
          <div class="mb-2"><b>р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В:</b>
            <ul>${q.steps.map(step=>`<li>${step}</li>`).join("")}</ul>
          </div>
          ${responses[i]?.comment ? `<div class="mb-2"><b>р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:</b> ${responses[i].comment}</div>` : ""}
        `;
        document.getElementById('riskHighModalBody').innerHTML = html;
        new bootstrap.Modal(document.getElementById('riskHighModal')).show();
      };
    });
  }, 100);
}

// ---------------------------
// р╕кр╣Ир╕зр╕Щ: р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕Ыр╕┤р╕Фр╕Ыр╕┤р╕Фр╕Вр╕нр╕З IRP panel
// ---------------------------
(function() {
  const toggle = document.getElementById('irp-toggle');
  const panel = document.getElementById('irp-panel');
  const caret = document.getElementById('irp-caret');
  const storageKey = 'incidentResponsePanel:open';

  // р╣Вр╕лр╕ер╕Фр╕кр╕Цр╕▓р╕Щр╕░р╕Ир╕▓р╕Б localStorage
  let open = localStorage.getItem(storageKey) === "1";
  setPanel(open);

  function setPanel(isOpen) {
    if(isOpen) {
      panel.classList.add('open');
      panel.setAttribute('aria-hidden', 'false');
      toggle.setAttribute('aria-expanded', 'true');
      caret.style.transform = "rotate(90deg)";
      localStorage.setItem(storageKey, "1");
    } else {
      panel.classList.remove('open');
      panel.setAttribute('aria-hidden', 'true');
      toggle.setAttribute('aria-expanded', 'false');
      caret.style.transform = "rotate(0deg)";
      localStorage.setItem(storageKey, "0");
    }
  }

  function handleToggle(e) {
    if(e.type === "click" || e.key === "Enter" || e.key === " ") {
      open = !open;
      setPanel(open);
      e.preventDefault();
    }
  }
  toggle.addEventListener('click', handleToggle);
  toggle.addEventListener('keydown', handleToggle);

  // Responsive: р╕Ыр╕гр╕▒р╕Ъ max-height р╣Ар╕бр╕╖р╣Ир╕нр╕Вр╕Щр╕▓р╕Ф panel р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ
  window.addEventListener('resize', ()=>{
    if(open) setPanel(true);
  });
})();
</script>
</body>
</html>